Analysis and Optimization of Graph Decompositions by Lifted Multicuts
(Supplement)

Andrea Hor ˇn´akov´a * 1 Jan-Hendrik Lange * 1 Bjoern Andres 1

Appendix

A. Multicuts

Proof of Lemma 2 First, we show that for any Π ∈ DG,
the image φG(Π) is a multicut of G. Assume the contrary,
i.e. there exists a cycle C of G such that |C ∩ φG(Π)| = 1.
Let {u, v} = e ∈ C ∩ φG(Π), then for all U ∈ Π it holds
that u /∈ U or v /∈ U . However, C \ {e} is a sequence of
edges {w1, w2}, . . . , {wk
1, wk} such that u = w1, v =
wk and {wi, wi+1} /∈ φG(Π) for all 1 ≤ i ≤ k − 1. Con-
sequently, since Π is a partition of V , there exists some
U ∈ Π such that

−

w1 ∈ U ∧ w2 ∈ U ∧ . . . ∧ wk

1 ∈ U ∧ wk ∈ U.

−

This contradicts w1 = u /∈ U or wk = v /∈ U .

To show injectivity of φG, let Π = {U1, . . . , Uk}, Π(cid:48) =
{U (cid:48)1, . . . , U (cid:48)(cid:96)} be two decompositions of G. Suppose Π (cid:54)=
Π(cid:48). Then (w.l.o.g.) there exist some u, v ∈ V with {u, v} ∈
E and some Ui ∈ Π such that u, v ∈ Ui and for all U (cid:48)j ∈ Π(cid:48)
it holds that u /∈ U (cid:48)j or v /∈ U (cid:48)j. Thus, {u, v} ∈ φG(Π(cid:48)) but
{u, v} /∈ φG(Π), which means φG(Π) (cid:54)= φG(Π(cid:48)).

For surjectivity, take some multicut M ⊆ E of G. Let
Π = {U1, . . . , Uk} collect the node sets of the connected
components of the graph (V, E \ M ). Apparently, Π deﬁnes
a decomposition of G. We have {u, v} ∈ φG(Π) if and
only if for all U ∈ Π it holds that v /∈ U or u /∈ U . The
latter holds true if and only if {u, v} is not contained in any
connected component of (V, E \ M ), which is equivalent
to {v, w} ∈ M . Hence, φG(Π) = M .

Proof of Lemma 4 First, we show that for any M ∈
MKV the image ψ(M ) is an equivalence relation on V .
Since KV is simple, we trivially have {v, v} /∈ M for any
v ∈ V . Therefore, (v, v) ∈ ψ(M ), which means ψ(M )
is reﬂexive. Symmetry of ψ(M ) follows from {u, v} =

*Equal contribution 1Max Planck Institute for Informatics,
Saarbr¨ucken, Germany. Correspondence to: Bjoern Andres
<andres@mpi-inf.mpg.de>.

Proceedings of the 34 th International Conference on Machine
Learning, Sydney, Australia, PMLR 70, 2017. Copyright 2017 by
the author(s).

{v, u} for all u, v ∈ V . Now, suppose (u, v), (v, w) ∈
ψ(M ). Then {u, v, }, {v, w} /∈ M and thus {u, w} /∈ M
(otherwise C = {u, v, w} would be a cycle contradicting
the deﬁnition of a multicut). Hence, (u, w) ∈ ψ(M ), which
gives transitivity of ψ(M ).

Let M, M (cid:48) be two multicuts of KV with ψ(M ) = ψ(M (cid:48)).
Then

{u, v} ∈ M ⇐⇒ (u, v) /∈ ψ(M )
⇐⇒ (u, v) /∈ ψ(M (cid:48))
⇐⇒ {u, v} ∈ M (cid:48).

Hence M = M (cid:48), so ψ is injective.

Let R be an equivalence relation on V and deﬁne M by

{u, v} ∈ M ⇐⇒ (u, v) /∈ R.

Transitivity of R implies that M is a multicut of KV . More-
over, by deﬁnition, it holds that ψ(M ) = R. Hence, ψ is
also surjective.

B. Lifted Multicuts
Proof of Lemma 5 Let x ∈ {0, 1}E(cid:48)
be such that M (cid:48) =
1(1) is a multicut of G(cid:48) lifted from G. Every cycle in G is
x−
a cycle in G(cid:48). Moreover, for any path vw = f ∈ FGG(cid:48) and
any vw-path P in G, it holds that P ∪ {f } is a cycle in G(cid:48).
Therefore, x satisﬁes all inequalities (4) and (5). Assume
x violates some inequality of (6). Then there is an edge
vw ∈ FGG(cid:48) and some vw-cut C in G such that xvw = 0
and for all e ∈ C we have xe = 1. Let Π be the partition
of V corresponding to M (cid:48) according to Lemma 2. There
exists some U ∈ Π with v ∈ U and w ∈ U . However, for
any uu(cid:48) = e ∈ C it holds that u /∈ U or u(cid:48) /∈ U . This
means the subgraph (U, E ∩ (cid:0)U
(cid:1)) is not connected, as C is
a vw-cut. Hence, Π is not a decomposition of G, which is a
contradiction, because G is connected.

2

Now, suppose x ∈ E(cid:48) satisﬁes all inequalities (4)–(6). We
1(1) is a multicut of G(cid:48). Assume
show ﬁrst that M (cid:48) = x−
the contrary, then there is a cycle C (cid:48) in G(cid:48) and some edge
e(cid:48) such that C (cid:48) ∩ M (cid:48) = {e(cid:48)}. For every vw = f ∈ FGG(cid:48) ∩
C (cid:48) \ {e(cid:48)} there exists a vw-path P in G such that xe = 0
for all e ∈ P . Otherwise there would be some vw-cut in G

Analysis and Optimization of Graph Decompositions by Lifted Multicuts (Supplement)

j-th clause in A, containing one node for each of the
three literals1 in the clause. Every node is labeled with
its corresponding literal. Layer 0 contains only the
node s. Layer n + 1 contains only the node t.

• Any two consecutive layers are connected such that
their nodes together induce a complete bipartite sub-
graph of G. Additionally, any nodes v and w la-
beled with conﬂicting literals, a and ¯a, that are not
already connected in G are connected in G(cid:48) by an edge
{v, w} ∈ E(cid:48) \ E.

• For any edge {v, w} ∈ E(cid:48) whose nodes v and w are
labeled with conﬂicting literals, we set ˜xvw = 1. In
addition, we introduce the edge {s, t} ∈ E(cid:48) \ E and
deﬁne ˜xst = 0. No other edges are in the domain of ˜x.

Observe that ˜x is consistent iff there exists an st-path P in G
such that no edge or chord {v, w} of P is such that ˜xvw = 1.
Any such path is called feasible. All other st-paths in G are
called infeasible.

Now, we show ﬁrstly that the existence of a feasible path
implies the existence of a solution to the given instance of
3-SAT. Secondly, we show that the existence of a solution
to the given instance of 3-SAT implies the existence of a
feasible path. That sufﬁces.

1. Let P be a feasible path and let VP its node set. An
assignment χ to the variables of the instance of 3-SAT
is constructed as follows: For any node v ∈ VP whose
label is a variable a, we deﬁne χ(a) := true. For
any node v ∈ VP whose label is a negated variable ¯a,
we deﬁne χ(a) := false. All remaining variables are
assigned arbitrary truth values. By the properties of P ,
χ is well-deﬁned and A[χ] is true.

2. Let χ be a solution to the given instance of 3-SAT.
As every clause of A contains one literal that is true,
and by construction of G, we can choose an st-path in
G along which all nodes are labeled with literals that
are true for the assignment χ. By virtue of χ being a
solution to the instance of 3-SAT, any pair of literals
that are both true are non-conﬂicting. Thus, P has no
edge or chord {v, w} such that ˜xvw = 1.

Proof of Lemma 6 Firstly, suppose that E ⊆ dom ˜x. In
this case, it is clear that ˜x is consistent iff ˜x satisﬁes all
cycle inequalities (4) w.r.t. the graph (V, E ∩ dom ˜x). This
can be checked in time O(|V | + |E(cid:48)|) as follows: Label the
maximal components of the subgraph G˜x of G induced by
the edge set {e ∈ E : ˜xe = 0}. Then, for every {v, w} ∈
E(cid:48) with ˜xvw = 1, check if v and w are in distinct maximal

1A literal is either a variable a or a negated variable ¯a.

Figure 1. To show that the consistency problem is NP-hard, we
reduce 3-SAT to this problem. Shown above is the instance of the
consistency problem constructed for the instance of 3-SAT given by
the form (a ∨ b ∨ ¯c) ∧ (a ∨ c ∨ ¯d) ∧ (¯a ∨ c ∨ e) ∧ (¯a ∨ c ∨ ¯e). Solid
and dashed lines depict edges in E and E(cid:48) \ E, respectively. Black
means ˜xe = 0. Red means ˜xe = 1. Grey means e /∈ dom ˜x.

violating (6), as G is connected. If we replace every such
f with its associated path P in G, then the resulting cycle
violates either (4) (if e(cid:48) ∈ E) or (5) (if e(cid:48) ∈ FGG(cid:48)). Thus,
M (cid:48) is a multicut of G(cid:48). By connectivity of G, the partition
G(cid:48) (M (cid:48)) is a decomposition of both G(cid:48) and G. Therefore,
φ−
1
G(cid:48) (M (cid:48))) is a multicut of G and
M = λ−
hence M (cid:48) = x−

1(1) is indeed lifted from G.

GG(cid:48)(M (cid:48)) = φG(φ−

1

1

C. Partial Lifted Multicuts

Proof of Theorem 1 Firstly, we show that the consistency
problem is in NP. For that, we show that verifying, for
any given x ∈ {0, 1}E(cid:48)
, that x is a completion of ˜x and a
characteristic function of a multicut of G(cid:48) lifted from G is
a problem of polynomial time complexity. To verify that x
is a completion of ˜x, we verify for every e ∈ dom ˜x that
1(1)
xe = ˜xe. This takes time O(|E|). To verify that x−
is a multicut of G(cid:48) lifted from G, we employ a disjoint set
data structure initialized with singleton sets V . For any
1(0), we call union(v, w). Then, we verify for
{v, w} ∈ x−
1(1) that ﬁnd(v) (cid:54)= ﬁnd(w). This takes
every {v, w} ∈ x−
time O(|E| + |V | log |V |).

To show that the consistency problem is NP-hard, we reduce
3-SAT to this problem. For that, we consider any instance of
3-SAT deﬁned by a propositional logic formula A in 3-SAT
form. An example is shown in Fig. 1. Let m be the number
of variables and n the number of clauses in A.

In order to deﬁne an instance of the consistency prob-
lem w.r.t. this instance of 3-SAT, we construct in poly-
nomial time a connected graph G = (V, E), a graph
G(cid:48) = (V, E(cid:48)) with E ⊆ E(cid:48), and a partial characteristic
function ˜x ∈ {0, 1, ∗}E(cid:48)
as described below. An example
of this construction is shown in Fig. 1.

• There are 3n + 2 nodes in V . Two nodes are denoted
by s and t. Additional nodes are organized in n layers.
For j ∈ {1, . . . , n}, the j-th layer corresponds to the

¯c¯de¯ebcccaa¯a¯astAnalysis and Optimization of Graph Decompositions by Lifted Multicuts (Supplement)

components of G˜x. If so, ˜x is consistent, otherwise ˜x is
inconsistent.
Now, suppose ˜x ∈ {0, 1, ∗}E(cid:48)
satisﬁes (10). We show that,
similar to the ﬁrst case, ˜x is consistent iff all inequalities (4)
and (5) are satisﬁed w.r.t. the graph (V, E(cid:48) ∩ dom ˜x). This
can be checked analogously to the ﬁrst case.

Necessity of this condition is clear. To show sufﬁciency,
assume this condition holds true. We construct some x ∈
XGG(cid:48)[˜x] as follows. For all e ∈ dom ˜x, set xe := ˜xe. For
all {v, w} = f ∈ E(cid:48) \ E such that f /∈ dom ˜x and such
that there is a vw-path P in G with ˜xe = 0 for all e ∈ P ,
set xf := 0. For all remaining edges e, set xe := 1. By
construction, x satisﬁes (4), (5) and (6).

Proof of Theorem 2 To show that the maximal speciﬁcity
problem is NP-hard, we reduce 3-SAT to this problem: For
any given instance of 3-SAT we construct in polynomial
time a connected graph G = (V, E), a graph G(cid:48) = (V, E(cid:48))
with E ⊆ E(cid:48), and a partial characteristic function ˜x ∈
{0, 1, ∗}E(cid:48)
as in the proof of Thm. 1, except that now, we
let st /∈ dom ˜x.
We know that ˜x is consistent because 1 ∈ XGG(cid:48)[˜x]. We
show that ˜x is maximally speciﬁc iff the given instance of
3-SAT has a solution:

Firstly, every e ∈ E(cid:48) \ (dom ˜x ∪ {st}) is undecided, by
the following argument: (i) There exists an x ∈ XGG(cid:48)[˜x]
with xe = 1, namely 1. (ii) There exists an x ∈ XGG(cid:48)[˜x]
with xe = 0, namely the x ∈ {0, 1}E(cid:48)
with xe = 0 and
∀f ∈ E(cid:48) \ {e} : xf = 1. To see that x ∈ XGG(cid:48)[˜x], observe
1(0) = ∅. Thus, st is the only edge in
that e ∈ E and ˜x−
E(cid:48) \ dom ˜x that is possibly decided. That is:

E(cid:48)[˜x] ⊆ {st} ∪ dom ˜x

(42)

Thus, ˜x is maximally speciﬁc iff ˜x is undecided. More
speciﬁcally, ˜x is maximally speciﬁc iff there exists an x ∈
XGG(cid:48)[˜x] with xst = 0, as we know of the existence of
1 ∈ XGG(cid:48)[˜x]. Thus, ˜x is maximally speciﬁc iff the given
instance of 3-SAT has a solution, by the arguments made in
the proof of Thm. 1.

Proof of Lemma 7 Observe that ˜x is maximally speciﬁc
iff clGG(cid:48) ˜x = ˜x. Thus, Lemma 7 follows from Lemma 11.

Proof of Lemma 8 Reﬂexivity is obvious. Antisymmetry:
(˜x ≤ ˜x(cid:48) ∧ ˜x(cid:48) ≤ ˜x) ⇒ (dom ˜x = dom ˜x(cid:48) ∧ ∀e ∈ dom ˜x :
˜xe = ˜x(cid:48)e). Transitivity: Let ˜x ≤ ˜x(cid:48) ≤ ˜x(cid:48)(cid:48). Then dom ˜x ⊆
dom ˜x(cid:48) ⊆ dom ˜x(cid:48)(cid:48) and ∀e ∈ dom ˜x : ˜xe = ˜x(cid:48)e = ˜x(cid:48)(cid:48)e .

existence and uniqueness of the maximum of ˜XGG(cid:48)[˜x] by
construction via dom ˜x(cid:48) = E(cid:48)[˜x].
Let ˜x(cid:48) ∈ ˜XGG(cid:48)[˜x] be maximally speciﬁc and suppose ˜x(cid:48) ≤
˜x(cid:48)(cid:48) for some ˜x(cid:48)(cid:48) ∈ ˜XGG(cid:48)[˜x]. Then dom ˜x(cid:48)(cid:48) = dom ˜x(cid:48),
since XGG(cid:48)[˜x(cid:48)] (cid:54)= XGG(cid:48)[˜x(cid:48)(cid:48)] if dom ˜x(cid:48)(cid:48) \ E(cid:48)[˜x] (cid:54)= ∅. Thus,
˜x(cid:48) = ˜x(cid:48)(cid:48), which means ˜x(cid:48) is maximal w.r.t. ≤ in ˜XGG(cid:48)[˜x].
Conversely, any maximal element ˜x(cid:48) of ˜XGG(cid:48)[˜x] w.r.t. ≤
must satisfy E(cid:48)[˜x] ⊆ dom ˜x(cid:48), which means it is maximally
speciﬁc.
Hence, the unique maximum ˜x(cid:48) ∈ ˜XGG(cid:48)[˜x] is obtained
as follows. For an arbitrary x ∈ XGG(cid:48)[˜x] deﬁne ˜x(cid:48) via
˜x(cid:48)e := xe for all decided edges e ∈ E(cid:48)[˜x].

Proof of Theorem 3 Let us have ˜x, ˜x(cid:48) ∈ ˜XGG(cid:48).

• The implication XGG(cid:48)[˜x] = XGG(cid:48)[˜x(cid:48)] ⇒ ˜XGG(cid:48)[˜x] =
˜XGG(cid:48)[˜x(cid:48)] : follows from the deﬁnition of ˜XGG(cid:48)[˜x] in
Lemma 9.

• The implication ˜XGG(cid:48)[˜x] = ˜XGG(cid:48)[˜x(cid:48)] ⇒ clGG(cid:48) ˜x =
clGG(cid:48) ˜x(cid:48) follows from the deﬁnition of the closure of ˜x
as the maximum of ˜XGG(cid:48)[˜x].

• The implication clGG(cid:48) ˜x = clGG(cid:48) ˜x(cid:48) ⇒ XGG(cid:48)[˜x] =
XGG(cid:48)[˜x(cid:48)] follows from clGG(cid:48) ˜x = clGG(cid:48) ˜x(cid:48) ∈
˜XGG(cid:48)[˜x].

Proof of Lemma 10 Let x ∈ XG and deﬁne y = clGG(cid:48) x.
Since dom x = E, it holds that E(cid:48)[x] = E(cid:48), i.e. all edges
1(1) is a multicut of G(cid:48) and for
are decided. Therefore, y−
all {v, w} = f ∈ E(cid:48) \ E it holds that yf = 0 iff there is a
vw-path P in G such that xe = 0 for all e ∈ P . By Lemma
5, this implies y−

1(1) = λGG(cid:48)(x−

1(1)).

Proof of Theorem 4 Computing closures is at least as
hard as deciding maximal speciﬁcity: To decide maximal
speciﬁcity of ˜x ∈ ˜XGG(cid:48), compute its closure clGG(cid:48) ˜x. Then
˜x is maximally speciﬁc iff dom ˜x = dom clGG(cid:48) ˜x, i.e., if
˜x = clGG(cid:48) ˜x. By Theorem 2, this means computing closures
is NP-hard.

Proof of Lemma 11 Let ˜x ∈ ˜XGG(cid:48) and ˜y = clGG(cid:48) ˜x.

Suppose ﬁrst that E = E(cid:48). We describe how to compute
˜y efﬁciently. Obviously, we must set ˜ye = ˜xe for all e ∈
dom ˜x. Furthermore, we must set ˜yvw = 0 for all {v, w} ∈
E \ dom ˜x such that there is a vw-path P in G with ˜xe = 0
for all e ∈ P . Moreover, we must set ˜yvw = 1 for all
{v, w} ∈ E \ dom ˜x that satisfy

Proof of Lemma 9 We show ﬁrst that ˜x(cid:48) is maximal w.r.t.
≤ in ˜XGG(cid:48)[˜x] iff it is maximally speciﬁc. This implies

∃P ∈ vw-paths(G) ∃!e ∈ P :

˜xe = 1 ∧ ∀e(cid:48) ∈ P \ {e} : ˜xe(cid:48) = 0 .

(43)

Analysis and Optimization of Graph Decompositions by Lifted Multicuts (Supplement)

Therefore, initialize a disjoint-set data structure with sin-
gleton sets V . Apply the union operation on all edges
e ∈ dom ˜x where ˜xe = 0, i.e. contract all 0-labeled edges.
Then, set ˜ye = 0 for all edges that connect nodes of the
same component. If there is an edge e(cid:48) between two compo-
nents such that ˜xe(cid:48) = 1, then for all edges e between those
components set ˜ye = 1. The remaining edges are undecided
by ˜x. In case we only want to decide maximal speciﬁcity,
we can stop upon ﬁnding the ﬁrst edge e ∈ dom ˜y \ dom ˜x.

Now suppose that E ⊆ dom ˜x. In this case, all edges are
decided, because ˜x|E ∈ XG. According to Lemma 10, the
closure ˜y corresponds to the lifting of ˜x|E to G(cid:48). Therefore,
to obtain ˜y, compute the decomposition of G associated to
˜x|E using, e.g., a disjoint-set data structure. Set ˜ye = 0 if e
is an edge within a component. Set ˜ye = 1 if e is an edge
between components.

D. Metrics

Proof of Theorem 5 Symmetry and non-negativity follow
directly from the deﬁnition, and so does dµ
E(cid:48)(x, x) = 0 for
all x ∈ XGG(cid:48)(cid:48). For any e ∈ E(cid:48), the form d1
e on E(cid:48) × E(cid:48) is
a Hamming metric on words of length 1 from the alphabet
{0, 1}. Therefore, it satisﬁes the triangle inequality. Hence,
for any x, y, z ∈ XGG(cid:48)(cid:48) :

dµ
E(cid:48)(x, z) =

µed1

e(x, z)

(cid:88)

E(cid:48)
e
∈
(cid:88)

E(cid:48)
e
∈
(cid:88)

≤

=

µe(d1

e(x, y) + d1

e(y, z))

µed1

e(x, y) +

µed1

e(y, z)

(46)

(cid:88)

e
∈
= dµ

E(cid:48)
E(cid:48)(x, y) + dµ

E(cid:48)
e
∈
E(cid:48)(y, z),

(44)

(45)

(47)

Thus, dµ

E(cid:48) is a pseudo-metric on XGG(cid:48)(cid:48) .

If E ⊆ E(cid:48), then G(cid:48) = G(cid:48)(cid:48) and thus, XGG(cid:48)(cid:48) = XGG(cid:48) ⊆
XG(cid:48). For any two x, x(cid:48) ∈ XGG(cid:48)(cid:48) ⊆ XG(cid:48), it holds that
dµ
E(cid:48)(x, x(cid:48)) = 0 iff d1
e(x, x(cid:48)) = 0 for all e ∈ E(cid:48), i.e. iff
x = x(cid:48). Conversely, suppose there exists some e ∈ E \ E(cid:48).
Deﬁne x, x(cid:48) ∈ XGG(cid:48)(cid:48) via xe(cid:48) = x(cid:48)e(cid:48) = 1 for all e(cid:48) ∈
E(cid:48)(cid:48) \ {e} and xe = 1, x(cid:48)e = 0. It holds that x (cid:54)= x(cid:48) but
dµ
E(cid:48)(x, x(cid:48)) = 0.

Proof of Theorem 6 We ﬁrst prove that ˜dθ
E(cid:48) is a metric
on ˆXGG(cid:48). For any ˜x ∈ ˆXGG(cid:48), we have clGG(cid:48) ˜x = ˜x. Thus,
for all ˜x, ˜x(cid:48) ∈ ˆXGG(cid:48), we have ˜dθ
E(cid:48)(˜x, ˜x(cid:48)).
Therefore, positive deﬁniteness and symmetry are obvious
from the deﬁnition of dθ
E(cid:48)(˜x, ˜x(cid:48)). To establish the triangle
inequality for dθ
e and any edge e ∈ E(cid:48).
Let ˜x, ˜y, ˜z ∈ ˆXGG(cid:48) and consider the inequality

E(cid:48), we prove it for θd1

E(cid:48)(˜x, ˜x(cid:48)) = dθ

θd1

e(˜x, ˜z) ≤ θd1

e(˜x, ˜y) + θd1

e(˜y, ˜z).

(48)

e(˜x, ˜y) + θd1

Table 1. The left- and right-hand side of the inequality θd1
e(˜x, ˜z) ≤
θd1
e(˜y, ˜z) for all possible combinations of values
˜xe, ˜ye, ˜ze where ˜x, ˜y, ˜z ∈ ˆXGG(cid:48) . The right-hand side is always
greater or equal the left-hand side iff 0.5 ≤ θ.
rhs
0
0
0
2θ
1
θ
θ

˜ye
0
1
*
*
1/0
0/*
1/*

lhs
0
0
0
1
1
θ
θ

˜xe
0
1
*
0
0
0
1

˜ze
0
1
*
1
1
*
*

In Tab. 1, the left-hand side and right-hand side of (48) are
evaluated for all possible assignments of values to ˜xe, ˜ye, ˜ze.
It is apparent form this table that (48) holds iff θ ≥ 0.5.
We now show that ˜dθ
E(cid:48) is a pseudo-metric on ˜XGG(cid:48). Sym-
metry and non-negativity are obvious from the deﬁnition.
For all ˜x ∈ ˜XGG(cid:48), we have ˜dθ
E(cid:48)(˜x, ˜x) = 0. Since
E(cid:48)(˜x, ˜x(cid:48)) = ˜dθ
˜dθ
E(cid:48)(clGG(cid:48) ˜x, clGG(cid:48) ˜x(cid:48)) and clGG(cid:48) ˜x ∈ ˆXGG(cid:48)
for any ˜x ∈ ˜XGG(cid:48), the triangle inequality follows from the
fact that ˜dθ

E(cid:48) is a metric on ˆXGG(cid:48).

Finally, it holds that ˜dθ
E(cid:48)(˜x, ˜x(cid:48)) = 0 iff clGG(cid:48) ˜x = clGG(cid:48) ˜x(cid:48),
which in turn is equivalent to ˜XGG(cid:48)[˜x] = ˜XGG(cid:48)[˜x(cid:48)], by
Theorem 3. This proves property (24).

is

= 1 and xe

E. Polyhedral Optimization
Proof of Theorem 7 The all-one vector 1 ∈ {0, 1}E(cid:48)
such that 1 ∈ XGG(cid:48).
For any e ∈ E, xe ∈ {0, 1}E(cid:48)
xe
E
For any f ∈ FGG(cid:48), any f -feasible xf ∈ {0, 1}E(cid:48)
is such
that xf ∈ XGG(cid:48). Moreover, xf can be chosen such that
one shortest path connecting the two nodes in f is the only
component containing more than one node.
For any e ∈ E, let ye ∈ RE(cid:48)

such that xe
FGG(cid:48) = 1 holds xe ∈ XGG(cid:48).

e = 0 and

such that

\{

}

e

ye = 1 − xe .

For any f ∈ F1, choose an f -feasible xf and let yf ∈ RE(cid:48)
such that

yf = 1 − xf −
e

(cid:88)

ye .

E

xf
|

e =0

}

{

∈

For any n ∈ N such that n > 1 and any f ∈ Fn, choose an
f -feasible xf and let yf ∈ RE(cid:48)

such that

yf = 1 − xf −
FGG(cid:48)

f (cid:48)

{

∈

(cid:88)

=f

f (cid:48)
|

∧

yf (cid:48)
xf
f (cid:48) =0
}

(cid:88)

−

ye .

(51)

e

E

{

∈

xf
|

e =0

}

(49)

(50)

(cid:54)
Analysis and Optimization of Graph Decompositions by Lifted Multicuts (Supplement)

are well-deﬁned by induction (over n).

Here, (cid:96)(f (cid:48)) < (cid:96)(f ) ≤ n, by deﬁnition of f -feasibility. Thus,
all yf (cid:48)
Observe that {ye | e ∈ E(cid:48)} is the unit basis in RE(cid:48)
.
Moreover, each of its elements is a linear combination of
{1 − xe | e ∈ E(cid:48)} which is therefore linearly independent.
Thus, {1} ∪ {xe | e ∈ E(cid:48)} is afﬁne independent. It is also
a subset of XGG(cid:48) and, therefore, a subset of ΞGG(cid:48). Thus,
dim ΞGG(cid:48) = |E(cid:48)|.

Proof of Lemma 12 Let {v, w} = f ∈ FGG(cid:48) and let
d(v, w) the length of a shortest vw-path in G. Then,
d(v, w) > 1 because FGG(cid:48) ∩ E = ∅.

If d(v, w) = 2, there exists a u ∈ V such that {v, u} ∈ E
and {u, w} ∈ E. Moreover, {v, u} /∈ FGG(cid:48) and {u, w} /∈
FGG(cid:48), as FGG(cid:48) ∩ E = ∅. Thus, f ∈ F1.

If d(v, w) = m with m > 2, consider any shortest vw-
path P in G. Moreover, let F (cid:48) ⊆ FGG(cid:48) such that, for any
{v(cid:48), w(cid:48)} = f (cid:48) ∈ FGG(cid:48), f (cid:48) ∈ F (cid:48) iff v(cid:48) ∈ P and w(cid:48) ∈ P and
f (cid:48) (cid:54)= f . If F (cid:48) = ∅ then f ∈ F1. Otherwise:

∀{v(cid:48), w(cid:48)} ∈ F (cid:48) :

d(v(cid:48), w(cid:48)) < m

(52)

and thus:

∀f (cid:48) ∈ F (cid:48) ∃nf (cid:48) ∈ N :

f (cid:48) ∈ Fnf (cid:48)

(53)

by induction (over m). Let

n = max
F (cid:48)
f (cid:48)

nf (cid:48)

.

∈

(54)

Then, f ∈ Fn+1.

Proof of Lemma 13 For any {v, w} = f ∈ FGG(cid:48), let P
be a shortest vw-path in G and let

F (cid:48)GG(cid:48) := {{v(cid:48), w(cid:48)} ∈ FGG(cid:48) | v(cid:48) ∈ P ∧ w(cid:48) ∈ P }
F (cid:48)(cid:48)GG(cid:48) := FGG(cid:48) \ F (cid:48)GG(cid:48)
.

(55)

(56)

Moreover, let x ∈ {0, 1}E(cid:48)
xF (cid:48)
it is a shortest path. Thus, x ∈ XGG(cid:48).

GG(cid:48) = 0 and xF (cid:48)(cid:48)

P = 1 and
with xP = 0 and xE
GG(cid:48) = 1. P has no chord in E, because

\

Proof of Theorem 8 Let S = {x ∈ XGG(cid:48) | xe = 1} and
put Σ = conv S.

To show necessity, suppose there is some vw = f ∈ FGG(cid:48)
such that e connects a pair of v-w-cut-vertices. Then, for
any vw-path P in G, either e ∈ P or e is a chord of P .
We claim that we have xf = 1 for any x ∈ S. This gives
dim Σ ≤ |E(cid:48)| − 2, so the inequality xe ≤ 1 cannot deﬁne
a facet of ΞGG(cid:48). If there are no vw-paths that have e as a
chord, then {e} is a vw-cut and the claim follows from the
corresponding inequality of (6). Otherwise, every vw-path

P that has e as a chord contains a subpath P (cid:48) such that
P (cid:48) ∪ {e} is a cycle. Thus, for any x ∈ S, the inequalities
(4) or (5) (for e ∈ E or e ∈ FGG(cid:48), respectively) imply
the existence of some eP (cid:48) ∈ P (cid:48) such that xeP (cid:48) = 1. Let
P denote the set of all such paths P (cid:48). Apparently, the
collection (cid:83)
{eP (cid:48)} ∪ {e} is a v-w-separating set of
edges. Therefore, it contains some subset C that is a vw-cut.
This gives xf = 1 via the inequality of (6) corresponding
to C.

∈P

P (cid:48)

We turn to the proof of sufﬁciency. Assume there is no vw =
f ∈ FGG(cid:48) such that e connects a pair of v-w-cut-vertices in
G. The construction of an afﬁne independent |E(cid:48)|-element-
subset of S ⊂ XGG(cid:48) is analogous to the proof of Theorem
7. The assumption guarantees for any f ∈ FGG(cid:48) with f (cid:54)= e
the existence of an f -feasible x ∈ S such that there is a
vw-path P with xP = 0. In particular, the hierarchy on
FGG(cid:48) deﬁned by the level function (cid:96) remains unchanged
(if e ∈ FGG(cid:48), then (cid:96)(e) ≥ (cid:96)(f ) for all f ∈ FGG(cid:48)). Hence,
dim Σ = |E(cid:48)| − 1, which means Σ is a facet of ΞGG(cid:48).

Proof of Theorem 9 Let S = {x ∈ XGG(cid:48) | xe = 0} and
put Σ = conv S.

Consider the case that e ∈ E. Let G[e] and G(cid:48)[e] be the
graphs obtained from G and G(cid:48), respectively, by contracting
1(1) for x ∈ S corre-
the edge e. The lifted multicuts x−
spond bijectively to the multicuts of G(cid:48)[e] lifted from G[e].
This implies dim Σ = dim ΞG[e]G(cid:48)
. The claim follows
from Theorem 7 and the fact that G(cid:48)[e] has |E(cid:48)| − 1 many
edges if and only if e is not contained in any triangle in G(cid:48).

[e]

Now, suppose uv = e ∈ FGG(cid:48). We show necessity of
Conditions (a)-(c) by proving that if any of them is violated,
then all x ∈ S satisfy some additional, orthogonal equality
and thus, dim Σ ≤ |E(cid:48)| − 2.

First, assume that (a) is violated. Hence, there are edges
e(cid:48), e(cid:48)(cid:48) ∈ E(cid:48) such that T = {e, e(cid:48), e(cid:48)(cid:48)} is a triangle in G(cid:48).
Every x ∈ S satisﬁes the cycle inequalities

xe(cid:48) ≤ xe + xe(cid:48)(cid:48)
xe(cid:48)(cid:48) ≤ xe + xe(cid:48)

(57)

(58)

by Lemma 3 applied to the multicut x−
x ∈ S satisﬁes xe(cid:48) = xe(cid:48)(cid:48) , by (57) and (58) and xe = 0.

1(1) of G(cid:48). Every

Next, assume that (b) is violated. Consider a violating pair
{u(cid:48), v(cid:48)} (cid:54)= {u, v}, u(cid:48) (cid:54)= v(cid:48) of u-v-cut-vertices. For every
x ∈ S, there exists a uv-path P in G with xP = 0, as
xe = 0. Any such path P has a sub-path P (cid:48) from u(cid:48) to v(cid:48)
because u(cid:48) and v(cid:48) are u-v-cut-vertices.

• If the distance of u(cid:48) and v(cid:48) in G(cid:48) is 1, then u(cid:48)v(cid:48) ∈ E(cid:48). If
u(cid:48)v(cid:48) ∈ P , then xu(cid:48)v(cid:48) = 0 because xP = 0. Otherwise,

Analysis and Optimization of Graph Decompositions by Lifted Multicuts (Supplement)

xu(cid:48)v(cid:48) = 0 by xP (cid:48) = 0 and the cycle/path inequality

xu(cid:48)v(cid:48) ≤

xˆe .

(59)

(cid:88)

ˆe

P (cid:48)

∈
Thus xu(cid:48)v(cid:48) = 0 for all x ∈ S.

• If the distance of u(cid:48) and v(cid:48) in G(cid:48) is 2, there is a u(cid:48)v(cid:48)-
path in G(cid:48) consisting of two distinct edges e(cid:48), e(cid:48)(cid:48) ∈ E(cid:48).
We show that all x ∈ S satisfy xe(cid:48) = xe(cid:48)(cid:48):

– If e(cid:48) ∈ P and e(cid:48)(cid:48) ∈ P then xe(cid:48) = xe(cid:48)(cid:48) = 0

because xP = 0.

are both valid for ΞG(cid:48). Moreover, since e(cid:48) ∈ C1, (64) and
(65) imply (63) via

xe ≤

(cid:88)

xe(cid:48)(cid:48) =

(cid:88)

xe(cid:48)(cid:48) + xe(cid:48)

e(cid:48)(cid:48)

∈

e

}

C1
\{
(cid:88)

e(cid:48)(cid:48)

C1

∈

e,e(cid:48)

}

\{
(cid:88)

xe(cid:48)(cid:48) +

xe(cid:48)(cid:48)

e(cid:48)(cid:48)

C2

∈

e(cid:48)

\{

}

≤

=

e,e(cid:48)

e(cid:48)(cid:48)

C1
∈
(cid:88)

\{

}
xe(cid:48)(cid:48).

e(cid:48)(cid:48)

C(cid:48)

∈

e

\{

}

(66)

– If e(cid:48) ∈ P and e(cid:48)(cid:48) /∈ P then xe(cid:48) = xe(cid:48)(cid:48) = 0 by

Thus, (63) is not facet-deﬁning for ΞG(cid:48).

xP = 0 and the cycle/path inequality

xe(cid:48)(cid:48) ≤

(cid:88)

xˆe .

ˆe

P (cid:48)

e(cid:48)

∈
– If e(cid:48) /∈ P and e(cid:48)(cid:48) /∈ P then xe(cid:48) = xe(cid:48)(cid:48) by xP = 0

\{

}

and the cycle/path inequalities
(cid:88)

xe(cid:48)(cid:48) ≤ xe(cid:48) +

xˆe

(60)

(61)

(62)

xe(cid:48) ≤ xe(cid:48)(cid:48) +

xˆe .

P (cid:48)
ˆe
∈
(cid:88)

ˆe

P (cid:48)

∈

Now, assume that (c) is violated. Hence, there exists a u-
v-cut-vertex t and a u-v-separating set of vertices {s, s(cid:48)}
such that {ts, ts(cid:48), ss(cid:48)} is a triangle in G(cid:48). We have that all
x ∈ S satisfy xss(cid:48) = xts + xts(cid:48) as follows. At most one of
xts and xts(cid:48) is 1, because t is a u-v-cut-vertex and {s, s(cid:48)}
is u-v-separating as well. Moreover, xts + xts(cid:48) = 0 if and
only if xss(cid:48) = 0.

(cid:88)

e(cid:48)

E(cid:48)

∈

(cid:40)

For the proof of sufﬁciency, suppose the cycle C of G is
chordless in G(cid:48) and let e ∈ C. Let Σ be a facet of ΞGG(cid:48)
such that ΣGG(cid:48)(e, C) ⊆ Σ and suppose it is induced by the
inequality

ae(cid:48)xe(cid:48) ≤ α

(67)

with a ∈ RE(cid:48)

and α ∈ R, i.e., Σ = conv S, where

S :=

x ∈ XGG(cid:48)

ae(cid:48)xe(cid:48) = α

.

(68)

For convenience, we also deﬁne the linear space

(cid:40)

L :=

x ∈ RE(cid:48)

ae(cid:48)xe(cid:48) = α

.

(69)

(cid:41)

(cid:41)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:88)

e(cid:48)

E(cid:48)

∈

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:88)

e(cid:48)

E(cid:48)

∈

Proof of Theorem 10 Note that both C and P ∪ {f } are
cycles in G(cid:48). We show that, for any chordal cycle C (cid:48) of G(cid:48)
and any e ∈ C (cid:48), the inequality

As 0 ∈ SGG(cid:48)(e, C) ⊆ S, we have α = 0. We show that
(67) is a scalar multiple of (4) and thus ΣGG(cid:48)(e, C) = Σ.
Let y ∈ {0, 1}E(cid:48)

be deﬁned by

xe ≤

(cid:88)

xe(cid:48)

e(cid:48)

C(cid:48)

∈

e

\{

}

(63)

is not facet-deﬁning for ΞG(cid:48). This implies that (63) can-
not be facet-deﬁning for ΞGG(cid:48) either, as ΞGG(cid:48) ⊆ ΞG(cid:48) and
dim ΞGG(cid:48) = dim ΞG(cid:48). Hence, for facet-deﬁningness of (4)
and (5), it is necessary that C and P ∪ {f } be chordless in
G(cid:48).

For this purpose, consider some cycle C (cid:48) of G(cid:48) with a chord
uv = e(cid:48) ∈ E(cid:48). We may write C (cid:48) = P1 ∪ P2 where P1 and
P2 are edge-disjoint uv-paths such that C1 = P1 ∪ {e(cid:48)} and
C2 = P2 ∪ {e(cid:48)} are cycles in G(cid:48). Let e ∈ C (cid:48), then either
e ∈ P1 or e ∈ P2. W.l.o.g. we may assume e ∈ P1. The
inequalities

yC = 0,

yE(cid:48)

C = 1,

\

(70)

i.e. all edges except C are cut. Then y ∈ SGG(cid:48)(e, C) ⊆ S,
since C is chordless.
For any e(cid:48) ∈ C \ {e}, the vector x ∈ {0, 1}E(cid:48)

with

xC

e,e(cid:48)

\{

}

= 0,

xE(cid:48)

C

\

∪{

e,e(cid:48)

}

= 1

(71)

holds x ∈ SGG(cid:48)(e, C) ⊆ S. Therefore, y − x ∈ L. Thus,

∀e(cid:48) ∈ C \ {e} :

ae(cid:48) = −ae .

(72)

xe ≤

(cid:88)

xe(cid:48)(cid:48),

xe(cid:48)(cid:48)

e(cid:48)(cid:48)

∈

e

}

C1
\{
(cid:88)

e(cid:48)(cid:48)

C2

∈

e(cid:48)

\{

}

xe(cid:48) ≤

(64)

(65)

It remains to show that ae(cid:48) = 0 for all edges e(cid:48) ∈ E(cid:48) \C. We
proceed by considering edges from E and FGG(cid:48) separately.
We consider the nodes u, v ∈ V such that uv = e(cid:48). W.l.o.g.,
we assume that v does not belong to C. This is possible
because C does not have a chord in G(cid:48).

Firstly, consider e(cid:48) ∈ E and distinguish the following cases:

Analysis and Optimization of Graph Decompositions by Lifted Multicuts (Supplement)

(i) If e(cid:48) connects two nodes not contained in C or it is the
only edge connecting some node in C to v, then for
x ∈ {0, 1}E(cid:48)

, deﬁned by

xC = 0,

xe(cid:48) = 0,

xE(cid:48)

(C

\

e(cid:48)

∪{

}

) = 1,

(73)

it holds that x ∈ SGG(cid:48)(e, C) ⊆ S. Therefore, y − x ∈
L, which evaluates to ae(cid:48) = 0.

(ii) Otherwise,

let E(cid:48)C,v

:= {{u(cid:48), v} ∈ E(cid:48)

|
u(cid:48) belongs to C} denote the set of edges in E(cid:48) that
connect v to some node in C. By assumption, we have
that |E(cid:48)C,v| ≥ 2. Now, pick some direction on C and
traverse C from one endpoint of e to the other endpoint
of e. We may order the edges E(cid:48)C,v = {e1, . . . , ek}
such that the endpoint of ei appears before the endpoint
of ei+1 in the traversal of C. We show that aei = 0 for
all 1 ≤ i ≤ k:
For the vector x ∈ {0, 1}E(cid:48)

deﬁned by

xe(cid:48)(cid:48) =






0
0
1

if e(cid:48)(cid:48) ∈ C
if e(cid:48)(cid:48) ∈ E(cid:48)C,v
else,

(74)

it holds that x ∈ SGG(cid:48)(e, C) ⊆ S. Therefore, y − x ∈
L. Thus:

Figure 2. The ﬁgure illustrates the argument from case (ii) in the
proof of Theorem 10 for the cycle C = {e, e(cid:48)(cid:48), e(cid:48)(cid:48)(cid:48)}.
In this
example, e3 = e(cid:48), e1 ∈ FGG(cid:48) and e2 ∈ E. The left multicut is
chosen for i = 1 and the right one for i = 2.

by (72). If ei ∈ FGG(cid:48), we similarly obtain

(cid:88)

0 =

i+1

j

k

aej − ae − ae(cid:48)(cid:48) =

aej .

(85)

(cid:88)

i+1

j

k

≤

≤

≤

≤
Together with (75), this yields (cid:80)
i aej = 0 as
1
well. Applying this argument repeatedly from i = 1 to
i = m − 1, we conclude that ae1 = . . . = aem−1 = 0.
By reversing the order of the edges in E(cid:48)C,v, it can
be shown analogously that aek = aek−1 = . . . =
aem+1 = 0. Thus, by (75), ae(cid:48) = aem = 0.

≤

≤

j

aei = 0.

(cid:88)

1

i

k

≤

≤

(75)

Next, consider e(cid:48) ∈ FGG(cid:48) and distinguish the following
additional cases:

(iii) Suppose there is a uv-path P (cid:48) in G that does not con-

tain any node from C. Deﬁne x ∈ {0, 1}E(cid:48)

via

Consider the m ∈ {1, . . . , k} such that e(cid:48) = em. For
any i with 1 ≤ i ≤ m − 1, consider the following
construction that is illustrated also in Fig. 2: Let e(cid:48)(cid:48) ∈
C be some edge between the endpoints of ei and ei+1.
If ei ∈ E, deﬁne x ∈ {0, 1}E(cid:48)

via

If ei ∈ FGG(cid:48), deﬁne x ∈ {0, 1}E(cid:48)

via

xe = xe(cid:48)(cid:48) = 1
= 0
xC

\{

e,e(cid:48)(cid:48)
∀j ≤ i : xej = 0
∀j > i : xej = 1

}

xe = xe(cid:48)(cid:48) = 1
= 0
xC

\{

e,e(cid:48)(cid:48)
∀j ≤ i : xej = 1
∀j > i : xej = 0

}

(76)

(77)

(78)

(79)

(80)

(81)

(82)

(83)

Either way, it holds that x ∈ SGG(cid:48)(e, C) ⊆ S and thus,
y − x ∈ L. If ei ∈ E, this yields

(cid:88)

0 =

1

j

i

≤

≤

aej − ae − ae(cid:48)(cid:48) =

(84)

(cid:88)

aej

1

j
≤

≤

i

xe(cid:48)(cid:48) =





0
0
0
1

if e(cid:48)(cid:48) ∈ C
if e(cid:48)(cid:48) = e(cid:48)
if e(cid:48)(cid:48) ∈ P (cid:48) or e(cid:48)(cid:48) is a chord of P (cid:48)
else.

(86)

Then x ∈ SGG(cid:48)(e, C) ⊆ S and thus y − x ∈ L. This
gives

ae(cid:48) +

ae(cid:48)(cid:48) +

ae(cid:48)(cid:48) = 0.

(87)

(cid:88)

e(cid:48)(cid:48)

P (cid:48)

∈

(cid:88)

e(cid:48)(cid:48) chord
of P (cid:48)

We argue that all terms except ae(cid:48) vanish by induction
over the level function (cid:96)(e(cid:48)). If (cid:96)(e(cid:48)) = 1, then P (cid:48)
does not have any chords from FGG(cid:48), thus ae(cid:48) = 0,
because ae(cid:48)(cid:48) = 0 for all e(cid:48)(cid:48) ∈ E as shown previously
in the cases (i) and (ii). If (cid:96)(e(cid:48)) > 1, then for any chord
e(cid:48)(cid:48) ∈ FGG(cid:48) of P (cid:48) it holds that (cid:96)(e(cid:48)(cid:48)) < (cid:96)(e(cid:48)). The
induction hypothesis provides ae(cid:48)(cid:48) = 0 and hence we
conclude ae(cid:48) = 0.

(iv) Suppose u is contained in C. Pick a shortest uv-path
P (cid:48) in G. We argue inductively over the length of P (cid:48),

vee000e00e2e1e3vee000e00e2e1e3Analysis and Optimization of Graph Decompositions by Lifted Multicuts (Supplement)

which we denote by d(P (cid:48)). If d(P (cid:48)) = 1, then P (cid:48)
consists of only one edge from E. This situation is
in fact already covered by case (ii). If d(P (cid:48)) > 1,
then we employ an argument similar to (ii) as follows.
Let FC,v := {{u(cid:48), v} ∈ FGG(cid:48) | u(cid:48) belongs to C} =
{f1, . . . , fk} be the set of edges fi ∈ FGG(cid:48) that con-
nect v to some node in C. Again, assume they are
ordered such that the endpoint of fi appears before the
endpoint of fi+1 on C in a traversal from e to itself.
For the vector x ∈ {0, 1}E(cid:48)

deﬁned by

xe(cid:48)(cid:48) =






0
0
0

0
1

if e(cid:48)(cid:48) ∈ C
if e(cid:48)(cid:48) ∈ P (cid:48) or e(cid:48)(cid:48) is a chord of P (cid:48)
if e(cid:48)(cid:48) = u(cid:48)v(cid:48) where u(cid:48) belongs to C,
v(cid:48) (cid:54)= v belongs to P (cid:48)

if e(cid:48)(cid:48) ∈ FC,v
else,

(88)

it holds that x ∈ SGG(cid:48)(e, C) ⊆ S and thus y − x ∈ L.
This yields

ae(cid:48)(cid:48) +

(cid:88)

ae(cid:48)(cid:48)

(cid:88)

e(cid:48)(cid:48)

P (cid:48)

∈

e(cid:48)(cid:48) chord
of P (cid:48)

ae(cid:48)(cid:48) +

(cid:88)

e(cid:48)(cid:48)

FC,v

∈

(cid:88)

+

e(cid:48)(cid:48)=u(cid:48)v(cid:48):
u(cid:48) belongs to C,
=v belongs to P (cid:48)

v(cid:48)

ae(cid:48)(cid:48) = 0

(89)

and thus

(cid:88)

1

i
≤

k

(cid:88)

afi =

e(cid:48)(cid:48)

FC,v

ae(cid:48)(cid:48) = 0,

(90)

≤

∈
as all other terms vanish (apply the induction hypoth-
esis to all u(cid:48)v(cid:48) ∈ FGG(cid:48) where u(cid:48) belongs to C and
(cid:54)= v belongs to P (cid:48)). Let m be the highest index
v(cid:48)
such that the endpoint of fm appears before the end-
point of P (cid:48) on C. Now, for any i with 1 ≤ i ≤ m, pick
an edge e(cid:48)(cid:48) ∈ C between the endpoint of fi and the
endpoint of fi+1 and before the endpoint of P (cid:48) on C.
Deﬁne x ∈ {0, 1}E(cid:48)

by

xg =






0
0
0

0
1

if g ∈ C \ {e, e(cid:48)(cid:48)}
if g ∈ P (cid:48) or g is a chord of P (cid:48)
if g = u(cid:48)v(cid:48) where
u(cid:48) appears before endpoint of P (cid:48) on C,
v(cid:48) (cid:54)= v belongs to P (cid:48)
if g = fj ∀j > i
else.

(91)

Then, it holds that x ∈ SGG(cid:48)(e, C) ⊆ S and thus
y − x ∈ L. This yields, after removing all zero terms

(apply the induction hypothesis once more),
(cid:88)

afj = 0.

i+1

j

k

≤

≤

Together with (90), we obtain

afi = 0.

(cid:88)

1

j

i

≤

≤

Applying this argument repeatedly for i = 1 to i = m,
we conclude af1 = . . . = afm = 0. Similarly, we
obtain afk = afk−1 = . . . = afm = 0, by reversing
the direction of traversal of C and employing the same
reasoning.

(v) Finally, suppose neither u nor v belong to the cycle
C, but every uv-path in G shares at least one node
with C. Let P (cid:48) be such a uv-path. Deﬁne the vector
x ∈ {0, 1}E(cid:48)


by

xe(cid:48)(cid:48) =




0
0
0
0

1

if e(cid:48)(cid:48) ∈ C
if e(cid:48)(cid:48) = e(cid:48)
if e(cid:48)(cid:48) ∈ P (cid:48) or e(cid:48)(cid:48) is a chord of P (cid:48)
if e(cid:48)(cid:48) = u(cid:48)v(cid:48) where u(cid:48) belongs to C,

v(cid:48) belongs to P (cid:48)

else.

It holds that x ∈ SGG(cid:48)(e, C) ⊆ S and thus y − x ∈ L.
This gives

ae(cid:48) +

ae(cid:48)(cid:48) +

ae(cid:48)(cid:48) +

ae(cid:48)(cid:48) = 0.

(cid:88)

e(cid:48)(cid:48)

P (cid:48)

∈

(cid:88)

e(cid:48)(cid:48) chord
of P (cid:48)

(cid:88)

e(cid:48)(cid:48)=u(cid:48)v(cid:48):
u(cid:48) belongs to C,
v(cid:48) belongs to P (cid:48)

(92)

(93)

(94)

(95)

We argue inductively over the level function (cid:96)(e(cid:48)). If
(cid:96)(e(cid:48)) = 1, then P (cid:48) does not have any chords and our
consideration in cases (i)–(iv) yield that all terms ex-
cept ae(cid:48) vanish. If (cid:96)(e(cid:48)) > 1, then we additionally
employ the induction hypothesis to achieve the same
result. Hence, it holds that ae(cid:48) = 0 as well.

The proof of sufﬁciency in the second assertion is com-
pletely analogous (replace C by P ∪ {f } and e by f ). The
chosen multicuts remain valid, because e = f is the only
edge in the cycle that is not contained in E.
Proposition 1 For every connected graph G = (V, E), ev-
ery graph G(cid:48) = (V, E(cid:48)) with E ⊆ E(cid:48), every vw ∈ FGG(cid:48)
and every C ∈ vw-cuts(G), the following holds:

(a) Every x ∈ SGG(cid:48)(vw, C) deﬁnes a decomposition of
G into (vw, C)-connected components. That is, every
maximal component of the graph (V, {e ∈ E|xe = 0})
is (vw, C)-connected. At most one of these is properly
(vw, C)-connected. It exists iff xvw = 0.

(cid:54)
Analysis and Optimization of Graph Decompositions by Lifted Multicuts (Supplement)

(b) For every (vw, C)-connected component (V ∗, E∗) of
such that ∀rs ∈ E(cid:48)(xrs = 0 ⇔

G, the x ∈ {0, 1}E(cid:48)
r ∈ V ∗ ∧ s ∈ V ∗) is such that x ∈ SGG(cid:48)(vw, C).

• Otherwise, there exists an e ∈ P such that e /∈ E∗.
Therefore, xe = 1, by (100). Thus, (5) holds, as the
r.h.s. is at least 1.

Proof of Proposition 1 a) Let x ∈ SGG(cid:48)(vw, C) arbitrary.
Let E0 := {e ∈ E|xe = 0} and let G0 := (V, E0).

For any st ∈ FGG(cid:48) and any C (cid:48) ∈ st-cuts(G), distinguish
two cases:

If xvw = 1 then ∀e ∈ C : xe = 1, by (35). Thus, every
component of G0 is improperly (vw, C)-connected.

If xvw = 0 then

∃e ∈ C(xe = 0 ∧ ∀e(cid:48) ∈ C \ {e}(xe(cid:48) = 1))

(96)

by (35). Let (V ∗, E∗) the maximal component of G0 with

e ∈ E∗ .

Clearly:

∀e(cid:48) ∈ C \ {e} : e(cid:48) /∈ E∗

(97)

(98)

by (96) and deﬁnition of G0. There does not exist a C (cid:48) ∈
vw-cuts(G) with xC(cid:48) = 1, because this would imply xvw =
1, by (6). Thus, there exists a P ∈ vw-paths(G) with
xP = 0, as G is connected. Any such path P has e ∈ P , as
P ∩ C (cid:54)= ∅ and C ∩ E0 = {e} and P ⊆ E0. Thus:

v ∈ V ∗ ∧ w ∈ V ∗

(99)

by (97). (V ∗, E∗) is properly (vw, C)-connected, by (97),
(98) and (99). Any other component of G0 does not cross
the cut, by (96), (97) and deﬁnition of G0, and is thus im-
properly (vw, C)-connected.

b) We have

∀st ∈ E : xst = 0 ⇔ st ∈ E∗

(100)

by the following argument:

• If st ∈ E∗, then s ∈ V ∗ ∧ t ∈ V ∗, as (V ∗, E∗) is a

graph. Thus, xst = 0, by deﬁnition of x.

• If st /∈ E∗ then s /∈ V ∗ ∨ t /∈ V ∗, as (V ∗, E∗) is a
component of G. Thus, xst = 1, by deﬁnition of x.

Consider the decomposition of G into (V ∗, E∗) and single-
ton components. E1 := {e ∈ E|xe = 1} is the set of edges
that straddle distinct components of this decomposition, by
(100). Therefore, E1 is a multicut of G, by Lemma 2. Thus,
(4) holds, by Lemma 3.

For any st ∈ FGG(cid:48) and any P ∈ st-paths(G), distinguish
two cases:

• If C (cid:48) ∩ E∗ = ∅ then s /∈ V ∗ ∨ t /∈ V ∗. Therefore,
xst = 1, by deﬁnition of x. Moreover, xC(cid:48) = 1, by
(100). Thus, (6) evaluates to 0 = 0.

• Otherwise, there exists an e ∈ C (cid:48) such that e ∈ E∗.
Therefore, xe = 0, by (100). Thus, (6) holds, as the
r.h.s. is at least 1.

Proof of Theorem 11 Assume that C1 does not hold (as in
Fig. 4a). Then, there exists an e ∈ C such that no (vw, C)-
connected component of G contains e. Thus, for all x ∈
SGG(cid:48)(vw, C):

xe = 1

(101)

by Proposition 1. Now, dim ΣGG(cid:48)(vw, C) ≤ |E(cid:48)| − 2, by
(35) and (101). Thus, ΣGG(cid:48)(vw, C) is not a facet of ΞGG(cid:48),
by Theorem 7.

Assume that C2 does not hold. Then, for any e ∈ C there
exists some number m such that for all (vw, C)-connected
components (V ∗, E∗) with e ∈ E∗ it holds that |F ∩FV ∗ | =
m. Thus, we can write

C =

C(F, m),

(102)

F
|(cid:91)
|

m=0

where C(F, m) := (cid:8)e ∈ C | |F ∩ FV ∗ | = m ∀ (vw, C)-
(cid:9). It follows that for all
connected (V ∗, E∗) with e ∈ E∗
x ∈ SGG(cid:48)(vw, C) we have the equality

F
|(cid:88)
|

m

(cid:88)

m=0

e

C(F,m)

∈

(cid:88)

f (cid:48)

F

∈

(1 − xe) =

(1 − xf (cid:48))

(103)

by the following argument:

• If xe = 1 for all e ∈ C, then xf (cid:48) = 1 for all
v(cid:48)w(cid:48) = f (cid:48) ∈ F , since C is also a v(cid:48)w(cid:48)-cut. Thus,
(103) evaluates to 0 = 0.

• Otherwise there exists precisely one edge e ∈ C such
that xe = 0. Let m be such that e ∈ C(F, m). By
deﬁnition of C(F, m), there are exactly m edges f (cid:48) ∈
F with xf (cid:48) = 0. Thus, (103) evaluates to m = m.

• If P ⊆ E∗, then s ∈ V ∗ ∧ t ∈ V ∗, as (V ∗, E∗) is a
graph. Thus, xst = 0, by deﬁnition of x. Moreover,
xP = 0, by (100). Hence, (5) evaluates to 0 = 0.

Assume that condition C3 does not hold. Then there exists
an f (cid:48) ∈ FGG(cid:48)(vw, C), a set ∅ (cid:54)= F ⊆ FGG(cid:48)(vw, C) and

Analysis and Optimization of Graph Decompositions by Lifted Multicuts (Supplement)

a)

b)

• If xvw = 1, then xEP = 1, by (35) and (6). Thus,

(108) evaluates to 1 = 1, by (109).

• If xvw = 0, the decomposition of G deﬁned by x con-
tains precisely one properly (vw, C)-connected com-
ponent (V ∗, E∗) of G, by Proposition 1. Without loss
of generality, (106) holds. Otherwise, that is, if (107)
holds, exchange v and w.

Consider the nodes VP as depicted in Fig. 3a: v1 =
v(cid:48) ∈ V ∗, by (106). For every even j, vj ∈ V (w, C),
by deﬁnition of P . Thus:

∀j ∈ {1, . . . , (|EP | + 1)/2} : v2j ∈ V ∗

(110)

by (106).

Consider the edges EP as depicted in Fig. 3a: e1 =
v1v2 ∈ E∗, as v1 ∈ V ∗ and v2 ∈ V ∗ and as (V ∗, E∗)
is a component of G. Thus,

xe1 = 0

(111)

by Proposition 1. For every j ∈ {1, . . . , (|EP |−1)/2},
distinguish two cases:

– If v2j+1 ∈ V ∗, then e2j = v2jv2j+1 ∈ E∗ and
e2j+1 = v2j+1v2j+2 ∈ E∗, because v2j ∈ V ∗
and v2j+2 ∈ V ∗, by (110), and because (V ∗, E∗)
is a component of G. Thus:

xe2j = 0 ∧ xe2j+1 = 0 .

(112)

– If v2j+1 /∈ V ∗, then e2j = v2jv2j+1 and e2j+1 =
v2j+1v2j+2 straddle distinct components of the
decomposition of G deﬁned by x, because v2j ∈
V ∗ and v2j+2 ∈ V ∗, by (110). Thus:

xe2j = 1 ∧ xe2j+1 = 1 .

(113)

Figure 3. Depicted are the nodes (in black) and edges (in green)
on a path (a) and on a cycle (b), respectively. Nodes in the set
V (cid:48) are are either in V ∗ (ﬁlled circle) or not in V ∗ (open circle).
Consequently, pairs of consecutive edges are either cut (dotted
lines) or not cut (solid lines).

some k ∈ N such that for all (vw, C) connected components
(V ∗, E∗) and (V ∗∗, E∗∗) with f (cid:48) ∈ FV ∗ and f (cid:48) /∈ FV ∗∗ it
holds that

|F ∩ FV ∗ | = k and |F ∩ FV ∗∗ | = 0.

(104)

In other words, for all x ∈ SGG(cid:48)(vw, C) it holds that xf (cid:48) =
0 iff there are exactly k edges f (cid:48)(cid:48) ∈ F such that xf (cid:48)(cid:48) = 0.
Similarly, it holds that xf (cid:48) = 1 iff for all f (cid:48)(cid:48) ∈ F we
have xf (cid:48)(cid:48) = 1. Therefore, all x ∈ SGG(cid:48)(vw, C) satisfy the
additional equality

k(1 − xf (cid:48)) =

1 − xf (cid:48)(cid:48).

(105)

(cid:88)

f (cid:48)(cid:48)

F

∈

Assume that C4 does not hold. Then, there exist v(cid:48) ∈
V (v, C) and w(cid:48) ∈ V (w, C) and a v(cid:48)w(cid:48)-path P = (VP , EP )
in G(cid:48)(vw, C) such that every properly (vw, C)-connected
component (V ∗, E∗) of G holds:

(v(cid:48) ∈ V ∗ ∧ V (w, C) ∩ VP ⊆ V ∗)
∨ (w(cid:48) ∈ V ∗ ∧ V (v, C) ∩ VP ⊆ V ∗) .

(106)

(107)

In any case:

Let v1 < · · · < v
VP
|
let e1 < · · · < e
EP
|
v(cid:48)w(cid:48)-path P . Now, for all x ∈ SGG(cid:48)(vw, C):

the linear order of the nodes VP and
|
the linear order of the edges EP in the

|

∀j ∈ {1, . . . , (|EP | − 1)/2} : xe2j − xe2j+1 = 0 .
(114)

Thus, (108) evaluates to 0 = 0, by (109), (111), (114).

xvw =

(−1)j+1xej

(108)

EP
|(cid:88)
|

j=1

|EP | is odd, as the path P
by the following argument:
alternates between the set V (v, C) where it begins and the
set V (w, C) where it ends. Thus,

Assume that C5 does not hold. Then, there exists a cy-
cle Y = (VY , EY ) in G(cid:48)(vw, C) such that every properly
(vw, C)-connected component (V ∗, E∗) of G holds:

VY ∩ V (v, C) ⊆ V ∗
∨ VY ∩ V (w, C) ⊆ V ∗ .

(115)

(116)

EP
|(cid:88)
|

EP
(
|
(−1)j+1xej = xe1 −

|−
(cid:88)

1)/2
(xe2j − xe2j+1) .

(109)

j=1

j=1

Let v0 < · · · < v
VY
|
V (v, C) and, for all j ∈ {0, . . . , |EY | − 1}:

1 an order on VY such that v0 ∈

|−

Distinguish two cases:

ej := {vj, vj+1 mod

} ∈ EY .

(117)

EY
|

|

v6=w0v5v4v3v2v0=v1e5e4e3e2e1V0v3v2v1v0e0e3e2e1V0Analysis and Optimization of Graph Decompositions by Lifted Multicuts (Supplement)

Now, for all x ∈ SGG(cid:48)(vw, C):

EY
1
|−
|
(cid:88)
(−1)jxej
0 =

j=0

(118)

by the following argument: |EY | is even, as the cycle Y
alternates between the sets V (v, C) and V (w, C). Thus,

EY
EY
(
1
|
|−
|
(cid:88)
(−1)jxej =

|−
(cid:88)

2)/2
(xe2j − xe2j+1) .

(119)

j=0

j=0

Distinguish two cases:

• If xvw = 1, then xEY = 1, by (35) and (6). Thus,

(118) evaluates to 0 = 0, by (119).

• If xvw = 0, the decomposition of G deﬁned by x con-
tains precisely one properly (vw, C)-connected com-
ponent (V ∗, E∗) of G, by Proposition 1. Without loss
of generality, (115) holds. Otherwise, that is, if (116)
holds, exchange v and w.
Consider the nodes VY as depicted in Fig. 3b: For
every even j, vj ∈ V (v, C), by deﬁnition of Y and the
order. Thus:

∀j ∈ {0, . . . , (|EY | − 2)/2} : v2j ∈ V ∗

(120)

by (115).

Consider the edges EY as depicted in Fig. 3b: For ev-
ery j ∈ {0, . . . , (|EY | − 2)/2}, distinguish two cases:

– If v2j+1 ∈ V ∗, then e2j = v2jv2j+1 ∈ E∗ and
∈ E∗, because
e2j+1 = v2j+1v2j+2 mod
v2j ∈ V ∗ and v2j+2 mod
∈ V ∗, by (120),
and because (V ∗, E∗) is a component of G. Thus:

EY
|
EY
|

|

|

xe2j = 0 ∧ xe2j+1 = 0 .

(121)

– If v2j+1 /∈ V ∗,

then e2j = v2jv2j+1 and
straddle distinct
e2j+1 = v2j+1v2j+2 mod
components of the decomposition of G deﬁned by
x, because v2j ∈ V ∗ and v2j+2 mod
∈ V ∗,
by (120). Thus:

EY
|

EY
|

|

|

xe2j = 1 ∧ xe2j+1 = 1 .

(122)

In any case:

∀j ∈ {0, . . . , (|EY | − 2)/2} : xe2j − xe2j+1 = 0 .
(123)

Thus, (118) evaluates to 0 = 0, by (119) and (123).

Acknowledgements

The examples depicted in Fig. 4h and 4j were proposed by
Banafsheh Grochulla and Ashkan Mokarian, respectively.

Analysis and Optimization of Graph Decompositions by Lifted Multicuts (Supplement)

b)

c)

d)

f)

g)

i)

j)

a)

e)

h)

k)

Figure 4. Depicted above are graphs G = (V, E) (in black) and G(cid:48) = (V, E(cid:48)) with E ⊆ E(cid:48) (E(cid:48) in green), distinct nodes v, w ∈ V and
a vw-cut C of G (as dotted lines). In any of the above examples, one condition of Theorem 11 is violated and thus, ΣGG(cid:48) (vw, C) is
not a facet of the lifted multicut polytope ΞGG(cid:48) . a) Condition C1 is violated for e. b) Condition C2 is violated as r and s are connected
in any (vw, C)-connected component. c) Condition C2 is violated as r and s are not connected in any (vw, C)-connected component.
d) Condition C2 is violated. Speciﬁcally, C({f (cid:48)}, 1) = {e0} and C({f (cid:48)}, 0) = {e1} in the proof of Theorem 11. e) Condition C2 is
violated for F = {f1, f2}. f) Condition C3 is violated. g) Condition C3 is violated for F = {f1, f2} and k = 1. h) Condition C4 is
violated for the v(cid:48)w(cid:48)-path f1f2f3. i) Condition C4 is violated for the v(cid:48)w(cid:48)-path ef1f2. j) Condition C5 is violated for the cycle f1f2f3f4.
k) Condition C5 is violated for the cycle ef1f2f3.

vwe0eff0fvrw=sef0fe0vrswe0e1f0fvwfvwf1f2f0f00fvwf0vwf1f2ff3f2f1fvv0w0wfv=v0w=w0f1f2f0eff1f2f3f4vwfvwf3f1f2e