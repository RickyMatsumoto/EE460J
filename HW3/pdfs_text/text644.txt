Latent Intention Dialogue Models

Tsung-Hsien Wen 1 * Yishu Miao 2 * Phil Blunsom 2 Steve Young 1

Abstract

Developing a dialogue agent that is capable of
making autonomous decisions and communicat-
ing by natural language is one of the long-term
goals of machine learning research. Traditional
approaches either rely on hand-crafting a small
state-action set for applying reinforcement learn-
ing that is not scalable or constructing determin-
istic models for learning dialogue sentences that
fail to capture natural conversational variability.
In this paper, we propose a Latent Intention Dia-
logue Model (LIDM) that employs a discrete la-
tent variable to learn underlying dialogue inten-
tions in the framework of neural variational infer-
ence. In a goal-oriented dialogue scenario, these
latent intentions can be interpreted as actions
guiding the generation of machine responses,
which can be further reﬁned autonomously by re-
inforcement learning. The experimental evalua-
tion of LIDM shows that the model out-performs
published benchmarks for both corpus-based and
human evaluation, demonstrating the effective-
ness of discrete latent variable models for learn-
ing goal-oriented dialogues.

1. Introduction

Recurrent neural networks (RNNs) have shown impres-
sive results in modeling generation tasks that have a se-
quential structured output form, such as machine transla-
tion (Sutskever et al., 2014; Bahdanau et al., 2015), caption
generation (Karpathy & Fei-Fei, 2015; Xu et al., 2015),
and natural language generation (Wen et al., 2015; Kid-
don et al., 2016). These discriminative models are trained
to learn only a conditional output distribution over strings
and despite the sophisticated architectures and condition-

*Equal contribution 1Department of Engineering, University of
Cambridge, Cambridge, United Kingdom 2Department of Com-
puter Science, University of Oxford, Oxford, United Kingdom.
Correspondence to: Tsung-Hsien Wen <thw28@cam.ac.uk>,
Yishu Miao <yishu.miao@cs.ox.ac.uk>.

Proceedings of the 34 th International Conference on Machine
Learning, Sydney, Australia, PMLR 70, 2017. Copyright 2017
by the author(s).

ing mechanisms used to ensure salience, they are not able
to model the underlying actions needed to generate natural
dialogues. As a consequence, these sequence-to-sequence
models are limited in their ability to exhibit the intrinsic
variability and stochasticity of natural dialogue. For exam-
ple both goal-oriented dialogue systems (Wen et al., 2017;
Bordes & Weston, 2017) and sequence-to-sequence learn-
ing chatbots (Vinyals & Le, 2015; Shang et al., 2015; Ser-
ban et al., 2015) struggle to generate diverse yet causal re-
sponses (Li et al., 2016a; Serban et al., 2016). In addition,
there is often insufﬁcient training data for goal-oriented di-
alogues which results in over-ﬁtting and prevents determin-
istic models from learning effective and scalable interac-
tions. In this paper, we propose a latent variable model –
Latent Intention Dialogue Model (LIDM) – for learning the
complex distribution of communicative intentions in goal-
oriented dialogues. Here, the latent variable representing
dialogue intention can be considered as the autonomous
decision-making center of a dialogue agent for composing
appropriate machine responses.

Recent advances in neural variational inference (Kingma
& Welling, 2014; Mnih & Gregor, 2014) have sparked a
series of latent variable models applied to NLP (Bowman
et al., 2015; Serban et al., 2016; Miao et al., 2016; Cao &
Clark, 2017). For models with continuous latent variables,
the reparameterisation trick (Kingma & Welling, 2014) is
commonly used to build an unbiased and low-variance gra-
dient estimator for updating the models. However, since a
continuous latent space is hard to interpret, the major bene-
ﬁts of these models are the stochasticity and the regularisa-
tion brought by the latent variable. In contrast, models with
discrete latent variables are able to not only produce inter-
pretable latent distributions but also provide a principled
framework for semi-supervised learning (Kingma et al.,
2014). This is critical for NLP tasks, especially where ad-
ditional supervision and external knowledge can be utilized
for bootstrapping (Faruqui et al., 2015; Miao & Blunsom,
2016; Koˇcisk´y et al., 2016). However, variational inference
with discrete latent variables is relatively difﬁcult due to the
problem of high variance during sampling. Hence we in-
troduce baselines, as in the REINFORCE (Williams, 1992)
algorithm, to mitigate the high variance problem, and carry
out efﬁcient neural variational inference (Mnih & Gregor,
2014) for the latent variable model.

Latent Intention Dialogue Models

In the LIDM, the latent intention is inferred from user in-
put utterances. Based on the dialogue context, the agent
draws a sample as the intention which then guides the natu-
ral language response generation. Firstly, in the framework
of neural variational inference (Mnih & Gregor, 2014), we
construct an inference network to approximate the posterior
distribution over the latent intention. Then, by sampling the
intentions for each response, we are able to directly learn
a basic intention distribution on a human-human dialogue
corpus by optimising the variational lower bound. To fur-
ther reduce the variance, we utilise a labeled subset of the
corpus in which the labels of intentions are automatically
generated by clustering. Then, the latent intention distri-
bution can be learned in a semi-supervised fashion, where
the learning signals are either from the direct supervision
(labeled set) or the variational lower bound (unlabeled set).

From the perspective of reinforcement learning, the latent
intention distribution can be interpreted as the intrinsic pol-
icy that reﬂects human decision-making under a particular
conversational scenario. Based on the initial policy (la-
tent intention distribution) learnt from the semi-supervised
variational inference framework, the model can reﬁne its
strategy easily against alternative objectives using policy
gradient-based reinforcement learning. This is somewhat
analogous to the training process used in AlphaGo (Silver
et al., 2016) for the game of Go. Based on LIDM, we show
that different learning paradigms can be brought together
under the same framework to bootstrap the development of
a dialogue agent (Li et al., 2016c; Weston, 2016).

In summary, the contribution of this paper is two-fold:
ﬁrstly, we show that the neural variational inference frame-
work is able to discover discrete, interpretable intentions
from data to form the decision-making basis of a dialogue
agent; secondly, the agent is capable of revising its con-
versational strategy based on an external reward within
the same framework. This is important because it pro-
vides a stepping stone towards building an autonomous di-
alogue agent that can continuously improve itself through
interaction with users. The experimental results demon-
strate the effectiveness of our latent intention model which
achieves state-of-the-art performance on both automatic
corpus-based evaluation and human evaluation.

2. Latent Intention Dialogue Model for

Goal-oriented Dialogue

Goal-oriented dialogue1 (Young et al., 2013) aims at build-
ing models that can help users to complete certain tasks via
natural language interaction. Given a user input utterance
ut at turn t and a knowledge base (KB), the model needs to

1Like most of the goal-oriented dialogue research, we focus

on information seek type dialogues.

parse the input into actionable commands Q and access the
KB to search for useful information in order to answer the
query. Based on the search result, the model needs to sum-
marise its ﬁndings and reply with an appropriate response
mt in natural language.

2.1. Model

The LIDM is based on the end-to-end system architecture
described in (Wen et al., 2017). It comprises three com-
ponents: (1) Representation Construction; (2) Policy Net-
work; and (3) Generator, as shown in Figure 1. To capture
the user’s intent and match it against the system’s knowl-
edge, a dialogue state vector st = ut ⊕ bt ⊕ xt is derived
from the user input ut and the knowledge base KB: ut is
the distributed utterance representation, which is formed
by encoding the user utterance2 ut with a bidirectional
LSTM (Hochreiter & Schmidhuber, 1997) and concatenat-
ing the ﬁnal stage hidden states together,

ut = biLSTMΘ(ut).

(1)

The belief vector bt, which is a concatenation of a set
of probability distributions over domain speciﬁc slot-value
pairs, is extracted by a set of pre-trained RNN-CNN belief
trackers (Wen et al., 2017; Mrkˇsi´c et al., 2017), in which ut
and mt−1 are processed by two different CNNs as shown
in Figure 1,

bt = RNN-CNN(ut, mt−1, bt−1)

(2)

where mt−1 is the preceding machine response and bt−1
is the preceding belief vector. They are included to model
the current turn of the discourse and the long-term dialogue
context, respectively. Based on the belief vector, a query Q
is formed by taking the union of the maximum values of
each slot. Q is then used to search the internal KB and re-
turn a vector xt representing the degree of matching in the
KB. This is produced by counting all the matching venues
and re-structuring it into a six-bin one-hot vector. Among
the three vectors that comprise the dialogue state st, ut is
completely trainable from data, bt is pre-trained using a
separate objective function, and xt is produced by a dis-
crete database accessing operation. For more details about
the belief trackers and database operation refer to Wen et
al (2016; 2017).

Conditioning on the state st, the policy network parame-
terises the latent intention zt by a single layer MLP,
(cid:124)
2 · tanh(W

(cid:124)
1 st + b1) + b2) (3)

πΘ(zt|st) = softmax(W

where W1, b1, W2, b2 are model parameters. Since
πΘ(zt|st) is a discrete conditional probability distribution

2All sentences are pre-processed by delexicalisation (Hender-
son et al., 2014) where slot-value speciﬁc words are replaced with
their corresponding generic tokens based on an ontology.

Latent Intention Dialogue Models

Figure 1. LIDM for Goal-oriented Dialogue Modeling

based on dialogue state, we can also interpret the policy
network here as a latent dialogue management component
in the traditional POMDP-based framework (Young et al.,
2013; Gaˇsi´c et al., 2013). A latent intention z(n)
(or an
action in the reinforcement learning literature) can then be
sampled from the conditional distribution,

t

z(n)
t ∼ πΘ(zt|st).

This sampled intention (or action) z(n)
and the state vector
st can then be combined into a control vector dt, which is
used to govern the generation of the system response based
on a conditional LSTM language model,

t

terised form with parameter set Θ,

pΘ(mt|st) =

pΘ(mt|zt, st)πΘ(zt|st).

(7)

(cid:88)

zt

2.2. Inference

To carry out inference for the LIDM, we introduce an in-
ference network qΦ(zt|st, mt) to approximate the posterior
distribution p(zt|st, mt) so that we can optimise the varia-
tional lower bound of the joint probability in a neural vari-
ational inference framework (Miao et al., 2016). We can
then derive the variational lower bound as,

L = EqΦ(zt)[log pΘ(mt|zt, st)] − λDKL(qΦ(zt)||πΘ(zt|st))

dt = W

(cid:124)
4 zt ⊕ [sigmoid(W

(cid:124)
3 zt + b3) · W

(cid:124)
5 st]

(cid:88)

≤ log

pΘ(mt|zt, st)πΘ(zt|st)

pΘ(mt|st, zt) =

p(wt

j+1|wt

j, ht

j−1, dt)

(cid:89)

j

t

, wt

where b3 and W3∼5 are parameters, zt is the 1-hot repre-
sentation of z(n)
j is the last output token (i.e. a word,
a delexicalised2 slot name or a delexicalised2 slot value),
and ht
j−1 is the decoder’s last hidden state. Note in Equa-
tion 5 the degree of information ﬂow from the state vector is
controlled by a sigmoid gate whose input signal is the sam-
pled intention z(n)
. This prevents the decoder from over-
ﬁtting to the deterministic state information and forces it
to take the sampled stochastic intention into account. The
LIDM can then be formally written down in its parame-

t

zt
= log pΘ(mt|st)

where qΦ(zt) is a shorthand for qΦ(zt|st, mt). Note that
we use a modiﬁed version of the lower bound here by in-
corporating a trade-off factor λ (Higgins et al., 2017). The
inference network qΦ(zt|st, mt) is then constructed by

qΦ(zt|st, mt) = Multi(ot) = softmax(W6ot)

(9)

ot = MLPΦ(bt, xt, ut, mt)

ut = biLSTMΦ(ut), mt = biLSTMΦ(mt)

where ot is the joint representation, and both ut and mt are
modeled by a bidirectional LSTM network. Although both

(8)

(10)

(11)

(4)

(5)

(6)

Latent Intention Dialogue Models

qΦ(zt|st, mt) and πΘ(zt|st) are modelled as parameterised
multinomial distributions, the approximation qΦ(zt|st, mt)
only functions during inference by producing samples to
compute the stochastic gradients, while πΘ(zt|st) is the
generative distribution that generates the required samples
for composing the machine response.

Based on the samples z(n)
t ∼ qΦ(zt|st, mt), we use dif-
ferent strategies to alternately optimise the parameters Θ
and Φ against the variational lower bound (Equation 8). To
do this, we further divide Θ into two sets Θ = {Θ1, Θ2}.
Parameters Θ1 on the decoder side are directly updated by
back-propagating the gradients,

∂L
∂Θ1

= EqΦ(zt|st,mt)[

∂ log pΘ1(mt|zt, st)
∂Θ1
∂ log pΘ1(mt|z(n)

, st)

t

]

≈

1
N

(cid:88)

n

∂Θ1

.

(12)

Parameters Θ2 in the generative network, however, are up-
dated by minimising the KL divergence,

∂L
∂Θ2

= −

∂λDKL(qΦ(zt|st, mt)||πΘ2 (zt|st))
∂Θ2

= −λ

qΦ(zt|st, mt)

(cid:88)

zt

∂ log πΘ2(zt|st)
∂Θ2

(13)

where the entropy derivative ∂H[qΦ(zt|st, mt)]/∂Θ2 = 0
and therefore can be ignored. Finally, for the parameters
Φ in the inference network, we ﬁrstly deﬁne the learning
signal r(mt, z(n)

, st),

t

r(mt,z(n)

, st) = log pΘ1(mt|z(n)

t

, st)−

t
λ(log qΦ(z(n)

t

|st, mt) − log πΘ2(z(n)

t

|st)).

(14)

Then the parameters Φ are updated by,

∂L
∂Φ

= EqΦ(zt|st,mt)[r(mt, zt, st)

≈

1
N

(cid:88)

n

r(mt, z(n)

t

, st)

∂ log qΦ(zt|st, mt)
∂Φ
|st, mt)

]

∂ log qΦ(z(n)
t
∂Φ

. (15)

t

However, this gradient estimator has a large variance be-
cause the learning signal r(mt, z(n)
, st) relies on samples
from the proposal distribution qΦ(zt|st, mt). To reduce the
variance during inference, we follow the REINFORCE al-
gorithm (Mnih et al., 2014; Mnih & Gregor, 2014) and
introduce two baselines b and b(st), the centered learn-
ing signal and input dependent baseline respectively to
help reduce the variance. b is a learnable constant and
b(st) = MLP(st). During training, the two baselines are
updated by minimising the distance,

(cid:104)

Lb =

r(mt, z(n)

t

, st) − b − b(st)

(cid:105)2

(16)

and the gradient w.r.t. Φ can be rewritten as

∂L
∂Φ

≈

1
N

(cid:88)

n

[r(mt, z(n)

t

, st)−b−b(st)]

∂ log qΦ(z(n)
t
∂Φ

|st, mt)

.

(17)

2.3. Semi-Supervision

Despite the steps described above for reducing the variance,
there remain two major difﬁculties in learning latent inten-
tions in a completely unsupervised manner: (1) the high
variance of the inference network prevents it from generat-
ing sensible intention samples in the early stages of train-
ing, and (2) the overly strong discriminative power of the
LSTM language model is prone to the disconnection phe-
nomenon between the LSTM decoder and the rest of the
components whereby the decoder learns to ignore the sam-
ples and focuses solely on optimising the language model.
To ensure more stable training and prevent disconnection,
a semi-supervised learning technique is introduced.

Inferring the latent intentions underlying utterances is sim-
ilar to an unsupervised clustering task. Standard clustering
algorithms can therefore be used to pre-process the corpus
and generate automatic labels ˆzt for part of the training ex-
amples (mt, st, ˆzt) ∈ L. Then when the model is trained
on the unlabeled examples (mt, st) ∈ U, we optimise it
against the modiﬁed variational lower bound given in Equa-
tion 8

L1 =

(cid:88)

(mt,st)∈U

Eqφ(zt|st,mt) [log pθ(mt|zt, st)]

− λDKL(qφ(zt|st, mt)||πθ(zt|st)) (18)

However, when the model is updated based on examples
from the labeled set (mt, st, ˆzt) ∈ L, we treat the labeled
intention ˆzt as an observed variable and train the model by
maximising the joint log-likelihood,

L2 =

(cid:88)

(mt, ˆzt,st)∈L

log [pΘ(mt| ˆzt, st)πΘ( ˆzt|st)qΦ( ˆzt|st, mt)]

(19)
The ﬁnal joint objective function can then be written as
L(cid:48) = αL1 + L2, where α controls the trade-off between
the supervised and unsupervised examples.

2.4. Reinforcement Learning

One of the main purposes of learning interpretable, discrete
latent intention inside a dialogue system is to be able to
control and reﬁne the model’s behaviour with operational
experience. The learnt generative network πΘ(zt|st) en-
codes the policy discovered from the underlying data dis-
tribution but this is not necessarily optimal for any speciﬁc
task. Since πΘ(zt|st) is a parameterised policy network
itself, any policy gradient-based reinforcement learning al-
gorithm (Williams, 1992; Konda & Tsitsiklis, 2003) can be

Latent Intention Dialogue Models

used to ﬁne-tune the initial policy against other objective
functions that we are more interested in.

Based on the initial policy πΘ(zt|st), we revisit the train-
ing dialogues and update parameters based on the follow-
ing strategy: when encountering unlabeled examples U at
turn t the system samples an action from the learnt policy
z(n)
t ∼ πΘ(zt|st) and receives a reward r(n)
. Conditioning
on these, we can directly ﬁne-tune a subset of the model
parameters Θ(cid:48) by the policy gradient method,

t

ID #

content words

0
1
3
14
31
34
46
85

138
91
42
17
9
9
7
4

thank, goodbye
welcome, goodbye
phone, address, [v.phone],[v.address]
address, [v.address]
located, area, [v.area]
area, would, like
food, serving, restaurant, [v.food]
help, anything, else

∂J
∂Θ(cid:48) ≈

1
N

(cid:88)

r(n)
t

n

∂ log πΘ(z(n)

t

|st)

∂Θ(cid:48)

(20)

Table 1. An example of the automatically labeled response seed
set for semi-supervised learning during variational inference.

where Θ(cid:48) = {W1, b1, W2, b2} is the MLP that parame-
terises the policy network (Equation 3). However, when a
labeled example ∈ L is encountered we force the model to
take the labeled action z(n)
t = ˆzt and update the parameters
by Equation 20 as well. Unlike Li et al (2016c) where the
whole model is reﬁned end-to-end using RL, updating only
Θ(cid:48) effectively allows us to reﬁne only the decision-making
of the system and avoid the problem of over-ﬁtting.

3. Experiments

3.1. Dataset & Setup for Goal-oriented Dialogue

We explored the properties of the LIDM model3 using the
CamRest676 corpus4 collected by Wen et al (2017), in
which the task of the system is to assist users to ﬁnd a
restaurant in the Cambridge, UK area. The corpus was col-
lected based on a modiﬁed Wizard of Oz (Kelley, 1984)
online data collection. Workers were recruited on Amazon
Mechanical Turk and asked to complete a task by carrying
out a conversation, alternating roles between a user and a
wizard. There are three informable slots (food, pricerange,
area) that users can use to constrain the search and six re-
questable slots (address, phone, postcode plus the three
informable slots) that the user can ask a value for once a
restaurant has been offered. There are 676 dialogues in the
dataset (including both ﬁnished and unﬁnished dialogues)
and approximately 2750 conversational turns in total. The
database contains 99 unique restaurants.

To make a direct comparison with prior work we follow
the same experimental setup as in Wen et al (2016; 2017).
The corpus was partitioned into training, validation, and
test sets in the ratio 3:1:1. The LSTM hidden layer sizes
were set to 50, and the vocabulary size is around 500 after
pre-processing, to remove rare words and words that can
be delexicalised2. All the system components were trained
jointly by ﬁxing the pre-trained belief trackers and the dis-
crete database operator with the model’s latent intention

3Will be available at https://github.com/shawnwun/NNDIAL
4https://www.repository.cam.ac.uk/handle/1810/260970

size I set to 50, 70, and 100, respectively. The trade-off
constants λ and α were both set to 0.1. To produce self-
labeled response clusters for semi-supervised learning of
the intentions, we ﬁrstly removed function words from all
the responses and clustered them according to their content
words. We then assigned the responses in the i-th frequent
cluster to the i-th latent dimension as its supervised set.
This results in about 35% (I = 50) to 43% (I = 100)
labeled responses across the whole dataset. An example
of the resulting seed set is shown in Table 1. During in-
ference we carried out stochastic estimation by taking one
sample for estimating the stochastic gradients. The model
is trained by Adam (Kingma & Ba, 2014) and tuned (early
stopping, hyper-parameters) on the held-out validation set.
We alternately optimised the generative model and the in-
ference network by ﬁxing the parameters of one while up-
dating the parameters of the other.

During reinforcement ﬁne-tuning, we generated a sentence
mt from the model to replace the ground truth ˆmt at each
turn and deﬁne an immediate reward as whether mt can
improve the dialogue success (Su et al., 2015) relative to
ˆmt, plus the sentence BLEU score (Auli & Gao, 2014),

rt = η · sBLEU(mt, ˆmt) +

(21)






1
mt improves
−1 mt degrades
0

otherwise

where the constant η was set to 0.5. We ﬁne-tuned the
model parameters using RL for only 3 epochs. During test-
ing, we greedily selected the most probable intention and
applied beam search with the beamwidth set to 10 when de-
coding the response. The decoding criterion was the aver-
age log-probability of tokens in the response. We then eval-
uated our model on task success rate (Su et al., 2015) and
BLEU score (Papineni et al., 2002) as in Wen et al (2016;
2017) in which the model is used to predict each system
response in the held-out test set.

Model

Success (%) BLEU

Metrics

NDM LIDM LIDM+RL

Latent Intention Dialogue Models

Published Models (Wen et al., 2016)

91.6

1.000

Ground Truth

Ground Truth

NDM
NDM+Att
NDM+Att+SS

LIDM Models

LIDM, I = 50
LIDM, I = 70
LIDM, I = 100

LIDM Models + RL

LIDM, I = 50, +RL
LIDM, I = 70, +RL
LIDM, I = 100, +RL

76.1
79.0
81.8

66.9
61.0
63.2

82.4
81.6
84.6

0.212
0.224
0.240

0.238
0.246
0.242

0.231
0.230
0.240

Table 2. Corpus-based Evaluation.

3.2. Experiments on Goal-oriented Dialogue

Table 2 presents the results of the corpus-based evaluation.
The Ground Truth block shows the two metrics when we
compute them on the human-authored responses. This sets
a gold standard for the task. In the Published Models block,
the results for the three baseline models were borrowed
from Wen et al (2016), they are: (1) the vanilla neural di-
alogue model (NDM), (2) NDM plus an attention mech-
anism on the belief trackers, and (3) the attentive NDM
with self-supervised sub-task neurons. The results of the
LIDM model with and without RL ﬁne-tuning are shown
in the LIDM Models and the LIDM Models + RL blocks,
respectively. As can be seen, the initial policy learned by
ﬁtting the latent intention to the underlying data distribu-
tion yielded reasonably good results on BLEU but did not
perform well on task success when compared to their deter-
ministic counterparts (block 2 v.s. 3). This may be due to
the fact that the variational lower bound of the dataset was
optimised rather than task success during variational infer-
ence. However, once RL was applied to optimise the suc-
cess rate as part of the reward function (Equation 21) dur-
ing the ﬁne-tuning phase, the resulting LIDM+RL models
outperformed the three baselines in terms of task success
without signiﬁcantly sacriﬁcing BLEU (block 2 v.s. 4)5.

In order to assess the human perceived performance, we
evaluated the three models (1) NDM, (2) LIDM, and (3)
LIDM+RL by recruiting paid subjects on Amazon Me-
chanical Turk. Each judge was asked to follow a task and
carried out a conversation with the machine. At the end of
each conversation the judges were asked to rate and com-
pare the model’s performance. We assessed the subjective

5Note that both NDM+Att+SS and LIDM use self-supervised

information

Success
Comprehension
Naturalness
# of Turns
* p <0.05

91.5% 92.0%
4.40*
4.21
4.29*
4.08
4.54
4.45

93.0%
4.40
4.28*
4.29

Table 3. Human evaluation. The signiﬁcance test is based on a
two-tailed student-t test, between NDM and LIDMs.

success rate, the perceived comprehension ability and the
naturalness of responses on a scale of 1 to 5. For each
model, we collected 200 dialogues and averaged the scores.
During human evaluation, we sampled from the top-5 in-
tentions of the LIDM models and decoded a response based
on the sample. The result is shown in Table 3. One interest-
ing fact to note is that although the LIDM did not perform
well on the corpus-based task success metric, the human
judges rated its subjective success almost indistinguishably
from the others. This discrepancy between the two exper-
iments arises mainly from a ﬂaw in the corpus-based suc-
cess metric in that it favors greedy policies because the user
side behaviours are ﬁxed rather than interactional6. Despite
the fact that LIDMs are considered only marginally better
than NDM on subjective success, the LIDMs do outper-
form NDM on both comprehension and naturalness scores.
This is because the proposed LIDM models can better cap-
ture multiple modes in the communicative intention and
thereby respond more naturally by sampling from the la-
tent intention variable.

Three example conversations are shown between a human
judge and a machine, one from LIDM in Table 4 and two
from LIDM+RL in Table 5, respectively. The results are
displayed one exchange per block. Each induced latent in-
tention is shown by a tuple (index, probability) followed
by a decoded response, and the sample dialogues were pro-
duced by following the responses highlighted in bold. As
can be seen, the LIDM shown in Table 4 clearly has mul-
tiple modes in the distribution over the learned intention
latent variable, and what it represents can be easily inter-
preted by the response generated. However, some inten-
tions (such as intent 0) can result in very different responses
under different dialogue states even though they were su-
pervised by a small response set as shown in Table 1. This
is mainly because of the variance introduced during vari-
ational inference. Finally, when comparing Table 4 and
Table 5, we can observe the difference between the two di-
alogue strategies: the LIDM, by inferring its policy from
the supervised dataset, reﬂects the diverse set of modes in
the underlying distribution; whereas the LIDM+RL, which

6The system tries to provide as much information as possible
in the early turns, in case the ﬁxed user side behaviours a few
turns later do not ﬁt the scenario the system originally planned.

Human :
Machine:

Human :
Machine:

Human :
Machine:

Human :
Machine:

Human :
Machine:

Latent Intention Dialogue Models

i am sorry , there are no indonesian restaurants in the area . would you like something else ?
there are no restaurants serving indonesian kind of food .

Hi, I’m hungry for some Indonesian
( 0
(46
(34

0.71)
0.19)
0.07) what location would you like ?

Oh no. How about Indian?
( 0
(30
(34

0.59)
0.15)
0.10) what area would you like ?

there are 9 restaurants in the east side of town . would you like their address ?
curry prince serves indian cuisine .

East side please
0.62)
( 0
0.19)
(84
0.08)
(81

curry prince is a indian restaurant in the east side of town . would you like their telephone number ?
curry prince is an indian restaurant in the east of town and the number is 01223 566388 .
curry prince serves indian type of cuisine and is located in the east part of town .

yes , the address and phone number please
( 3
(11
( 0

0.46)
0.16)
0.15)

the address is 451 newmarket road fen ditton and the phone is 01223 566388 .
the address for curry prince is 451 newmarket road fen ditton and the phone number is 01223 566388 .
curry prince is located at 451 newmarket road fen ditton and their phone is 01223 566388 . is there
anything else i can help you with ?

Okay, thank you goodbye
( 0
( 2
( 1
( 6

0.57)
0.13)
0.11)
0.10)

thank you , goodbye .
goodbye .
you are welcome . goodbye .
thank you for using the cambridge restaurant system . goodbye .

Table 4. A sample dialogue from the LIDM, I=100 model, one exchange per block. Each latent intention is shown by a tuple (index,
probability), followed by a decoded response. The sample dialogue was produced by following the responses highlighted in bold.

reﬁned its strategy using RL, exhibits a much greedier be-
havior in achieving task success (e.g. in Table 5 in block
2 & 4 the LIDM+RL agent provides the address and phone
number even before the user asks). This is also supported
by the human evaluation in Table 3 where LIDM+RL has
much shorter dialogues on average compared to the other
two models.

4. Discussion

Learning an end-to-end dialogue system is appealing but
challenging because of the credit assignment problem. Dis-
crete latent variable dialogue models such as LIDM are at-
tractive because the latent variable can serve as an inter-
face for decomposing the learning of language and the in-
ternal dialogue decision-making. This decomposition can
effectively help us resolve the credit assignment problem
where different learning signals can be applied to differ-
ent sub-modules to update the parameters. In variational
inference for discrete latent variables, the latent distribu-
tion is basically updated by the reward from the variational
lower bound. While in reinforcement learning, the latent
distribution (i.e. policy network) is updated by the rewards
from dialogue success and sentence BLEU score. Hence,
the latent variable bridges the different learning paradigms
such as Bayesian learning and reinforcement learning and
brings them together under the same framework. This
framework provides a more robust neural network-based
approach than previous approaches because it does not de-
pend solely on sequence-to-sequence learning but instead

explicitly models the hidden dialogue intentions underly-
ing the user’s utterances and allows the agent to directly
learn a dialogue policy through interaction.

5. Related work

Modeling chat-based dialogues (Serban et al., 2015; Shang
et al., 2015) as a sequence-to-sequence learning (Sutskever
et al., 2014) problem is a common theme in the deep learn-
ing community. Vinyals and Le (2015) has demonstrated a
seq2seq-based model trained on a huge amount of conver-
sation corpora which learns interesting replies conditioned
on different user queries. However, due to an inability
to model dialogue context, these models generally suffer
from the generic response problem (Li et al., 2016a; Ser-
ban et al., 2016). Several approaches have been proposed to
mitigate this issue, such as modeling the persona (Li et al.,
2016b), reinforcement learning (Li et al., 2016c), and intro-
ducing continuous latent variables (Serban et al., 2016; Cao
& Clark, 2017). While in our case, we not only make use
of the latent variable to inject stochasticity for generating
natural and diverse machine responses but also model the
hidden dialogue intentions explicitly. This combines the
merits of reinforcement learning and generative models.

At the other end of the spectrum, goal-oriented dialogue
systems typically adopt the POMDP framework (Young
et al., 2013) and break down the development of the di-
alogue systems into a pipeline of modules: natural lan-
guage understanding (Henderson, 2015), dialogue manage-

Human :
Machine:

Human :
Machine:

Human :
Machine:

Human :
Machine:

Human :
Machine:

Latent Intention Dialogue Models

Hi, I’m hungry for some Indonesian .
( 0
(46
(34

i am sorry , there are no indonesian restaurants in the area . would you like something else ?
0.61)
0.17)
no restaurants in the part of town .
0.14) what part of town would you like ?

Oh no. How about Indian?
(93
(72
(12

0.51)
0.21)
0.12)

Okay, thank you goodbye
( 6
( 1
( 85

0.28)
0.24)
0.19)

the gandhi is located at 72 regent street city centre and their telephone number is 01223 353942 .
the gandhi serves indian kind of food and is in the centre of town and is in the cheap price range .
the gandhi is a indian restaurant in the centre location and is in the cheap price range .

thank you for using the cambridge restaurant system . goodbye .
you are welcome . goodbye .
is there anything else i can help you with ?

hey can i have some chinese cruisine in the centre ? and a cheap one please
(15
( 5
(93

golden house is located at 12 lensﬁeld road city centre and their number is 01842 753771 .
golden house is located at 12 lensﬁeld road city centre and the number is 01842 753771 . is there ...
golden house is located at 12 lensﬁeld road city centre and their phone is 01842 753771 .

0.42)
0.38)
0.10)

that is all
( 6
( 1
(17

0.57)
0.20)
0.11)

thank you for using the cambridge restaurant system . goodbye .
you are welcome . goodbye .
have a nice day !

Table 5. Two sample dialogues from the LIDM+RL, I=100 model, one exchange per block. Comparing to Table 4, the RL agent
demonstrates a much greedier behavior toward task success. This can be seen in block 2 & block 4 in which the agent provides the
address and phone number even before the user asks.

ment (Gaˇsi´c et al., 2013), and natural language genera-
tion (Wen et al., 2015). These system modules commu-
nicate through a dialogue act formalism (Traum, 1999),
which in effect constitute a ﬁxed set of handcrafted inten-
tions. This limits the ability of such systems to scale to
more complex tasks. In contrast, the LIDM directly infers
all underlying dialogue intentions from data and can handle
intention distributions with long tails by measuring similar-
ities against the existing ones during variational inference.
Modeling of end-to-end goal-oriented dialogue systems has
also been studied recently (Wen et al., 2016; 2017; Bordes
& Weston, 2017), however, these models are typically de-
terministic and rely on decoder supervision signals to ﬁne-
tune a large set of model parameters.

Much research has focused on combining different learn-
ing paradigms and signals to bootstrap performance. For
example, semi-supervised learning (Kingma et al., 2014)
has been applied in the sample-based neural variational in-
ference framework as a way to reduce sample variance. In
practice, this relies on a discrete latent variable (Miao &
Blunsom, 2016; Koˇcisk´y et al., 2016) as the vehicle for the
supervision labels. As in reinforcement learning, which has
been a very common learning paradigm in dialogue sys-
tems (Gaˇsi´c et al., 2013; Su et al., 2016; Li et al., 2017),
the policy is also parameterised by a discrete set of actions.
As a consequence, the LIDM, which parameterises the in-
tention space via a discrete latent variable, can automati-
cally enjoy the beneﬁt of bootstrapping from signals com-
ing from different learning paradigms.
In addition, self-
supervised learning (Snow et al., 2004) (or distant, weak

supervision) as a simple way to generate automatic labels
by heuristics is popular in many NLP tasks and has been
applied to memory networks (Hill et al., 2016) and neural
dialogue systems (Wen et al., 2016) recently. Since there
is no additional effort required in labeling, it can also be
viewed as a method for bootstrapping.

6. Conclusion

In this paper, we have proposed a framework for learning
dialogue intentions via discrete latent variable models and
introduced the Latent Intention Dialogue Model (LIDM)
for goal-oriented dialogue modeling. We have shown that
the LIDM can discover an effective initial policy from the
underlying data distribution and is capable of revising its
strategy based on an external reward using reinforcement
learning. We believe this is a promising step forward for
building autonomous dialogue agents since the learnt dis-
crete latent variable interface enables the agent to perform
learning using several differing paradigms. The experi-
ments showed that the proposed LIDM is able to commu-
nicate with human subjects and outperforms previous pub-
lished results.

Acknowledgements

Tsung-Hsien Wen is supported by Toshiba Research Eu-
rope Ltd, Cambridge Research Laboratory. The authors
would like to thank the members of the Cambridge Dia-
logue Systems Group for their valuable comments.

Latent Intention Dialogue Models

References

Auli, Michael and Gao, Jianfeng. Decoder integration and
expected bleu training for recurrent neural network lan-
guage models. In ACL. Association for Computational
Linguistics, 2014.

Bahdanau, Dzmitry, Cho, Kyunghyun, and Bengio,
Yoshua. Neural machine translation by jointly learning
to align and translate. ICLR, 2015.

Bordes, Antoine and Weston, Jason. Learning end-to-end

goal-oriented dialog. In ICLR, 2017.

Bowman, Samuel R., Vilnis, Luke, Vinyals, Oriol, Dai, An-
drew M., J´ozefowicz, Rafal, and Bengio, Samy. Generat-
ing sentences from a continuous space. arXiv preprint:,
2015.

Cao, Kris and Clark, Stephen. Latent variable dialogue

models and their diversity. In EACL, 2017.

Faruqui, Manaal, Dodge, Jesse, Jauhar, Sujay Kumar,
Dyer, Chris, Hovy, Eduard, and Smith, Noah A.
Retroﬁtting word vectors to semantic lexicons.
In
NAACL-HLT, pp. 1606–1615, Denver, Colorado, May–
June 2015. Association for Computational Linguistics.

Gaˇsi´c, Milica, Breslin, Catherine, Henderson, Matthew,
Kim, Dongho, Szummer, Martin, Thomson, Blaise, Tsi-
akoulis, Pirros, and Young, Steve. On-line policy opti-
misation of bayesian spoken dialogue systems via human
interaction. In ICASSP, 2013.

Henderson, Matthew. Machine learning for dialog state
tracking: A review. In Machine Learning in Spoken Lan-
guage Processing Workshop, 2015.

Henderson, Matthew, Thomson, Blaise, and Young, Steve.
Word-based dialog state tracking with recurrent neural
In SigDial, pp. 292–299, Philadelphia, PA,
networks.
U.S.A., June 2014. Association for Computational Lin-
guistics.

Higgins, Irina, Matthey, Loic, Pal, Arka, Burgess, Christo-
pher, Glorot, Xavier, Botvinick, Matthew, Mohamed,
Shakir, and Lerchner, Alexander. beta-vae: Learning ba-
sic visual concepts with a constrained variational frame-
work. In ICLR, 2017.

Hill, Felix, Bordes, Antoine, Chopra, Sumit, and Weston,
Jason. The goldilocks principle: Reading children’s
In ICLR,
books with explicit memory representations.
2016.

Hochreiter, Sepp and Schmidhuber, J¨urgen. Long short-

term memory. Neural Computation, 1997.

Karpathy, Andrej and Fei-Fei, Li. Deep visual-semantic
alignments for generating image descriptions. In CVPR,
2015.

Kelley, John F. An iterative design methodology for user-
friendly natural language ofﬁce information applica-
tions. ACM Transaction on Information Systems, 1984.

Kiddon, Chlo´e, Zettlemoyer, Luke, and Choi, Yejin. Glob-
ally coherent text generation with neural checklist mod-
els. In EMNLP, pp. 329–339, Austin, Texas, November
2016. Association for Computational Linguistics.

Kingma, Diederik P. and Ba, Jimmy. Adam: A method
for stochastic optimization. arXiv preprint: 1412.6980,
abs/1412.6980, 2014.

Kingma, Diederik P. and Welling, Max. Stochastic back-
propagation and approximate inference in deep genera-
tive models. In ICML, 2014.

Kingma, Diederik P., Mohamed, Shakir, Rezende,
Danilo J., and Welling, Max. Semi-supervised learning
with deep generative models. In NIPS, pp. 3581–3589.
Curran Associates, Inc., 2014.

Konda, Vijay R. and Tsitsiklis, John N.

critic algorithms.
1143–1166, April 2003.
10.1137/S0363012901385691.

On actor-
SIAM J. Control Optim., 42(4):
doi:
ISSN 0363-0129.

Koˇcisk´y, Tom´aˇs, Melis, G´abor, Grefenstette, Edward,
Dyer, Chris, Ling, Wang, Blunsom, Phil, and Hermann,
Karl Moritz. Semantic parsing with semi-supervised
In EMNLP, pp. 1078–1087,
sequential autoencoders.
Austin, Texas, November 2016. Association for Com-
putational Linguistics.

Li, Jiwei, Galley, Michel, Brockett, Chris, Gao, Jianfeng,
and Dolan, Bill. A diversity-promoting objective func-
In NAACL-HLT,
tion for neural conversation models.
pp. 110–119, San Diego, California, June 2016a. Asso-
ciation for Computational Linguistics.

Li, Jiwei, Galley, Michel, Brockett, Chris, Spithourakis,
Georgios, Gao, Jianfeng, and Dolan, Bill. A persona-
based neural conversation model. In ACL, pp. 994–1003,
Berlin, Germany, August 2016b. Association for Com-
putational Linguistics.

Li, Jiwei, Monroe, Will, Ritter, Alan, Jurafsky, Dan, Gal-
ley, Michel, and Gao, Jianfeng. Deep reinforcement
learning for dialogue generation. In EMNLP, pp. 1192–
1202, Austin, Texas, November 2016c. Association for
Computational Linguistics.

Li, Jiwei, Miller, Alexander H., Chopra, Sumit, Ranzato,
Marc’Aurelio, and Weston, Jason. Dialogue learning
with human-in-the-loop. In ICLR, 2017.

Latent Intention Dialogue Models

Miao, Yishu and Blunsom, Phil. Language as a latent vari-
able: Discrete generative models for sentence compres-
sion. In EMNLP, pp. 319–328, Austin, Texas, November
2016. Association for Computational Linguistics.

Miao, Yishu, Yu, Lei, and Blunsom, Phil. Neural varia-
tional inference for text processing. In ICML, 2016.

Mnih, Andriy and Gregor, Karol. Neural variational infer-
ence and learning in belief networks. In ICML, 2014.

Mnih, Volodymyr, Heess, Nicolas, Graves, Alex, and
kavukcuoglu, koray. Recurrent models of visual atten-
tion. In NIPS, 2014.

Mrkˇsi´c, Nikola,

´O S´eaghdha, Diarmuid, Wen, Tsung-
Hsien, Thomson, Blaise, and Young, Steve. Neural be-
lief tracker: Data-driven dialogue state tracking. In ACL,
Vancouver, Canada, August 2017. Association for Com-
putational Linguistics.

Papineni, Kishore, Roukos, Salim, Ward, Todd, and Zhu,
Wei-Jing. Bleu: a method for automatic evaluation of
machine translation. In ACL, pp. 311–318, Philadelphia,
Pennsylvania, USA, July 2002. Association for Compu-
tational Linguistics.

Serban, Iulian V., Sordoni, Alessandro, Lowe, Ryan, Char-
lin, Laurent, Pineau, Joelle, Courville, Aaron, and Ben-
gio, Yoshua. A hierarchical latent variable encoder-
decoder model for generating dialogues. arXiv preprint:
1605.06069, 2016.

Serban, Iulian Vlad, Sordoni, Alessandro, Bengio, Yoshua,
Courville, Aaron C., and Pineau, Joelle. Hierarchical
neural network generative models for movie dialogues.
In AAAI, 2015.

Shang, Lifeng, Lu, Zhengdong, and Li, Hang. Neural re-
sponding machine for short-text conversation. In ACL,
2015.

Silver, David, Huang, Aja, Maddison, Chris J, Guez,
Arthur, Sifre, Laurent, Van Den Driessche, George,
Schrittwieser, Julian, Antonoglou, Ioannis, Panneershel-
vam, Veda, Lanctot, Marc, et al. Mastering the game of
go with deep neural networks and tree search. Nature,
529(7587):484–489, 2016.

Snow, Rion, Jurafsky, Daniel, and Ng, Andrew Y. Learning
syntactic patterns for automatic hypernym discovery. In
NIPS, 2004.

Su, Pei-Hao, Vandyke, David, Gasic, Milica, Kim,
Dongho, Mrksic, Nikola, Wen, Tsung-Hsien, and
Young, Steve. Learning from real users: Rating dialogue
success with neural networks for reinforcement learning
in spoken dialogue systems. In Interspeech, 2015.

Su, Pei-Hao, Gasic, Milica, Mrkˇsi´c, Nikola, Rojas Bara-
hona, Lina M., Ultes, Stefan, Vandyke, David, Wen,
Tsung-Hsien, and Young, Steve. On-line active reward
learning for policy optimisation in spoken dialogue sys-
tems. In ACL, pp. 2431–2441, Berlin, Germany, August
2016. Association for Computational Linguistics.

Sutskever, Ilya, Vinyals, Oriol, and Le, Quoc V. Sequence
In NIPS,

to sequence learning with neural networks.
2014.

Traum, David R. Foundations of Rational Agency, chapter

Speech Acts for Dialogue Agents. Springer, 1999.

Vinyals, Oriol and Le, Quoc V. A neural conversational

model. In ICML Deep Learning Workshop, 2015.

Wen, Tsung-Hsien, Gasic, Milica, Mrkˇsi´c, Nikola, Su,
Pei-Hao, Vandyke, David, and Young, Steve. Seman-
tically conditioned lstm-based natural language genera-
tion for spoken dialogue systems. In EMNLP, pp. 1711–
1721, Lisbon, Portugal, September 2015. Association
for Computational Linguistics.

Wen, Tsung-Hsien, Gasic, Milica, Mrkˇsi´c, Nikola, Ro-
jas Barahona, Lina M., Su, Pei-Hao, Ultes, Stefan,
Vandyke, David, and Young, Steve. Conditional gener-
ation and snapshot learning in neural dialogue systems.
In EMNLP, pp. 2153–2162, Austin, Texas, November
2016. Association for Computational Linguistics.

Wen, Tsung-Hsien, Vandyke, David, Mrkˇsi´c, Nikola,
Gaˇsi´c, Milica, M. Rojas-Barahona, Lina, Su, Pei-Hao,
Ultes, Stefan, and Young, Steve. A network-based end-
to-end trainable task-oriented dialogue system. In EACL,
2017.

Weston, Jason E. Dialog-based language learning. In NIPS,

pp. 829–837. Curran Associates, Inc., 2016.

Williams, Ronald J. Simple statistical gradient-following
learning.
ISSN

algorithms for connectionist reinforcement
Machine Learning, 8(3-4):229–256, May 1992.
0885-6125. doi: 10.1007/BF00992696.

Xu, Kelvin, Ba, Jimmy, Kiros, Ryan, Cho, Kyunghyun,
Courville, Aaron, Salakhutdinov, Ruslan, Zemel,
Richard, and Bengio, Yoshua. Show, attend and tell:
Neural image caption generation with visual attention.
In ICML, 2015.

Young, Steve, Gaˇsi´c, Milica, Thomson, Blaise, and
Williams, Jason D. Pomdp-based statistical spoken di-
alog systems: A review. Proceedings of the IEEE, 2013.

