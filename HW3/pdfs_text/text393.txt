Stochastic Gradient MCMC Methods for Hidden Markov Models

Yi-An Ma 1 Nicholas J. Foti 1 Emily B. Fox 1

Abstract

Stochastic gradient MCMC (SG-MCMC) algo-
rithms have proven useful in scaling Bayesian
inference to large datasets under an assump-
tion of i.i.d data. We instead develop an SG-
MCMC algorithm to learn the parameters of hid-
den Markov models (HMMs) for time-dependent
data. There are two challenges to applying SG-
MCMC in this setting: The latent discrete states,
and needing to break dependencies when consid-
ering minibatches. We consider a marginal likeli-
hood representation of the HMM and propose an
algorithm that harnesses the inherent memory de-
cay of the process. We demonstrate the effective-
ness of our algorithm on synthetic experiments
and an ion channel recording data, with runtimes
signiï¬cantly outperforming batch MCMC.

1. Introduction

Stochastic gradient based algorithms have proven crucial
in numerous areas for scaling inference algorithms to large
datasets. The key idea is to employ noisy estimates of the
gradient based on minibatches of data, avoiding a costly
gradient computation using the full dataset (Robbins &
Monro, 1951). Assuming the data are i.i.d. and the mini-
batches are properly scaled, the stochastic gradient is an
unbiased estimate of the true gradient.
In the context of
Bayesian inference, such approaches have proven useful in
scaling variational inference (Hoffman et al., 2013; Bryant
& Sudderth, 2012; Broderick et al., 2013; Foti et al., 2014)
and Markov chain Monte Carlo (MCMC) (Welling & Teh,
2011; Patterson & Teh, 2013; Chen et al., 2014; Ding et al.,
2014; Shang et al., 2015). For the latter, a primary focus
has been on the inï¬‚uence of the stochastic gradient noise
on the MCMC iterates; in contrast to many optimization-
based procedures, it is non-trivial to show that the under-
lying (stochastic) dynamics maintain the correct stationary

1University of Washington, Seattle, WA, USA. Correspon-

dence to: Yi-An Ma <yianma@uw.edu>.

Proceedings of the 34 th International Conference on Machine
Learning, Sydney, Australia, PMLR 70, 2017. Copyright 2017
by the author(s).

distribution in the presence of such noise. Signiï¬cant head-
way has been made in developing such correct SG-MCMC
procedures. These algorithms have shown great practical
beneï¬ts and have gained signiï¬cant traction.

A separate challenge, however, is the important and often
overlooked question of whether such stochastic gradient
techniques can be applied to massive amounts of sequential
or otherwise non-i.i.d. data. In such cases, crucial depen-
dencies must be broken to form the necessary minibatches.
This question received some attention in the stochastic vari-
ational inference (SVI) algorithm of Foti et al. (2014) for
hidden Markov models (HMMs). In this work, we also fo-
cus in on HMMs as a simple example of a sequential data
model, but turn our attention to SG-MCMC algorithms.

for

are many existing algorithms

There
inferring
the model parameters of an HMM including Monte
Carlo methods (Scott, 2002), expectation-maximization
(EM) (Bishop, 2006), and variational algorithms (Beale,
2003). All of these ideas operate by iterating between a
local update for the latent states, followed by a global
update of the model parameters. The local update is
usually performed using the forward-backward algorithm
that allows computation of any marginal, or pair-wise
marginal, in time linear in the length of the sequence.

In the variational context, recent work has focused on scal-
ing these local-global inference schemes to settings with
a large number of replicates of short sequences (Johnson
& Willsky, 2014; Hughes et al., 2015). These methods
utilize the fact that independent replicates of the obser-
vation sequence can be used to compute unbiased gradi-
ent estimates (Johnson & Willsky, 2014), and can be used
to incrementally update sufï¬cient statistics (Hughes et al.,
2015). In contrast, the SVI-HMM algorithm of Foti et al.
(2014) examines how to deal with extremely long obser-
vation sequences. The algorithm heuristically breaks the
dependence between observations and performs local up-
dates on short subsequences of observations using a lim-
ited forward-backward algorithm. These existing methods
suffer from a number of drawbacks. The variational ap-
proaches must use an approximate posterior distribution
for both the state- and model-parameters, which may not
be representative of the true distributions. The methods are
also limited to conjugate prior distributions over the param-
eters, which can severely limit the expressiveness of the

Stochastic Gradient MCMC Methods for Hidden Markov Models

model. Finally, all of the methods discussed thus far are
susceptible to the widely known problem of underestimat-
ing posterior correlations biasing fully Bayesian analyses.

2. Background

2.1. Hidden Markov Models

Unfortunately, attempting to naively use subchains as in
Foti et al. (2014) within SG-MCMC approaches is fraught
with difï¬culty: The local-global structure of SVI-HMM
does not lend itself to deriving provably correct SG-MCMC
algorithms, stemming from two main challenges.

The ï¬rst challenge is that SG-MCMC methods sample
continuous-valued parameter representations, whereas the
HMM learning objective is typically speciï¬ed in terms of
the discrete-valued state sequence (local variables). To ad-
dress this challenge, we consider an alternative approach to
performing parameter inference for HMMs: We work di-
rectly with the marginal likelihood of the observation. We
form stochastic gradients by only evaluating terms of the
full gradient that depend on a small subsequence.

The second challenge is handling the temporal dependen-
cies, speciï¬cally:
i) each subsequence-speciï¬c term in
the stochastic gradient still requires a forward-backward
pass on the rest of the sequence, and ii) proximal sub-
sequences are mutually correlated. We address both of
these issues by capitalizing on the well-known memory de-
cay of the Markovian structure underlying the data gen-
Speciï¬cally, we approximate the full
erating process.
forward-backward passes with message passing only on
short buffers around the considered subsequences of obser-
vations. We further restrict subsequences to be sufï¬ciently
far from one another to ensure that computations with
them are uncorrelated. We provide a theoretically justi-
ï¬ed approach to estimating this buffer length and between-
subsequence gap, allowing us to prove the validity of the
resulting SG-MCMC algorithm.
In particular, the same
theoretical guarantees are provided as in the i.i.d. setting.

Buffering to perform limited message passing in HMMs
was also applied in SVI-HMM Foti et al. (2014); however,
the buffering there was part of a latent state update. In par-
ticular, SVI-HMM iterates between buffered message pass-
ing for local updates and stochastic gradients for global up-
dates. We, in contrast, consider stochastic gradients of a
marginal likelihood representation and utilize buffering di-
rectly within this stochastic gradient calculation.

We evaluate the efï¬cacy of our buffered SG-MCMC
method for HMMs on two synthetic examples with very
different dynamics. We compare against an unbuffered SG-
MCMC approach as well as against treating the data as
i.i.d. Finally, we show the computational gains of our SG-
MCMC algorithm over batch MCMC by segmenting an
ion channel dataset where a 1,000X speedup was observed.
Collectively, our contributions make a sizable step towards
general purpose SG-MCMC algorithms for sequential data.

Hidden Markov models (HMMs) are a class of discrete-
time doubly stochastic processes consisting of a i) latent
discrete-valued state sequence xt âˆˆ {1, . . . , K} generated
by a Markov chain and (ii) corresponding observations yt
generated from distributions determined by the latent states
xt. Speciï¬cally, the joint distribution of y = (y1, Â· Â· Â· , yT )
and x = (x0, Â· Â· Â· , xT ), factorizes as

p(x, y) = Ï€0(x0)

p(xt|xtâˆ’1, A) Â· p(yt|xt, Ï†),

(1)

T
(cid:89)

t=1

where A is the Markov transition matrix such that Ai,j =
Pr(xt = i|xtâˆ’1 = j), {Ï†k}K
k=1 are the emission param-
eters, and Ï€0 = p(x0) is the initial state distribution. We
denote the parameters of interest as Î¸ = {A, Ï†} and do not
focus on performing inference on Ï€0.

Traditionally, EM, variational inference, or MCMC are
used to perform inference over Î¸ (Scott, 2002; Beale,
2003). These algorithms rely on the well-known forward-
backward algorithm to compute the marginal, p(xt|y1:T ),
and pairwise-marginal, p(xt, xt+1|y1:T ), distributions. The
algorithm works by recursively computing a sequence of
forward messages Î±t(xt) = p(xt|y1:t) and backwards
messages Î²t(xt) = p(yt+1:T |xt) which can then be used
to compute the necessary marginals (Beale, 2003). These
marginals are then used to update or sample from the dis-
tribution of the model parameters.

These past algorithms have found widespread use in statis-
tics and machine learning. However, as discussed in Sec. 1,
an alternative formulation of the HMM can provide greater
utility in developing an SG-MCMC approach. Marginaliz-
ing over x, we obtain the marginal likelihood:

p(y|Î¸) = 1T P (yT )A Â· Â· Â· P (y1)A Ï€0,

(2)

where P (yt) is a diagonal matrix with Pi,i(yt) =
p(yt|xt = i, Ï†i); 1T is a row vector of K ones; and
(Ï€0)i = Ï€0(x0 = i). The resulting posterior distribution
of Î¸ given y = y1:T is then:

p(Î¸|y) âˆ 1T P (yT )A Â· Â· Â· P (y1)A Ï€0 Â· p(Î¸).

(3)

Working with the marginal likelihood and posterior alle-
viates the need to compute the marginals and pairwise
marginals of xt. As such, only the forward pass of the
forward-backward algorithm is performed.
Indeed, per-
forming the matrix multiplications in Eq. (2) from right to
left corresponds to computing the normalizing constants of
the forward messages. Performing the matrix multiplies
from left to right corresponds to unnormalized messages in
belief propagation, (cf. Fox, 2009). Perhaps most impor-
tantly for the development of our SG-MCMC algorithm,

Stochastic Gradient MCMC Methods for Hidden Markov Models

the marginal likelihood does not involve alternately updat-
ing the local state variables, xt, and the global model pa-
rameters Î¸.
Instead, we need only explore a continuous
space which will allow us to leverage gradient information
to develop a computationally and statistically efï¬cient al-
gorithm. The major impediment to directly using Eq. (2)
for SG-MCMC is that it is unclear how to form a stochastic
gradient based on a subsequence to avoid the computational
burden of gradient computations in large T settings.

Algorithm 1 SG-MCMC

initialize Î¸0
for t = 0, 1, 2 Â· Â· Â· , Niter do

for i = 1 Â· Â· Â· n do
âˆ‚
Î“i(Î¸) = (cid:80)
âˆ‚Î¸j

j

(Dij(Î¸) + Qij(Î¸))

end for
sample Î·(t) âˆ¼ N (0, 2(cid:15)tD(Î¸(t)) âˆ’ (cid:15)2
Î¸(t+1) â† Î¸(t) + Î·(t)

t (cid:98)B(t))
(cid:104)(cid:0)D(Î¸(t)) + Q(Î¸(t))(cid:1)âˆ‡ (cid:101)U (Î¸(t)) + Î“(Î¸(t))

(cid:105)

âˆ’(cid:15)t

2.2. Stochastic Gradient MCMC for i.i.d. Data

end for

One approach for devising MCMC algorithms is to uti-
lize continuous dynamics to explore a potential function
U (Î¸) âˆ âˆ’ ln Ï€(Î¸) for target distribution Ï€(Î¸); for Bayesian
inference, we take U (Î¸) âˆ âˆ’ ln p(Î¸|y), i.e., the negative
log posterior. Then, samples of a continuous valued pa-
rameter, Î¸ âˆˆ Rd, can be drawn as (Ma et al., 2015; 2016)

Î¸(t+1) â†Î¸(t) âˆ’ (cid:15)t

(cid:105)
(cid:104)(cid:0)D(Î¸(t)) + Q(Î¸(t))(cid:1)âˆ‡U (Î¸(t)) + Î“(Î¸(t))

+ N (0, (cid:15)t(2D(Î¸(t)))),

(4)

âˆ‚
âˆ‚Î¸j

where Î“i(Î¸) = (cid:80)d

j=1

(Di,j(Î¸) + Qi,j(Î¸)), D(Î¸(t))

is a positive-deï¬nite matrix and Q(Î¸(t)) a skew-symmetric
matrix. Ma et al. (2015) proved that in the limit (cid:15)t â†’ 0
with ergodicity, the iterates Î¸(t) will be drawn from p(Î¸|y).
For i.i.d. data, U (Î¸) = âˆ’ (cid:80)
sâˆˆS ln p(ys|Î¸) âˆ’ log p(Î¸). For
independently sampled data subsets, (cid:101)S âŠ‚ S, a noisy unbi-
ased estimate of the potential function is given by:

(cid:101)U (Î¸) = âˆ’

log p(ys|Î¸) âˆ’ log p(Î¸);

(cid:101)S âŠ‚ S.

(5)

|S|
| (cid:101)S|

(cid:88)

sâˆˆ (cid:101)S

As such, a gradient computed based on (cid:101)U (Î¸)â€”called a
stochastic gradientâ€”is a noisy, but unbiased estimator of
the full-data gradient. The key question is whether the
noise injected by the stochastic gradient adversely affects
the stationary distribution of the modiï¬ed dynamics (using
âˆ‡ (cid:101)U (Î¸) in place of âˆ‡U (Î¸)). One way to analyze the impact
of the stochastic gradient is to make use of the central limit
theorem and assume

âˆ‡ (cid:101)U (Î¸) = âˆ‡U (Î¸) + N (0, V(Î¸)).

(6)

Simply using âˆ‡ (cid:101)U (Î¸) in place of âˆ‡U (Î¸) in Eq. (4) results
in an additional noise term (D(Î¸) + Q(Î¸)(cid:1) N (0, V(Î¸))T .
Assuming we have an estimate (cid:98)B of the variance of this
additional noise satisfying 2D(Î¸) âˆ’ (cid:15) (cid:98)B (cid:23) 0 (i.e., posi-
tive semideï¬nite), then we can attempt to account for the
stochastic gradient noise by simulating

This is the SG-MCMC algorithm for i.i.d. data proposed
by Ma et al. (2015; 2016). See Alg. 2.

For this SG-MCMC, there are sources of error introduced
via (i) discretizing the continuous stochastic dynamics and
(ii) estimation of the stochastic gradient noise covariance.
Although the algorithm is provably correct as (cid:15)t â†’ 0, in
practice one uses a small, ï¬nite stepsize for greater ef-
ï¬ciency.
In such cases, bias is introduced. This bias-
variance tradeoff was recently studied in (Vollmer et al.,
2016). Higher order numerical schemes (Chen et al., 2015;
Leimkuhler & Shang, 2016) and a moving window estima-
tion of (cid:98)B can further reduce this bias (Shang et al., 2015).

3. Stochastic Gradient MCMC for HMMs

In order to apply SG-MCMC methods to HMMs we must
be able to efï¬ciently estimate the gradient of the poten-
tial, U (Î¸) âˆ âˆ’ ln p(Î¸|y). The approach we take consists
of three steps (see Fig. 1). First, we marginalize out the
discrete state sequence and use the marginal likelihood of
the data. Next, we derive an expression for the gradient of
the marginal likelihood that factorizes over disjoint subse-
quences. Finally, we compute an unbiased noisy estimate
of the gradient by randomly sampling subsequences and
show that using this estimate results in an SG-MCMC algo-
rithm that admits the desired stationary distribution under
the same conditions as in the i.i.d. case (see Sec. 2.2).

One could have imagined an alternative approachâ€”as in
SVI-HMMâ€”of ï¬rst sampling subsequences; we could
then compute an approximation of the marginal likelihood
on this subsequence and treat its gradient as our stochastic
gradient. However, without the marginal likelihood infor-
mation in the ï¬rst place, it is not obvious how subsequences
correlate with each other and consequently how to control
the error resulting from subsampling.

3.1. Gradient of Marginal Likelihood Representation

Î¸(t+1) â†Î¸(t) âˆ’ (cid:15)t

(cid:105)
(cid:104)(cid:0)D(Î¸(t)) + Q(Î¸(t))(cid:1)âˆ‡ (cid:101)U (Î¸(t)) + Î“(Î¸(t))
(7)

+ N (0, (cid:15)t(2D(Î¸(t)) âˆ’ (cid:15)t (cid:98)B(t))).

that

Recall
the posterior under an HMM is given by
Eq. (3) and that the potential function U (Î¸) âˆ âˆ’ ln p(Î¸|y).
As will prove useful in our SG-MCMC algorithm, we

Stochastic Gradient MCMC Methods for Hidden Markov Models

rewrite the posterior in terms of a subsequence yÏ„,L =
(yÏ„ âˆ’L, . . . , yÏ„ , . . . , yÏ„ +L) with half-width L centered at
time Ï„ âˆˆ {L + 1, . . . , T âˆ’ L âˆ’ 1}. The overall subsequence
length is 2L + 1. Deï¬ning

in the minibatch. The Ï„ s are drawn randomly from {L +
1, . . . , T âˆ’Lâˆ’1}; details of the full sampling scheme for (cid:101)S
is provided in the Supplement. We then use the following
estimator of the full gradient:

P (yÏ„,L) = P (yÏ„ +L)A Â· Â· Â· P (yÏ„ âˆ’L)A,

(8)

(cid:103)âˆ‡U (Î¸)i =

(12)

we can rewrite Eq. (3) as

p(Î¸|y) âˆ qT

Ï„ +L+1P (yÏ„,L)Ï€Ï„ âˆ’Lâˆ’1 Â· p(Î¸).

(9)

Here, qÏ„ +L+1,i = p(yÏ„ +L+1:T |xÏ„ +L = i) is the likeli-
hood of the observations after yÏ„,L given the value of the
latent state at Ï„ , and Ï€Ï„ âˆ’Lâˆ’1,i = p(xÏ„ âˆ’L = i|y1:Ï„ âˆ’Lâˆ’1) is
the predictive distribution of the latent state at Ï„ given the
observations before yÏ„,L. Note, we do not actually need to
instantiate the latent state variables xÏ„ âˆ’L and xÏ„ +L+1 as
qÏ„ +L+1 and Ï€Ï„ âˆ’Lâˆ’1 can be computed (in theory) via the
forward-backward algorithm (Rabiner, 1989; Scott, 2002).

Let S = {yÏ„,L} be a set of non-overlapping subsequences
that cover y. The gradient of Eq. (9) can be written as

âˆ‡U (Î¸)i = âˆ’

(cid:88)

= âˆ’

yÏ„,LâˆˆS

âˆ‚ ln p(y|Î¸)
âˆ‚Î¸i

âˆ’

âˆ‚ ln p(Î¸)
âˆ‚Î¸i

qT

Ï„ +L+1

âˆ‚P (yÏ„,L)
âˆ‚Î¸i
qT
Ï„ +L+1P (yÏ„,L)Ï€Ï„ âˆ’Lâˆ’1

Ï€Ï„ âˆ’Lâˆ’1

(10)

âˆ’

âˆ‚ ln p(Î¸)
âˆ‚Î¸i

,

where the equality follows from the product rule (see the
Supplement for complete derivation).
Importantly, note
that the gradient involves a sum over terms corresponding
to all non-overlapping subsequences of length 2L + 1.

We could imagine using âˆ‡U (Î¸) from Eq. (10) in the update
rule of Eq. (4) to generate sample values of Î¸. However,
Eq. (10) is extremely computationally intensive for two rea-
sons. First, calculating qÏ„ +L+1 and Ï€Ï„ âˆ’Lâˆ’1 involves the
whole sequence of length T . Second, one must compute
qÏ„ +L+1, P (yÏ„,L), and Ï€Ï„ âˆ’Lâˆ’1 for each yÏ„,L âˆˆ S in the
sum; this involves T /L terms, thus requiring O(T 2) com-
putation time to compute the gradient.

3.2. Stochastic Gradient Calculation

In place of âˆ‡U (Î¸) in Eq. (10), we can deï¬ne a stochastic
gradient based on a single subsequence, (cid:103)âˆ‡U (Î¸):

(cid:103)âˆ‡U (Î¸)i = âˆ’

qT

Ï„ +L+1

âˆ‚P (yÏ„,L)
âˆ‚Î¸i
qT
Ï„ +L+1P (yÏ„,L)Ï€Ï„ âˆ’Lâˆ’1

Ï€Ï„ âˆ’Lâˆ’1

âˆ’

âˆ‚ ln p(Î¸)
âˆ‚Î¸i

.

(11)

To control the variance of this estimator, we sample a
collection of subsequencesâ€”referred to as a minibatchâ€”
(cid:101)S = {yÏ„,L} where | (cid:101)S| denotes the number of subchains

âˆ’

1
p( (cid:101)S)

(cid:88)

yÏ„,Lâˆˆ (cid:101)S

qT

Ï„ +L+1

âˆ‚P (yÏ„,L)
âˆ‚Î¸i
qT
Ï„ +L+1P (yÏ„,L)Ï€Ï„ âˆ’Lâˆ’1

Ï€Ï„ âˆ’Lâˆ’1

âˆ’

âˆ‚ ln p(Î¸)
âˆ‚Î¸i

.

If we sample ËœS from the set of all possible length-L
subsequences with probability p( (cid:101)S) = | (cid:101)S|LT âˆ’1, then
E
= âˆ‡U (Î¸) (Gopalan et al., 2012).

(cid:105)
(cid:103)âˆ‡U (Î¸)

(cid:104)

Unfortunately, even this stochastic estimate is prohibitively
expensive to compute since the q and Ï€ terms require
touching nearly all of the observations. We instead con-
sider approximating these quantities.

Approximating messages via buffering Inspired by
recent work on stochastic variational
inference for
HMMs (Foti et al., 2014), we introduce a buffer of length
B on either end of each subsequence (yLB, yÏ„,L, yRB)
where yLB = (yÏ„ âˆ’Lâˆ’B, . . . , yÏ„ âˆ’Lâˆ’1) and yRB =
(yÏ„ +L+1, . . . , yÏ„ +L+B). See Fig. 1. For an irreducible
and aperiodic Markov chain, a sufï¬ciently long buffer will
render the observations within yÏ„,L and those outside the
buffers approximately independent. This lets us approxi-
mate the boundary terms in Eq. (11) as

Ï€Ï„ âˆ’Lâˆ’1 â‰ˆ ËœÏ€Ï„ âˆ’Lâˆ’1 = P (yÏ„ âˆ’Lâˆ’1)A Â· Â· Â· P (yÏ„ âˆ’Lâˆ’B)A
(cid:125)

(cid:124)

Ï€0

Ï„ +L+1 â‰ˆ ËœqT
qT

Ï„ +L+1 = 1T P (yÏ„ +L+B)A Â· Â· Â· P (yÏ„ +L+1)
(cid:125)

(cid:124)

.

(13)
Notice that we plug in Ï€0 and 1T as the initial conditions
for the buffers in Eq. (13). Though this introduces errors
into the computations of P (yLB) and P (yRB), these errors
will be nearly forgotten for observations in the subchain of
interest yÏ„,L due to the mixing of the underlying Markov
chain. We rewrite the terms in Eq. (10) as

(cid:123)(cid:122)
P (yLB )

(cid:123)(cid:122)
P (yRB )

1TP (yRB)

âˆ‚P (yÏ„,L)
âˆ‚Î¸
1TP (yRB)P (yÏ„,L)P (yLB)Ï€0

P (yLB)Ï€0

.

(14)

We note that Eq. (12) is computed in time O(| (cid:101)S|LK 2) us-
ing buffers. When | (cid:101)S|L (cid:28) T this results in signiï¬cant
computational speedups over batch inference algorithms.

A critical question that needs to be answered is how long
should the buffers be? Though previous theory exists to
quantify the buffer length, the resulting lengths are of-
ten longer than the entire sequence (LeGland & Mevel,

Stochastic Gradient MCMC Methods for Hidden Markov Models

Figure 1. Diagram of subsequences, buffers, and subsequence sampling from full observation sequence. Left: The SVI method of Foti
et al. (2014) approximates stochastic gradients using subchains of length 2L + 1 using the forward-backward algorithm performed on
both the subchains and the associated buffer chains of length B. Right: Our propsoed SG-MCMC method uses a similar subsampling
approach, however, i) the latent chain is never instantiated and ii) a minimum gap between consecutive subchains, yÏ„,L, is used to ensure
nearly uncorrelated subsequences. The thick black lines through the observables y represent all pairwise correlations between observa-
tions due to marginalization of x. Correlation decays with distance enabling the segmentation of the of the chain into subsequences.

1997). A heuristic solution was suggested (Foti et al.,
2014), but theoretical justiï¬cation was lacking. We pro-
pose estimating the buffer length using the Lyapunov expo-
nent of the random dynamical system speciï¬ed by A and
P (yÏ„,L). The Lyapunov exponent L measures the evo-
lution of the distance between vectors after applying the
operator (P (yÏ„,L)A)[Â·] (Arnold, 1998). By generalizing
the Perronâ€“Frobenius theorem, all of the eigenvalues of the
operator (P (yÏ„,L)A)[Â·] are less than 0, which implies that
L â‰¤ 0 (Seneta, 2006). The greater the absolute value of L,
the faster the errors at the boundaries of the buffers decay,
and the shorter the buffers need to be. Given an estimate of
L, we set the buffer length as B = (cid:6)Lâˆ’1 ln (Î´/Î´0)(cid:7) where
Î´ â‰¤ Î´0 are error tolerances. The method of calculating L
is described in the Supplement. Forthcoming work in the
applied probability literature formalizes the validity of this
approach (Ye et al.).

Approximately independent subsequences We esti-
mate (cid:103)âˆ‡U (Î¸) with minibatches composed of subsequences.
When the subsequences in a minibatch overlap or are very
close to one another, the statistical efï¬ciency of (cid:103)âˆ‡U (Î¸)
is diminished, requiring more subsequences to obtain ac-
curate estimates. If we assume that the Markov chain of
the latent state sequence is in equilibrium â€” a realistic as-
sumption if T is huge â€” then we can leverage the memory
decay of the Markov chain to encourage independent sub-
sequences for use in the gradient estimator.

The mixing time of a Markov chain, denoted Î½, is the num-
ber of steps needed until the chain is â€œcloseâ€ to its sta-
tionary distribution (Seneta, 2006). This implies that for
|tâˆ’Ï„ | > Î½, the corresponding xt and xÏ„ are approximately
independent. Consequently, if we choose the buffer length
B > 0 s.t. L+B â‰¥ Î½, then t < Ï„ âˆ’Lâˆ’B or t > Ï„ +L+B
implies that yt is approximately independent of yLB, yÏ„,L,
and yRB. Therefore, we can increase the statistical efï¬-

ciency of (cid:103)âˆ‡U (Î¸) by sequentially sampling the yÏ„,Ls such
that they are at least 2(L + B) + Î½ time indices apart (see
the Supplement for details). We estimate the mixing time
Î½ = (1 âˆ’ Ë†Î»2)âˆ’1 where Ë†Î»2 is the second largest eigenvalue
of the current transition parameter iterate, A(t).

When sampling subsequences adhering to the mixing-time-
dependent gap, each term in Eq. (12) is rendered approx-
imately independent. Following standard practice for SG-
MCMC algoriths, we appeal to the central limit theorem
obtaining the following expression for the asymptotic dis-
tribution of (cid:103)âˆ‡U (Î¸) as:

(cid:103)âˆ‡U (Î¸) â‰ˆ âˆ‡U (Î¸) + N (0, Vi(Î¸)),

(15)

where Vi(Î¸) is the stochastic gradient noise variance. This
will prove crucial for our analysis in Sec. 3.4.

3.3. Incorporating Geometric Information

Eq. (4) serves as a general purpose algorithm that theoret-
ically attains the correct stationary distribution for any D
and Q matrices when the step size (cid:15)t approaches zero. But
in practice, we need to take into account numerical sta-
bility during numerical integrals. For example, when we
are sampling from the probability simplex, previous work
has shown that taking the curvature of the parameter space
into account is important (Welling & Teh, 2011; Ma et al.,
2015). Since our transition parameters live on the sim-
plex, we likewise incorporate the geometry of the parame-
ter space by constructing a stochastic-gradient Riemannian
MCMC (SG-RMCMC) algorithm.

SG-RLD for transition parameters
In order to sample
the transition matrix A we note that the columns of A are
constrained to lie on the probability simplex. To address
these constraints, we use the expanded mean parametriza-

B ğµ 2ğ¿+1 Minimum Gap: ğœˆ Marginalize  ğ±  B ğµ 2ğ¿+1 yLB yRB y1:T ğ± ğ² yÏ„ Stochastic Gradient MCMC Methods for Hidden Markov Models

| Ë†Ai,j|
i | Ë†Ai,j|

(cid:80)

tion: A =

, similar to what Patterson & Teh

(2013) used for topic modeling. Evaluating (cid:103)âˆ‡U (Î¸) in
Eq. (10) for Î¸ = Ë†Ai,j, using Eq. (8) yields:

(cid:103)âˆ‡U Ë†Ai,j

( Ë†Ai,j)

(16)

= âˆ’

1
p( (cid:101)S)

(cid:88)

Ï„ +L
(cid:88)

yÏ„,Lâˆˆ (cid:101)S

t=Ï„ âˆ’L

((cid:101)qÏ„ +L+1)i Pi,i(yt) ((cid:101)Ï€Ï„ âˆ’Lâˆ’1)j
Ï„ +LP (yt) Ë†A(cid:101)Ï€Ï„ âˆ’L
(cid:101)qT

.

Here, ËœÏ€Ï„ âˆ’Lâˆ’1 and ËœqÏ„ +L+1 are computed on the left and
right buffers, respectively, according to Eq. (13). The terms
inside the sum in Eq. (16) are analogous to the pairwise
marginals of the latent state in traditional HMM inference
algorithms. A detailed derivation of this gradient can be
found in the Supplement.

By leveraging the ï¬‚exible SG-MCMC update rule of
Eq. (7), we remove the dependency on Ë†Ai,j from the de-
nominator of Eq. (16) by selecting D = Ë†A and Q = 0.
This yields the following update:

Ë†A(t+1)

i,j â† Ë†A(t)

i,j âˆ’ (cid:15)t
(cid:16)

+ N

0, (cid:15)t

(cid:104) Ë†A(t)
i,j (cid:103)âˆ‡U Ë†Ai,j
(cid:16)
2 Ë†A(t)

i,j âˆ’ (cid:15)t (cid:98)B(t)

i,j

(cid:105)

( Ë†A(t)

i,j , Ï†) + I
(cid:17)(cid:17)

(17)

where Ï† denotes all other model parameters. We note that
this pre-conditioned gradient takes advantage of the local
geometry of the parameter space by pre-multiplying by a
metric tensor that arises from Eq. (7).

SG-RLD for emission parameters Similarly to the tran-
sition parameters, we sample the emission parameters
{Ï†k : k = 1, . . . , K}, by evaluating (cid:103)âˆ‡U (Î¸) in Eq. (10)
for Î¸ = Ï†k Using Eq. (8). This results in the gradient:

(cid:103)âˆ‡U (Ï†k) = âˆ’

1
p( (cid:101)S)

(cid:88)

Ï„ +L
(cid:88)

yÏ„,Lâˆˆ (cid:101)S

t=Ï„ âˆ’L

(18)

.

Â·

âˆ‚ ln Pk,k(yt)
âˆ‚Ï†k

((cid:101)qÏ„ +L+1)k Pk,k(yt) ((cid:101)Ï€Ï„ âˆ’Lâˆ’1)k
(cid:101)qT
Ï„ +L+1P (yt)A(cid:101)Ï€Ï„ âˆ’Lâˆ’1
Again, ËœÏ€Ï„ âˆ’Lâˆ’1 and ËœqÏ„ +L+1 are computed on the left and
right buffers, respectively, according to Eq. (13). Similarly
to the transition parameters, we account for the geometry of
the parameter space by specifying an appropriate D and Q
in Eq. (7) which in general depends on the form of p(yt|Ï†).
For exponential family emission distributions we recom-
mend taking D to be the inverse of the Fisher information
matrix (Amari, 1998).

As a concrete example, we consider a Gaussian emission
distribution. Deï¬ne, zt = (Âµk âˆ’ yt), then we have:

âˆ‡Âµk ln Pk,k(yt) = Î£âˆ’1

k zt

âˆ‡Î£k ln Pk,k(yt) =

Î£âˆ’1
k

(cid:0)Î£k âˆ’ ztzT

t

(cid:1) Î£âˆ’1
k .

1
2

(19)

(20)

We plug these values into the SG-MCMC update of Eq. (7)
using D = Î£ to account for the geometry of the parameter
space and Q = 0. This leads to the update equations:

Âµ(t+1)
k â†Âµ(t)

(cid:104)

Î£(t)
k

k âˆ’ (cid:15)t
+ N (0, (cid:15)t(2Î£(t)

(cid:94)âˆ‡Âµk U (A, Ï†(t)
k )

(cid:105)

k âˆ’ (cid:15)t (cid:98)Bt)).

(21)

k â†Î£(t)
Î£(t+1)

(cid:104)

Î£(t)
k

k âˆ’ (cid:15)t
+ N (0, (cid:15)t(2Î£(t)

(cid:94)âˆ‡Î£k U (A, Ï†(t)
k âŠ— Î£(t)

k )Î£(t)
k âˆ’ (cid:15)t (cid:98)B(t))).

(cid:105)

k + Î£(t)

k

(22)

It is possible when using Eq. (22) to obtain a Î£(t+1) that is
not positive deï¬nite. In this case we reject the update and
set Î£(t+1) = Î£(t).

3.4. Analysis of SG-MCMC for HMMs

Our proposed SG-MCMC scheme for HMMs introduces
error in three ways. The ï¬rst two carry over from the stan-
dard i.i.d. setting: (i) discretizing the continuous stochastic
dynamics and (ii) estimating the stochastic gradient noise
covariance, as discussed in Sec. 2.2.

The third is via our approximations ËœÏ€Ï„ âˆ’Lâˆ’1 and ËœqÏ„ +L+1.
This error is already incorporated in Eq. (15), and vanishes
with (cid:15)t in Eq. (7). Thus, applying the results from Ma
et al. (2015; 2016), we can show that the proposed SG-
MCMC for HMMs asymptotically has the right stationary
distribution under the same conditions as in the i.i.d. case.
However, in practice we use a ï¬xed (cid:15)t, and as we show in
Sec. 4.1, performing sufï¬cient buffering via our Lyapunov
exponent approach is critical.

In summary, our SG-MCMC algorithm enables MCMC-
based inference in HMMs for massive sequences of data.
In particular, we only require computations on collections
of small subsequences and attain the desired stationary dis-
tribution by mitigating the errors incurred by these approx-
imations. Finally, we have shown how to incorporate ge-
ometric information about the parameter space in order to
increase the numerical robustness of the algorithm.

4. Experiments

We evaluate the performance of our proposed SG-RLD
algorithm for HMMs on both synthetic and real data.
First, we demonstrate the effectiveness of incorporating the
buffers on two synthetic data sets that exhibit very differ-
ent dynamics. Next we apply our SG-RLD for HMMs to
a non-conjugate model of synthetic data. Finally, we ap-
ply SG-RLD to a large ion channel recording data set and
compare to batch MCMC.

Stochastic Gradient MCMC Methods for Hidden Markov Models

Algorithm 2 SG-MCMC for HMM

initialize A(0) and Ï†(0)
k
for n = 0, 1, 2 Â· Â· Â· , Niter do

Periodically estimate the buffer length B and the min-
imum subchain gap Î½ according to Sec. 3.
Sample subchains ËœS of length L from p( (cid:101)S).
for s = 1 Â· Â· Â· Nsteps do

Update Ë†A(s) according to Eq. (16) and (17)

end for
Calculate Ë†A = 1
Set Ai,j â† | Ë†Ai,j|
for s = 1 Â· Â· Â· Nsteps do

Nsteps
(cid:46)(cid:80)

(cid:80)Nsteps
s=1

Ë†A(s).

i | Ë†Ai,j|

update Ï†(s) according to Eqs. (19)â€“ (22)

end for
Set Ï† = 1

Nsteps

(cid:80)Nsteps

s=1 Ï†(s).

end for

4.1. Evaluating Buffer Effectiveness

We ï¬rst design two synthetic experiments in order to il-
lustrate the effectiveness of our adaptive buffer scheme.
We compare SG-RLD with buffering, without buffering,
and treating the data as i.i.d. as a baseline. We can view
the no-buffer algorithm as one that treats the subsequences
as short, independent realizations, similarly to (Johnson &
Willsky, 2014). Following Foti et al. (2014), we create two
synthetic datasets both with T = 20 million observations
and K = 8 latent states (see Fig. 2 (top)).

The ï¬rst data set, diagonally dominant (DD) consists of
a Markov chain that heavily self-transitions and has iden-
tiï¬able emissions. The second datasetâ€”reversed cycles
(RC)â€”strongly transitions between two cycles over three
states, each in opposite directions. Further details on these
datasets and how we set L and | (cid:101)S| are in the Supplement.

The 10-step-ahead predictive log probability is depicted in
Fig. 2 for the DD and RC datasets. See the Supplement for
similar results comparing errors in transition matrix estima-
tion. In both cases, we see that both SG-RLD HMM meth-
ods greatly outperform the i.i.d. algorithm. The reason i.i.d.
SG-RLD performs so badly on the DD data stems from all
states being equally probable so that ignoring the dynam-
ics forces the model to have little apriori conï¬dence in the
next observations. For the RC dataset, the i.i.d. algorithm
fails to capture the structured transitions between states,
again reducing predictive performance.
Importantly, our
adaptive buffer scheme attains both better predictive per-
formance and converges to the true transition matrix in less
time. In fact, there is a bias in the learned transition matrix
for the non-buffered algorithm due to inaccurate subchain
approximation of q, Ï€. This experiment demonstrates that
accounting for dynamics yields massive gains in predictive

Figure 2. Synthetic experiments for DD (left) and RC (right) data.
Top: Sample datasets; Arrows indicate Markov transitions. Bot-
tom: 10-step-ahead log predictive likelihood versus learning time
for DD (left) and RC (right) dynamics. Comparisons are made for
SG-RLD algorithms with adaptive buffer, no buffer, and treating
the data as i.i.d..

Figure 3. Synthetic experiment with log-normal emission. We
use the non-conjugate emission model on the synthetic data (Top
Left) with two hidden states and log-normal emissions and com-
pare it against the conjugate model. We show the difference
in convergence speed (Top Right) and log held out probability
ln p(ytest|ytrain) on 2, 000 test data (Bottom).

performance and that using our adaptive buffer scheme pro-
vides further gains on top of that.

4.2. Non-conjugate Emission Distributions

We next demonstrate the beneï¬t of our SG-RMCMC al-
gorithm in being able to handle non-conjugate emissions,
an essential feature to perform ï¬‚exible Bayesian analyses.
We simulate 2 Ã— 105 observations from a 2-state HMM
with log-normal emissions. Details of the parameter set-
tings used to generate the data are in the Supplement. We

Diagonally Dominant Reversed Cycles 050100150âˆ’60âˆ’40âˆ’200runtime (sec)log predictive prob  BufferNo BufferI.I.D.0100200âˆ’40âˆ’30âˆ’20âˆ’100runtime (sec)  0200400020406080 ytt020040060000.511.5Iterations|| A âˆ’ Atrue ||F  Nonâˆ’Conjugate ModelConjugate ModelK Non-Conjugate Emission  Conjugate Emission  1 âˆ’2.2679Ã—104 âˆ’1.3172Ã—105 2 âˆ’ğŸ.ğŸ—ğŸ“ğŸğŸ–Ã—ğŸğŸğŸ’ âˆ’1.3081Ã—105 3 âˆ’2.2005Ã—104 âˆ’8.8227Ã—104 4 âˆ’2.0376Ã—104 âˆ’ğŸ•.ğŸ“ğŸ“ğŸğŸÃ—ğŸğŸğŸ’ Stochastic Gradient MCMC Methods for Hidden Markov Models

Figure 4. Inference of ion channel data Top: SG-RLD segmentation at runtimes: 44.05, 138.51, and 466.82 (sec). Bottom: Batch-RLD
segmentation at runtimes: 716.19, 2124.43, and 7245.14 (sec). Right: Held-out-probability of 5000 unobserved data points (top) and
error decay of transition matrix estimates (bottom) for SG-RLD and batch-RLD methods in loglog scales. Acvg denotes the estimated
transition parameters A after convergence. SG-RLD obtains plausible segmenations and accurate estimates of the transition matrix in a
fraction of the time as a batch algorithm.

evaluate the ability of two different HMM models in terms
of parameter estimation and model selection accuracy.

ther log-transform and normalize the observations to use
Gaussian emission.

The ï¬rst HMM we consider uses log-normal emissions
with non-conjugate normal priors. The second model
uses Gaussian emissions with a conjugate normal-inverse-
Wishart prior.
In Fig. 3 we show that the non-conjugate
model obtains accurate estimates of the transition ma-
trix in substantially fewer iterations than the conjugate
model. Next, we demonstrate that efï¬ciently handling
non-conjugate models leads to improved model selection.
Speciï¬callly, we use SG-RLD to ï¬t both the conjugate and
non-conjugate HMMs described above with K = 1, 2, 3, 4
states and compute the marginal likelihood of the observa-
tions under each model. In the table of Fig. 3 we see that
the non-conjugate model selects the right number of states
(2), whereas the conjugate model selects a model with more
states (4). The ability to use non-conjugate HMMs for truly
massive data sets has been infeasible until this point and
this experiment demonstrates its utility.

4.3. Ion Channel Recordings

We investigate the behavior of the SG-RLD sampler on
ion channel recording data.
In particular, we consider a
1MHz recording from Rosenstein et al. (2013) of a sin-
gle alamethicin channel. This data was previously inves-
tigated in Palla et al. (2014) and Tripuraneni et al. (2015)
using a complicated Bayesian nonparametric HMM. In that
work, the authors downsample the data by a factor of 100
and only used 10, 000 and 2, 000 observations respectively
due to the challenge of scaling computations to the full se-
quence. We subsample the time series by a factor of 50,
resulting in 209, 634 observations, to reduce the strong au-
tocorrelations present in the observations that are not cap-
tured well by a vanilla HMM. However, our algorithm
would have no difï¬culty handling the full dataset. We fur-

We use a non-informative ï¬‚at prior to analyze the ion chan-
nel data. In Fig. 4 we see that before the batch-RLD algo-
rithm ï¬nishes a single iteration, the SG-RLD algorithm has
already converged and generated a reasonable segmenta-
tion. With the converged estimation of the transition pa-
rameters A as reference, we calculated the speed of con-
vergence of SG-RLD and batch-RLD algorithms and found
that the SG-RLD is approximately 1, 000 times faster.

5. Discussion

We have developed an SG-MCMC algorithm to perform in-
ference in HMMs for massive observation sequences. The
algorithm can be used with non-conjugate emission distri-
butions and is thus applicable to modeling a variety of data.
Also, the algorithm asymptotically samples from the true
posterior as opposed to variational approaches.

Developing the algorithm relied on three ingredients. First,
we derived an efï¬cient approach to estimate the gradient of
the marginal likelihood of the HMM from only small sub-
chains. Second, we developed a principled approach using
buffers to mitigate the errors introduced when breaking the
dependencies at the boundaries of the subchains. Unlike
previous heuristic buffering schemes, our approach is the-
oretically justiï¬ed using random dynamical systems. Last,
we utilize sampling scheme based on the mixing time of the
HMM to ensure subchains are approximately independent.

In future work we will extend these ideas to other models of
dependent data, such as Markov random ï¬elds. Also, the
ideas presented here are not limited to MCMC and could
be used to develop more principled variational inference
algorithms for dependent data.

020004000âˆ’1012t yt010002000300040005000âˆ’1012t010002000300040005000âˆ’1012t102103104105âˆ’8âˆ’6âˆ’4âˆ’2x 104runtime (sec)log held out prob  SGâˆ’RLDbatchâˆ’RLD020004000âˆ’1012t yt010002000300040005000âˆ’1012t010002000300040005000âˆ’1012t10010110210310410510âˆ’2100runtime (sec)|| A âˆ’ Acvg ||F  SGâˆ’RLDbatchâˆ’RLDStochastic Gradient MCMC Methods for Hidden Markov Models

Acknowledgements

This work was supported by ONR Grant N00014-15-1-
2380, NSF CAREER Award IIS-1350133, and by Ter-
raSwarm, one of six centers of STARnet, a Semiconduc-
tor Research Corporation program sponsored by MARCO
and DARPA. NF was supported by a Washington Research
Foundation Innovation Postdoctoral Fellowship in Neuro-
engineering and Data Science.

References

Amari, S. Natural gradient works efï¬ciently in learning.

Neural Computation, 10(2):251â€“276, 1998.

Arnold, L. Random Dynamical Systems. Springer, 1998.

Beale, M. J.

Variational Algorithms for Approximate
Bayesian Inference. Ph.D. thesis, University College
London, 2003.

Bishop, C. M. Pattern Recognition and Machine Learning.

Springer, 2006.

Broderick, T., Boyd, N., Wibisono, A., Wilson, A. C., and
Jordan, M. I. Streaming variational Bayes. In Advances
in Neural Information Processing Systems, 2013.

Bryant, M. and Sudderth, E. B. Truly nonparametric online
variational inference for hierarchical Dirichlet processes.
In Advances in Neural Information Processing Systems,
2012.

Chen, C., Ding, N., and Carin, L. On the convergence of
stochastic gradient mcmc algorithms with high-order in-
tegrators. In Advances in Neural Information Processing
Systems 28, pp. 2278â€“2286. 2015.

Chen, T., Fox, E. B., and Guestrin, C. Stochastic gradient
Hamiltonian Monte Carlo. In Proceeding of 31st Inter-
national Conference on Machine Learning (ICMLâ€™14),
2014.

Ding, N., Fang, Y., Babbush, R., Chen, C., Skeel, R. D.,
and Neven, H. Bayesian sampling using stochastic gra-
In Advances in Neural Information
dient thermostats.
Processing Systems 27 (NIPSâ€™14). 2014.

Foti, N. J., Xu, J., Laird, D., and Fox, E. B. Stochastic
variational inference for hidden Markov models. In Ad-
vances in Neural Information Processing Systems, 2014.

Fox, E.B. Bayesian Nonparametric Learning of Complex
Dynamical Phenomena. Ph.D. thesis, MIT, Cambridge,
MA, 2009.

Gopalan, P. K., Gerrish, S., Freedman, M., Blei, D. M., and
Mimno, D. M. Scalable inference of overlapping com-
munities. In Advances in Neural Information Processing
Systems, pp. 2249â€“2257. 2012.

Hoffman, M. D., Blei, D. M., Wang, C., and Paisley, J.
Journal of Maching

Stochastic variational inference.
Learning Research, 14(1):1303â€“1347, May 2013.

Hughes, M. C., Stephenson, W., and Sudderth, E. B. Scal-
able adaptation of state complexity for nonparametric
In Advances in Neural Infor-
hidden Markov models.
mation Processing Systems, 2015.

Johnson, M. J. and Willsky, A. S. Stochastic variational in-
ference for Bayesian time series models. In International
Conference on Machine Learning, 2014.

LeGland, F. and Mevel, L. Exponential forgetting and ge-
ometric ergodicity in hidden Markov models. In IEEE
Conference on Decision and Control, 1997.

Leimkuhler, Benedict and Shang, Xiaocheng. Adaptive
thermostats for noisy gradient systems. SIAM Journal
on Scientiï¬c Computing, 38(2):A712â€“A736, 2016.

Ma, Y.-A, Chen, T., and Fox, E. B. A complete recipe for
stochastic gradient MCMC. In Advances in Neural In-
formation Processing Systems 28, pp. 2899â€“2907. 2015.

Ma, Y.-A., Fox, E. B., Chen, T., and Wu, L. A unifying
framework for devising efï¬cient and irreversible MCMC
samplers. arXiv:1608.05973, 2016.

Palla, K., Knowles, D. A., and Ghahramani, Z. A reversible
inï¬nite HMM using normalised random measures.
In
International Conference on Machine Learning, 2014.

Patterson, S. and Teh, Y. W. Stochastic gradient Rieman-
nian Langevin dynamics on the probability simplex. In
Advances in Neural Information Processing Systems 26
(NIPSâ€™13). 2013.

Rabiner, L. R. A tutorial on hidden Markov models and
selected applications in speech recognition. In Proceed-
ings of the IEEE, volume 77, pp. 257â€“286, 1989.

Robbins, H. and Monro, S. A stochastic approximation
method. The Annals of Mathematical Statistics, 22(3):
400â€“407, 09 1951.

Rosenstein, J. K., Ramakrishnan, S., Roseman, J., and L,
Shepard K. Single ion channel recordings with CMOS-
anchored lipid membranes. Nano Letters, 13(6):2682â€“
2686, 2013.

Scott, S. L. Bayesian methods for hidden Markov models:
Recursive computing in the 21st century. Journal of the
American Statistical Association, 97(457):337â€“351, 03
2002.

Seneta, E. Non-negative matrices and Markov chains.

Springer Science & Business Media, 2006.

Stochastic Gradient MCMC Methods for Hidden Markov Models

Shang, X., Zhu, Z., Leimkuhler, B., and Storkey, A.
Covariance-controlled adaptive Langevin thermostat for
large-scale Bayesian sampling. In Advances in Neural
Information Processing Systems 28 (NIPSâ€™15). 2015.

Tripuraneni, N., Gu, S., Ge, H., and Ghahramani, Z. Par-
ticle Gibbs for inï¬nite hidden Markov Models. In Ad-
vances in Neural Information Processing Systems, pp.
2386â€“2394, 2015.

Vollmer, S. J., Zygalakis, K. C., and Teh, Y. W. Exploration
of the (non-)asymptotic bias and variance of stochastic
gradient Langevin dynamics. Journal of Machine Learn-
ing Research, 17(159):1â€“48, 2016.

Welling, M. and Teh, Y. W. Bayesian learning via stochas-
In Proceedings of
tic gradient Langevin dynamics.
the 28th International Conference on Machine Learning
(ICMLâ€™11), pp. 681â€“688, June 2011.

Ye, F. X.-F., Ma, Y.-A., and Qian, H. A numerical algo-
rithm for calculating the rate of exponential forgetting in
HMM. manuscript in preparation.

