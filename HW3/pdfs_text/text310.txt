Differentially Private Chi-squared Test by Unit Circle Mechanism

Kazuya Kakizaki 1 Kazuto Fukuchi 1 Jun Sakuma 1 2 3

Abstract
This paper develops differentially private mech-
anisms for χ2 test of independence. While exist-
ing works put their effort into properly control-
ling the type-I error, in addition to that, we in-
vestigate the type-II error of differentially private
mechanisms. Based on the analysis, we present
unit circle mechanism: a novel differentially pri-
vate mechanism based on the geometrical prop-
erty of the test statistics. Compared to existing
output perturbation mechanisms, our mechanism
improves the dominated term of the type-II er-
√N )) where N is the
ror from O(1) to O(exp(
sample size. Furthermore, we introduce novel
procedures for multiple χ2 tests by incorporat-
ing the unit circle mechanism into the sparse vec-
tor technique and the exponential mechanism.
These procedures can control the family-wise er-
ror rate (FWER) properly, which has never been
attained by existing mechanisms.

−

1. Introduction

Hypothesis testing is a statistical framework to ascertain
whether or not given samples follow a speciﬁc model or
not in a systematic manner. For this study, we presume that
highly sensitive information might be included in the sam-
ples. A typical situation is genome-wide association stud-
ies (GWAS). Homer et al. reported that a patient’s disease
status could be inferred from aggregate statistics collected
for GWAS (Homer et al., 2008).

Differential privacy (Dwork et al., 2006) is a recent notion
of privacy that is tailored to a privacy-preserving release
of aggregate statistics. As described in this paper, we give
speciﬁc consideration to the differential privacy of χ2 test

1Department of Computer Science, University of Tsukuba,
Japan 2JST CREST
1-1-1 Tennohdai, Tsukuba,
3RIKEN Center for Advanced Intelligence Project. Correspon-
dence to: Kazuya Kakizaki <kazuya@mdl.cs.tsukuba.ac.jp>,
Kazuto Fukuchi <kazuto@mdl.cs.tsukuba.ac.jp>, Jun Sakuma
<jun@cs.tsukuba.ac.jp>.

Ibaraki,

Proceedings of the 34 th International Conference on Machine
Learning, Sydney, Australia, PMLR 70, 2017. Copyright 2017
by the author(s).

of independence. Two lines of studies exist in differentially
private χ2-tests of independence:
input perturbation and
output perturbation. The input perturbation method ensures
differential privacy by randomizing each count in the con-
tingency table (Uhler et al., 2013; Johnson & Shmatikov,
2013; Wang et al., 2015; Gaboardi et al., 2016). The output
perturbation method randomizes the test statistic to satisfy
differential privacy (Fienberg et al., 2011; Yu et al., 2014;
Uhler et al., 2013; Wang et al., 2015). Also recently, there
is a study for the differential privacy of χ2 test of identity,
which ensures type-I and typ-II error (Cai et al., 2017).

The contribution of this study is three-fold. First, we an-
alyze the type-II error of the differentially private mecha-
nism for output perturbation.
In principle, (non-privacy-
preserving) hypothesis test procedures are preferred to
achieve a greater power with keeping the signiﬁcance at
In the case of differentially private
a prescribed level.
hypothesis test, the same is required under the constraint
of differential privacy. Much efforts have been devoted
to controlling the signiﬁcance level properly (Wang et al.,
2015; Gaboardi et al., 2016) whereas little attention has
been paid to the power analysis. We analyze the type-II
error of the differentially private mechanism for χ2-test,
and show that it is upper-bounded by two terms which are
mechanism-dependent. The bound indicates that a mecha-
nism with a lower sensitivity and lower γ error (deﬁned in
Section 4) achieves a greater power.

Second, we investigate the geometrical property of the test
statistic of the χ2-test. Then, we propose the unit circle
mechanism: a novel differentially private mechanism based
on the geometrical property. In existing mechanisms based
on output perturbation, the sensitivity is O(1) in terms
of N (Fienberg et al., 2011; Yu et al., 2014; Uhler et al.,
2013). We demonstrate that the sensitivity of the unit cir-
cle mechanism is O(1/√N ), which achieves lower type-II
error (Theorem 7).

Third, we present two procedures for differentially private
multiple χ2 tests of independence that can control the fam-
ilywise error rate (FWER). Actually, FWER can be con-
trolled properly using existing DP mechanisms for χ2-test
by repeatedly using (Uhler et al., 2013), for example. How-
ever, such a naive construction consumes the privacy bud-
get, which is linear to the number of all the considered

Differentially Private Chi-squared Test by Unit Circle Mechanism

tests and which would produce useless test results. There
exist several studies that work with a lower privacy bud-
get in the multiple testing setting (Johnson & Shmatikov,
2013). However, to the best of our knowledge, no dif-
ferentially private multiple testing procedure that can con-
trol FWER properly has been presented. We introduce
two novel procedures for multiple χ2 tests by incorporat-
ing the unit circle mechanism into the sparse vector tech-
nique (SVT) (Dwork & Roth, 2014) and exponential mech-
anism (McSherry & Talwar, 2007). The exponential mech-
anism based procedure works in the non-interactive set-
ting, in which the set of hypotheses considered needs to
be prescribed before starting the testing procedure. This
mechanism ﬁrst selects top-k signiﬁcant hypotheses and
then performs the statistical test for each hypothesis. The
SVT based procedure works in the interactive setting, in
which the hypothesis to be considered at each round can be
interactively chosen after observing the result of the tests
in the previous rounds. The SVT based procedure con-
trols FWER by adjusting the threshold of SVT using Monte
Carlo sampling. Simultaneously, we show the privacy bud-
get consumed by the both procedures is not dependent on
the total number of the hypotheses considered, but only on
the prescribed maximum number of hypothesizes to be ac-
cepted.

2. Preliminaries

2.1. Differential Privacy
xi|

xi ∈X

{

}

S

Y

and

S→Y

is a statistical query.

, i = 1, . . . , N
Let S =
be a set of records.
Presume that an analyst holds S and wishes to release
a result of statistical analysis f (S) to the public, where
f :
respec-
tively denote the input domain and output domain. Dif-
ferential privacy (DP) is a privacy deﬁnition that restricts
privacy breach of any element in S caused by releasing
y = f (S) (Dwork et al., 2006). Let d(S, S′) =
=
i : xi ̸
x′i, xi ∈
denote the Hamming distance be-
tween two sets. When h(S, S′) = 1, we say that S and S′
S′. Ensuring DP requires ran-
are adjacent, or that S
Mf (S) denote a
domization of outputs, by deﬁnition. Let
randomization mechanism of f .
Mf is differentially pri-
vate if it satisﬁes the following deﬁnition:

S, x′i ∈

S′

|{

}|

∼

Deﬁnition 1 (ϵ-DP (Dwork et al., 2006)). Mechanism
,

provides ϵ-DP if, for any S

S′ and Y

:

M

S→Y

Pr[

(S)

Y ]

M

∈

≤

∼
exp(ϵ) Pr[

⊆Y
Y ].

(x′)

M

∈

We introduce a basic mechanism that ensures DP for scalar
outputs. For query f , the following randomization by
Laplace mechanism

(S) = f (S) + Lap(

M

∆f
ϵ

)

guarantees ϵ-DP, where Lap(b) denotes a random value
generated from the Laplace distribution for which the scale
parameter is b (Dwork et al., 2006). ∆f denotes the sensi-
tivity of the query, which is deﬁned as

∆f = max
S′ |

S

∼

f (S)

f (S′)

.

−

|

We remark that no post-processing of outputs obtained
from any DP mechanism changes the guarantee on
DP (Dwork & Roth, 2014).

2.2. Answering Multiple Queries

When we obtain multiple outputs from a mechanism com-
puted on disjoint data subsets, the following composition
theorem is applied.
Theorem 1 (Composition theorem (McSherry & Talwar,
2007)). Let Mi
→Y i be ϵ-DP mechanism for
: S
, K. Let ˆM : S
,
i = 1,
,
×YK be the
· · ·
, MK). Then, ˆM is Kϵ-
mechanism that outputs (M1,
differential private.

→Y i×
· · ·

· · ·

fk(S)
{

Let f1, . . . , fK be a query sequence. Suppose analyst
wishes to know whether or not fk(S) >τ holds for all k
K
where τ is a threshold. If the analyst obtains
k=1,
}
the privacy budget for each query needs to be set to 1/Kϵ to
ensure ϵ-DP, which would result in extremely unuseful out-
puts when K is large. Suppose the analyst is interested only
in whether or not each output is above a threshold value. If
the analyst has a good reason to believe that only s(
K)
answers would exceed the threshold value, the sparse vec-
tor technique (SVT) (Dwork & Roth, 2014) helps to reduce
consumption of the privacy budget drastically. Let
mean
that fk(S) >τ . Assuming SVT is terminated after answer-
ing at most s outputs, it outputs
only when the following
holds for k = 1, . . .:

≪

⊤

⊤

fk(S) + Lap(4∆s/ϵ)

τ + ρ

(1)

≥

1.
where ρ = Lap(2∆s/ϵ) and ∆ is the sensitivity of fk
Otherwise, it outputs nothing. It is proved that SVT guaran-
tees ϵ-DP. What is remarkable about SVT is that the privacy
budget is independent on the total number of the queries,
but only on s. See Appendix. A for the detail .

3. Differentially Private χ2-Test
3.1. χ2-Test of Independence

Let X0 and X1 be discrete random variables and presume
that we are interested in the independence between the two
random variables.
In this study, we suppose the random
variables are binary. For the statistical test of indepen-
dence, the null hypothesis is that X0 and X1 are indepen-
, xN }
dent. Let S =
be a set of samples drawn
1We require that all the queries have the same sensitivity

x1,
{

· · ·

Differentially Private Chi-squared Test by Unit Circle Mechanism

Table1. Contingency table T of two binary varaibles

X1 = 1 X1 = 0

X0 = 1
X0 = 0

c11
c01
N1

c10 M1
c00 M0
N
N0

n = (xn,0, xn,1)

from the two random variables where xT
∈
2 are realization of X0 and X1. Given S, Table 1 de-
0, 1
}
{
notes the 2
2 contingency table w.r.t. X0 and X1 where
cpq denotes the number of samples in S such that X0 = p
and X1 = q. The marginals N1, N0, M1, and M0 are de-
ﬁned as in Table 1. The test statistic for χ2-test of indepen-
dence is given as

×

χ2(S) =

(c11c00 −

c10c01)2N

. (2)

(c11 + c10)(c11 + c01)(c10 + c00)(c01 + c00)

the χ2-test statistics is
Under the null hypothesis H0,
known to follow the χ2 distribution with one degree of
freedom, asymptotically (Bishop et al., 1975). Given S and
signiﬁcance level α, the χ2-test of independence is run as

χ2-test(S, α) =

rej
acc

!

if χ2(S) >τ α,
otherwise.

a

∞

τα is

threshold determined such that
Therein,
τ χ2
(1)(z)dz = α. Here, rej and acc respectively indi-
cate that H0 is rejected and accepted. We learn that there
"
exists evidence that X0 and X1 are dependent on the sig-
niﬁcance level of α if H0 rejected. The type-1 error of χ2
test is equivalent to the signiﬁcance level:
α = Pr[χ2(S) >τ α|

H0 is true].

The power is deﬁned by the probability of rejecting the null
hypothesis when the alternative hypothesis is true:
β = Pr[χ2(S) >τ α|
Therein, β denotes the type-II error.

H1 is true]

−

1

M

be a randomization mechanism for χ2 testing. Un-
Let
der the constraints that
ensures DP and that type-I error
is preserved at most α, we evaluate the utility of the mech-
β, the power of the mechanism.
anism by 1

M

−

3.2. Output Perturbation Method

The most straightforward method to ensure the DP of χ2
test is the randomization of the test statistic (Fienberg et al.,
2011; Yu et al., 2014; Uhler et al., 2013; Wang et al.,
2015). Application of the Laplace mechanism to the χ2
statistic immediately ensures DP, as

χ2(S) = χ2(S) + Lap(

∆
ϵ

),

#

where ∆ is the sensitivity of the test statistic. For exam-
ple, given N0 and N1 are released to the public, (Yu et al.,
2014) derived the following sensitivity:

∆Y =

N 2
N0N1 $

max

N0, N1}

{
N0, N1}
{

.
+ 1 %

max

(3)

Other sensitivity analyses are provided elsewhere in the rel-
evant literature (Fienberg et al., 2011; Wang et al., 2015).
In principle, these sensitivities are in O(1) with respect to
N assuming N0 ≃

N1.

3.3. Input Perturbation Method

Given a contingency table, the input perturbation method
ﬁrst randomizes each cell of the contingency table indepen-
dently as2 ˆcpq = cpq + Lap( 2
ϵ ), and then evaluates the test
statistic with the randomized table (Johnson & Shmatikov,
2013). After randomization, each cell can take a nega-
tive value. (Barak et al., 2007; Li et al., 2010; Hardt et al.,
2012; Li & Miklau, 2012; Gaboardi et al., 2014) have sug-
gested methods of calculating a differentially private con-
tingency table while avoiding this problem. For indepen-
dence testing, (Gaboardi et al., 2016) modiﬁed the contin-
gency table by using the work of (Lee et al., 2015) based
on constraint optimization problem so that the total num-
ber of the samples is N and each cell has a positive value.
The DP of the test statistic is readily ensured because of
the post-processing theorem. In input perturbation, given
N1, (Gaboardi et al., 2016) and (Wang et al., 2015)
N0 ≃
reported by experiments that the accuracy of the test results
can be improved when the number of samples increases.

3.4. Signiﬁcance Level of DP χ2 Test

The threshold for non-privacy-preserving χ2 test is deter-
mined based on the fact that χ2(S) follows the χ2 dis-
χ2(S)
tribution asymptotically when H holds. However,
does not follow the χ2 distribution anymore, even when
H holds. For the randomization mechanism to keep the
type-I error α, the threshold τα needs to be adjusted so that
H0 is true] holds. Letting
α = Pr[
(1) denote
χ2(S) follows, then ˆτα is determined

χ2

#

χ2(S) > ˆτα|
the distribution that
#
so that
∞
˜τα

χ2
(1)(z)dz = α.

&

"

&

For the input perturbation case, (Uhler et al., 2013) demon-
strated that the test static arising from randomized cell
counts asymptotically approximates the χ2 distribution.
However, the sample distribution can deviate considerably
from the χ2 distribution when the sample size is small. A
study by (Gaboardi et al., 2016) also proved that the ex-

#

2When one can assume that the marginal of the table (N0 and
N1) is known publicly, the global sensitivity of the count query is
1.

Differentially Private Chi-squared Test by Unit Circle Mechanism

χ2(S) generated by input perturbation is bi-
pectation of
ased. (Gaboardi et al., 2016) and (Wang et al., 2015) inde-
pendently presented methods to correct the bias by adjust-
ing the threshold, respectively using Monte Carlo sampling
and a permutation test.

!

For the output perturbation case, (Uhler et al., 2013) de-
rived a distribution of perturbed χ2 statistic when the test
statistic is randomized with the Laplace distribution.
In
this case, the threshold can be adjusted accurately using
the derived distribution. Although not described in the
literature above speciﬁcally, the threshold for test statis-
tics generated by output perturbation can be adjusted using
Monte Carlo sampling in a method similar to one reported
in (Gaboardi et al., 2016).

4. Power of DP χ2 Test

The type-I error can be correctly controlled by adjusting the
threshold appropriately as discussed in Section 3.4 whereas
theoretical analysis on the power has never been intensively
investigated in existing works. For the power analysis, we
derive the following upper bound.
Theorem 2. Let βτ denote the type-II error when one use
threshold τ for the (non-privacy-preserving) χ2 test. Let
be the set of distributions of sample
be a differentially private mechanism for χ2
that is determined
becomes α. Then for any

=
P
sets. Let
test and ˆτα >τ α be the threshold for
so that the type-I error of
γ> 0, the upper bound of the type-II error of

P : H1is true
{

M

M

M

is

}

M

Pr[

M

H1 is true]

(S, ˆτα) = acc
|
(S, ˆτα) = acc

[

≤

sup
P
∈P"

Pr
P
S
∼

M

|

χ2(S) > ˆτα +γ]+βˆτα+γ

.
#

The proof is shown in Appendix B. The upper bound con-
sists of the probability term and the type-II error term. We
discuss the behavior of these terms w.r.t. N .

The ﬁrst probability term represents the probability that the
privacy mechanism accepts the null hypothesis when the
non-privacy-preserving test rejects it with threshold ˆτα + γ.
For notational simplicity, we call the probability term the γ
error:

E(ˆτα,γ,
Pr
sup
P
S
P
∼

∈P

) =
(S, ˆτα) = acc
|

M
[

M

χ2(S) > ˆτα + γ].

The γ error measures how often the mechanism wrongly
rejects the null hypothesis. The γ error thus depends on the
mechanism
. The analysis of this term will be discussed
M
in the next subsection again.

The second term βˆτα+γ is the type-II error of non-privacy-
preserving test with threshold ˆτα + γ, which depends on

the mechanism, too. This term becomes smaller if ˆτα is
χ2(S)
closer to τα. This occurs when the distribution of
is close to the distribution of χ2(S). In the case of out-
put perturbation, this happens when the sensitivity of the
mechanism decreases faster w.r.t. N . Thus, ﬁxing sample
size N , a greater power would be realized by employing a
mechanism with a low sensitivity .

!

4.1. Power Analysis of Output Perturbation

First, we discuss the γ error of output perturbation.
M∆ be a ϵ-differentially private mecha-
Theorem 3. Let
nism of output perturbation with sensitivity ∆. Then, the γ
error is upper bounded by 1

−

2 exp

γϵ
∆

.
%

$

The proof is shown in Appendix C. Substituting the sen-
sitivity derived in Eq.3 to this bound, we can conﬁrm that
the γ error of the mechanism of (Yu et al., 2014) is O(1) in
terms of N . The same conclusion is derived from the mech-
anisms of (Fienberg et al., 2011) and (Wang et al., 2015).
The sensitivities employed by these mechanisms are also
O(1). A mechanism with a lower γ error and a lower sen-
sitivity is needed to achieve greater power with ensuring
DP.

4.2. Power Analysis of Input Perturbation

In the input perturbation method, randomization is applied
to each cell. So the analysis of the γ error and the sen-
sitivity cannot be appropriately derived. Because of this
difﬁculty of analysis, we will evaluate the power of input
perturbation numerically in Section 7.

5. Unit Circle Mechanism

This section introduces a variant of output perturbation:
the unit circle mechanism. This section ﬁrst investigates
the geometrical property. Then a novel mechanism is de-
signed based on the property. We also show that the γ er-
ror and the sensitivity asymptotically vanish in the limit
of N . Because of this property, the proposed mechanism
achieves better power compared to existing output pertur-
bation mechanisms.

5.1. Geometrical Interpretation of χ2 Test

Given (c11, c10) and the marginals N0 and N1 in Table 1,
the test statistic of Eq. 2 is represented as

χ2(c11, c10) =

(c11N0 −
(c11 + c10)(N
−

c10N1)2N
c11 −

c10)N1N0

.

(4)

Letting χ2(c11, c10) = τα and rearranging Eq. 4 with re-
spect to c11 and c10, we have a quadratic form. The follow-
ing lemma provides a geometrical interpretation of the test

Differentially Private Chi-squared Test by Unit Circle Mechanism

0
0
1
1
c
c

0
0
0
0
0
0
1
1
1

0
0
0
6
6
6

0
0
0
2
2
2

0
0
0

0
0
1
1
c
c

3
3
3

2
2
2

1
1
1

1
1
1
−
−
−

3
3
3
−
−
−

0
0
0

100
100
100

50
50
50

c11
c11

(a) Before trans.

−4
−4
−4

−2
−2
−2

0
0
0

2
2
2

4
4
4

c11
c11

(b) After trans.

Figure1. Plot of contingency tables on the (c11, c10)-plane before
and after transformation. Circles and triangles respectively denote
contingency tables with which the null hypothesis is rejected and
accepted.

statistic of χ2-test on the (c11, c10)-plane.
Lemma 1. Given τα > 0, for any N1 > 0, N0 > 0,
and N > 0, χ2(c11, c10) = τα forms an ellipse on the
(c11, c10)-plane.

The proof is presented in Appendix D. Recall that the null
hypothesis is rejected at signiﬁcance level α if χ2(S) >τ α.
Using this, we can infer the following theorem.
Theorem 4. Given Table 1 speciﬁed by S and a threshold
τα > 0, H0 is rejected if and only if (c11, c10) exists outside
of the ellipse χ2(c11, c10) = τα.

The proof, although it might be readily apparent, is omit-
ted here. Figure 1(a) present plots of contingency tables
with the ellipse. For the convenience of theoretical analy-
sis, we introduce an afﬁne transformation V , which trans-
forms the ellipse to the unit circle. The formulation of the
afﬁne transformation V is shown in Appendix E.

||

V ((c11, c10)t)

Using this transformation, χ2 test can be conducted by us-
||2 as the test statistic.
ing
Theorem 5. Given Table 1 speciﬁed by S and a threshold
V ((c11, c10)t)
τα > 0, H0 is rejected if and only if
||2 > 1,
i.e., V ((c11, c10)t) exists outside of the unit circle.

||

The proof is presented in the Appendix F. Figure. 1(b)
presents the plot of contingency tables and the ellipse af-
ter transformation.

T ((c11, c10)t)

||

||2 is given as
(N 2

∆V,α(N0, N1) = 2

0 + N 2

1 )N + 2ταN0N1

.

(5)

!

ταN0N1N 2

The proof is presented in the Appendix G. This sensitivity
analysis immediately derives the following Laplace mech-
anism:

||

).

(6)

ˆd(S) =

∆V,α(N0, N1)
ϵ

Vτα((c11, c10)t)

||2 + Lap(
The mechanism releasing ˆd(S) ensures ϵ-DP whereas, as
we already discussed in Section 3.4, if we use ˆd(S) as the
test statistic, the type-I error cannot be properly controlled.
To maintain type-I error as α or less, we want ˆd(S) < 1 to
hold with the probability of at least 1
α if H0 holds. To
attain this state, we propose the unit circle mechanism in
Algorithm 1 that controls the type-I error by generating the
ﬁnite sample distribution of ˆd(S) with Monte-Carlo sam-
pling. At line 2, the randomized test statistics is evaluated.
The for-loop starting from line 4 generates the sample dis-
tribution of the randomized test statistics when the null hy-
pothesis is true. At line 8, the p-value of S is evaluated with
the sample distribution. The null hypothesis is rejected at
line 10 if the p-value is less than the signiﬁcance level.
Theorem 6. Algorithm 1 ensures ϵ-DP.

−

If marginals M0, M1, N0, N1 are public, then computation
with Sk does not consume the privacy budget because Sk
are samples that are artiﬁcially generated using the distribu-
tion speciﬁed by the public marginals. All operations after
line 2 are attributable to post processing and therefore do
not consume the privacy budget. Consequently, the privacy
budget is consumed at line 2 only. Thus, the proof is imme-
diately obtained by the privacy guarantee of the mechanism
based on the global sensitivity(Dwork et al., 2006).

5.3. Utility Analysis of Unit Circle Mechanism

From the discussion in Section 4, the power of test mecha-
nisms can be investigated by analyzing the γ error and the
sensitivity. The γ error of Algorithm 1 is obtained using
the following theorem.
Theorem 7. The γ error of Algorithm 1 is

5.2. Privacy Analysis of Unit Circle Mechanism

E( ˆτα,γ, M ∆V,α (N0,N1))

The input perturbation ensures DP by randomizing c10
and c11 independently by the Laplace or Gaussian mech-
anism.
In the unit circle view, equivalent results are
obtainable by randomizing the distance from the origin,
V ((c11, c10)t)
||2, and judging whether the randomized
||
distance is greater than 1 or not. The global sensitivity of
V ((c11, c10)t)
||2 is derived as described below.
||
V ((c11, c10)t)
||2). Given Table
Lemma 2 (Sensitivity of
1 speciﬁed by S and threshold τα > 0, the sensitivity of

||

1
2

exp

ϵN
2

"

≤

·!

(N 2

1 + N 2

4γM1M0
ˆταN 2

1 +

1
− $
#
ˆταN1N0
0 )N + 2 ˆταN1N0 &

.

%

(7)

is

7 is
The proof
shown in Appendix H. Eq.
√N )), and asymptotically vanishing as the sam-
O(exp(
ple size increases. Furthermore, the sensitivity of the unit

−

Differentially Private Chi-squared Test by Unit Circle Mechanism

Algorithm 1 Unit Circle Mechanism
Require: Sample set S, sig level α, privacy budget ϵ
1: Evaluate contingency table from S
2: ˆd(S) =
V ((c11, c10)t)
||
3: for k = 1 to m do
mult( N1M1
4:
N 2
5:

Sk
Evaluate contingency table from Sk
ˆd(Sk) =
11, ck

||2 + Lap( ∆V,α (N0,N1)

||2 + Lap( ∆V,α (N k

, N0M0
N 2 )

, N0M1
N 2

, N1M0
N 2

V ((ck

10)t)

∼

)

ϵ

ϵ

0 ,N k
1 )

)

ˆd(S)

}|

6:
||
7: end for
i: ˆd(S)k
8: p = |{
≥
m
9: if p <α then
Return rej
10:
11: else
12:
13: end if

Return acc

circle mechanism is O( 1
) as derived from Eq. 5. Thus,
√N
from the discussion in Section 4, the upper bound of the
type-II error of Algorithm 1 is expected to decrease with a
faster rate than existing output perturbation method.

6. Differentially Private Multiple χ2-test

Presume that we are interested in the independence be-
tween random variables X0 and other K random variables,
X1, X2, . . . , XK. The objective is investigation of the in-
dependence between X0 and Xk for k = 1, . . . , K. We
denote the null hypothesis that X0 and Xk are independent
by H k
0 . The test statistic for independence between X0 and
Xk is calculated with the set of samples Sk. We suppose
N0, N1, and N are the same for all Sk. We can verify the
independence of each random variable pair by evaluating
Eq. 2 with Sk for k = 1, . . . , K in turn. In multiple hy-
pothesis testing, we consider to control the familywise er-
ror rate (FWER), the probability that the null hypothesis
is rejected mistakenly at least once among K tests. If the
signiﬁcance of each test is kept 1- α, the FWER of the K
tests in this setting is given as 1
αK, which
increases as K increases. We use Bonferroni correction to
correct the signiﬁcance level so that the FWER for the en-
tire test set is kept less than α (Bonferroni, 1936).

α)K

(1

−

−

≃

We can realize DP multiple χ2-test using the DP χ2 test
mechanisms repeatedly. However, the privacy guarantee
weakens as the number of hypothesis K increases by The-
orem 1. (Fienberg et al., 2011) presented a multiple test-
ing procedure using output perturbation. This method con-
sumes a privacy budget that is proportional to K, which
makes it almost impossible to obtain useful results under
(Johnson & Shmatikov,
a meaningful privacy guarantee.
2013; Yu et al., 2014; Simmons & Berger, 2016) pre-
sented a method which outputs the top s1 signiﬁcant
random variable pairs using the exponential mechanism

(McSherry & Talwar, 2007). This method outputs s1 pairs
For that reason,
even if all pairs are not signiﬁcant.
naive application of exponential mechanism cannot control
FWER.

In this section, we provide two differentially private mul-
tiple hypothesis testing methods that can conserve the pri-
vacy budget even with large K and controls FWER prop-
erly. The exponential mechanism based procedure works in
the non-interactive setting, in which the set of hypotheses
considered needs to be prescribed before starting the test-
ing procedure. The SVT based procedure works in the in-
teractive setting (Lyu et al., 2017), in which the hypothesis
to be considered at each round can be interactively chosen
after observing the result of the tests in the previous rounds
(Webb & Petitjean, 2016).

6.1. Unit Circle Mechanism + SVT

that

We ﬁrst show the SVT-based procedure with the unit
circle mechanism (UCM+SVT). Recall
the unit
circle mechanism veriﬁes the result by checking if
V ((c11, c10)t)
||2 > 1. Also, provided all the marginals
||
are public information and N0 and N1 are the same for all
V ((c11, c10)t)
Sk, the sensitivity of
||2 is the same for any
contingency table. Thus, the unit circle mechanism can be
naturally incorporated into SVT.

||

Application of the unit circle mechanism (i.e., threshold-
ing by Eq. 6) to SVT immediately guarantees differential
privacy. However, the type-I error cannot be properly con-
trolled by the naive combination. Recall that SVT adds
noise to the threshold to compare in Eq. 1. In order to con-
trol the type-I error, the threshold of SVT should be prop-
erly adjusted considering the effect of the additive noise.
We employ Monte Carlo sampling to determine the thresh-
old that properly controls the type-I error. Also, we use
Bonferoni correction to control the FWER.

, SK ，

· · ·

The UCM+SVT takes as input sample sets S1,
the signiﬁcance level α, the privacy budget ϵ, and stop pa-
s2. The UCN+SVT is terminated if (1) it
rameters s1 ≤
rejects at most s1 null hypotheses, or (2) it outputs s2 test
results. Here, we remark the stop parameter s2 is not used
in the regular SVT. In our setting, we need to apply Bonfer-
roni correction to control the FWER. We thus use s2 to up-
per bound the maximum number of hypotheses considered.
The settings and the algorithm are detailed in Appendix I.

In the experimental results of single hypothesis test in Sec-
tion 7, input perturbation+MC also achieves good perfor-
mance. However, when input perturbation is used, the sen-
sitivity of the test statistic is not uniform and thus it cannot
be used with SVT.

Differentially Private Chi-squared Test by Unit Circle Mechanism

6.2. Unit Circle Mechanism + EM

at 0.95 for any sample size (Figure 2(d)-2(f)).

We introduce another DP multiple test procedure using the
exponential mechanism (UCM+EM). By simple applica-
tion of the exponential mechanism, we can get the top s1
signiﬁcant random variable pairs. However, this method
outputs s1 pairs even if all pairs are not signiﬁcant. For
that reason, it cannot control FWER. By adding s1 signif-
icant dummy pairs of random variables, we can avoid ac-
cepting non-signiﬁcant random variable pairs. However,
this method does not necessarily control FWER properly
because we cannot add appropriate dummy pairs to con-
trol FWER without knowing the scores related the p-values
of non-signiﬁcant pairs. In order to control FWER prop-
erly, we can use the exponential mechanism to select can-
didate pairs, and then apply the unit circle mechanism to
the candidate pairs so that the signiﬁcance level of each
test is properly controlled. The settings and the algorithm
is detailed in Appendix J.

7. Experiment

7.1. Experiments for Single Testing

In this section, we evaluate the signiﬁcance and the
power of the respective mechanisms,
input perturba-
tion (Gaboardi et al., 2016), output perturbation (Yu et al.,
2014), and unit circle mechanism for single hypothesis
testing. Both the output perturbation and the unit cir-
cle mechanism use N1 and N0 as public information. If
these are public, the sensitivity of the input perturbation
can be made 1. For controlling the signiﬁcance of input
perturbation, we use MCIndepLap with the Laplace distri-
bution in (Gaboardi et al., 2016). The signiﬁcance of the
unit circle mechanism and output perturbation is controlled
by adjusting τα by Monte Carlo sampling. For Monte
Carlo sampling, we set the number of sampling as 1000
for MCIndepLap with the laplace distribution, and 10000
for the other methods. For output perturbation, we used the
sensitivity derived in Eq.3.

Signiﬁcance. To evaluate the signiﬁcance, we sample
1000 contingency tables from mult(0.25, 0.25, 0.25, 0.25)
so that H0 is true. mult(
) denotes the multinomial
,
·
·
distribution. Then, we assess the proportion that the mech-
anism outputs acc correctly. We set the privacy parameter
as ϵ = 0.1 and signiﬁcance level as α = 0.05.

·

·

,

,

In Figure 2, the signiﬁcance of mechanisms are shown. If
Monte Carlo sampling is not used (Figure 2(a)-2(c)), the
signiﬁcance remains poor for small samples. The signif-
icance of output perturbation unchanged even when the
sample size increases. However, the input perturbation and
the unit circle mechanism improve the signiﬁcance as the
sample size increases. The controlled signiﬁcance version
of these mechanisms can properly control the signiﬁcance

Power. Evaluation of the power of the respective mech-
anisms controlling signiﬁcance is presented. We sample
1000 contingency tables from mult(0.25 + 0.01, 0.25
−
0.01, 0.25 + 0.01) so that H1 is true. To eval-
0.01, 0.25
uate the power, we assess the rate at which the mechanism
outputs rej correctly when H1 is true. We set the privacy
parameter ϵ = 0.1 and signiﬁcance level α = 0.05.

−

Figure 3 shows that the unit circle mechanism with Monte
Carlo sampling (UCM+MC) has similar power to that
of the input perturbation with Monte Carlo sampling
(IP+MC). In addition, compared with output perturbation
with Monte Carlo sampling (OP+MC), UCM+MC quickly
improves the power as the number of samples increases.

The γ-error of UCM+MC can be analyzed as discussed in
Section 3.4. UCM+MC has a faster rate of the power than
OP+MC because the γ-error of the UCM+MC decreases as
the sample size increases. Unlike the UCM/OP+MC, the γ-
error of IP+MC has never been analyzed. The UCM+MC
is thus advantageous compared with the IP+MC in that the
upper bound of type-II error is analyzed by Theorem 2. We
remark that, looking at the results of the power, IP+MC
and UCM+MC might have the same the γ-error rate. The
analysis of IP+MC remains as future work.

7.2. Experiments for Multiple Testing

In this subsection, we experimentally evaluate FWER and
utility of UCM+SVT and UCM+EM.

FWER. FWER can be properly controlled if the signiﬁ-
cance for a single test is exactly adjusted to α by using
the Bonferroni correction. In UCM+EM, the signiﬁcance
of each test perfomed by UCM is properly controlled with
a sufﬁciently large number of Monte Carlo samples. We
can thus guarantee that FWER is properly controlled by ap-
plying Bonferroni correction. Since we can conﬁrme this
from Fig. 2, we skip experimental evaluation of the sig-
niﬁcance of UCM+EM. Similarly, UCM+SVT is expected
to properly control FWER with a sufﬁciently large number
of Monte Carlo samples. To conﬁrm this, we evaluate the
FWER of UCM+SVT experimentally.

In order to evaluate the FWER of UCM+SVT, all sam-
ples must be drawn from the null distribution. We
artiﬁcially generated samples for evaluation in the fol-
lowing manner. We generated 1000 sample sets from
mult(0.25, 0.25, 0.25, 0.25) so that H0 is true. Then, we
assess the rate at which UCM+SVT outputs acc correctly.
We set the privacy parameter as ϵ = 0.1 and the signiﬁ-
cance level as α = 0.05. We set the stop parameters as
α
s1 = 1 and s2 = 1, and evaluate the signiﬁcance 1
for a single test instead of FWER. Note that we can control
FWER by Bonferroni correction for multiple tests if the

−

Differentially Private Chi-squared Test by Unit Circle Mechanism

(a) Input perturbation

(b) Output Perturbation

(c) UC Mechanism

(d) Input perturbation + MC

(e) Output Perturbation+MC

(f) UC Mechanism +MC

Figure2. Plot of signiﬁcance. The signiﬁcance becomes 0.95 if properly controled.

2 , N k

2 , M k

2 , M k

0 = N

0 = N

1 = N

For evaluation, we artiﬁcially generated K = 10 sam-
ple sets in the following method. We ﬁx the marginals
1 = N
N k
2 , and then
create the sample sets S1, . . . , SK so that the test statis-
tics of the resulting sample sets become χ2(Sk)
∈
1, 1, 1, 1, 1, 1, 1, 1, 30, 30
. Two of them reject the cor-
{
}
responding null hypotheses at signiﬁcance level α = 0.05
after Bonferroni correction (i.e., χ2(Sk) = 30). Regarding
the remaining eight sample sets, the corresponding null hy-
potheses are accepted. We input Sk to the algorithms, and
then evaluate the utility. For utility measure, we employ the
correctness r
, where r is the number that the algorithm
r′
outputs rej correctly; r′ is the number of the contingency
tables rejected by non-private multiple χ2 tests with Bon-
ferroni correction. In our artiﬁcially generated sample sets,
r′ = 2. For UCM+SVT, we input the sample sets in a ran-
dom order. We set the privacy parameter as ϵ =
0.1, 0.5
,
}
{
the signiﬁcance levels as α = 0.05, and the stop parameters
as s1 = 2, s2 = 10.

Figure 5 shows the correctness (average of 100 trials) of
each algorithm with respect to the sample size. As we see
from the ﬁgure, the correctness of UCM+SVT approaches
to 1 when N increases while the correctness of OP+SVT
does not. This is because the sensitivity of the unit circle
mechanism decreases faster than that of output perturba-
tion with respect to the sample size. Both UCM+EM and
IP+EM have the comparable correctness. We remark that
UCM is advantageous compared to IP in the sense that the
type-II error of UCM is upper-bounded as we discuss in
Section 5, while no theoretical guarantee on the type-II er-
ror of input perturbation is provided.

The algorithms using EM achieves better correctness than
the algorithms using SVT. This difference of the correct-
ness comes from the settings that SVT and EM can handle.
As we discussed in Section 6, SVT can deal with the in-
teractive setting whereas EM considers the non-interactive
setting only. In this sense, the results of these two proce-
dures are not directly comparable.

Figure3. Change of the power with respect to the sample size N .

Figure4. plot of FWER.

Figure5. Plot of the correct rate.

mechanism can guarantee the signiﬁcance of a single test.
Also, we remark that this does not mean that our mecha-
nism cannot work with multiple sample sets.

Figure 4 shows the signiﬁcance level of UCM+SVT when
the sample size is changed. As we can see from the ﬁgure,
UCM+SVT can control the signiﬁcance at the prescribed
level (0.95) for any sample size.

Utility. Next, we compare the utility of UCM+SVT and
UCM+EM with existing methods. We denote the SVT with
the output perturbation by OP+SVT, the EM with the in-
put perturbation by IP+EM. We compare the correctness of
these algorithms with respect to the sample size.

Differentially Private Chi-squared Test by Unit Circle Mechanism

Acknowledgement

We thank anonymous reviewers for insightful reviews and
discussions. We appreciate that one of the reviewers gives
an important suggestion regarding the combination of the
unit circle mechanism and exponential mechanism. We
thank Prof. Hideitsu Hino and Dr. Masayuki Terada for
important comments that greatly improved the manuscript.
The research is partly supported by JST CREST Grant
Number JPMJCR1302 and JSPS Grand-in-Aid for Scien-
tiﬁc Research No. 16H02864.

References

Barak, Boaz, Chaudhuri, Kamalika, Dwork, Cynthia, Kale,
Satyen, McSherry, Frank, and Talwar, Kunal. Privacy,
accuracy, and consistency too: a holistic solution to con-
tingency table release. In Proceedings of the twenty-sixth
ACM SIGMOD-SIGACT-SIGART symposium on Princi-
ples of database systems, pp. 273–282, 2007.

Bishop, Yvonne M.M, Fienberg, Stephen E, and Holland,
Paul W. Discrete multivariate analysis: Theory and prac-
tice. 1975.

Bonferroni, C.E. Teoria statistica delle classi e calcolo
delle probabilit`a. Pubblicazioni del R. Istituto superiore
di scienze economiche e commerciali di Firenze. Libre-
ria internazionale Seeber, 1936.

Cai, Bryan, Daskalakis, Constantinos, and Kamath, Gau-
tam. Priv’it: Private and sample efﬁcient identity testing.
In Proceedings of The 34rd International Conference on
Machine Learning, pp. to appear, 2017.

Dwork, Cynthia and Roth, Aaron. The algorithmic founda-
tions of differential privacy. Foundations and Trends in
Theoretical Computer Science, 9(3-4):211–407, 2014.

Dwork, Cynthia, McSherry, Frank, Nissim, Kobbi, and
Smith, Adam. Calibrating noise to sensitivity in private
data analysis. In Proceedings of the Third Conference on
Theory of Cryptography, pp. 265–284, 2006.

Fienberg, Stephen E., Slavkovic, Aleksandra, and Uhler,
Caroline. Privacy preserving gwas data sharing. In Pro-
ceedings of the 2011 IEEE 11th International Confer-
ence on Data Mining Workshops, pp. 628–635, 2011.

Gaboardi, Marco, Arias, Emilio Jes´us Gallego, Hsu, Justin,
Roth, Aaron, and Wu, Zhiwei Steven. Dual query: Prac-
tical private query release for high dimensional data. In
Proceedings of The 31rd International Conference on
Machine Learning, pp. 1170–1178, 2014.

Gaboardi, Marco, Lim, Hyun, Rogers, Ryan, and Vadhan,
Salil. Differentially private chi-squared hypothesis test-

ing: Goodness of ﬁt and independence testing. In Pro-
ceedings of The 33rd International Conference on Ma-
chine Learning, pp. 2111–2120, 2016.

Hardt, Moritz, Ligett, Katrina, and McSherry, Frank. A
simple and practical algorithm for differentially private
In Advances in Neural Information Pro-
data release.
cessing Systems 25, pp. 2339–2347, 2012.

Homer, Nils, Szelinger, Szabolcs, Redman, Margot, Dug-
gan, David, Tembe, Waibhav, Muehling, Jill, Pearson,
John V, Stephan, Dietrich A, Nelson, Stanley F, and
Craig, David W. Resolving individuals contributing trace
amounts of dna to highly complex mixtures using high-
density snp genotyping microarrays. PLoS genetics, 4
(8):e1000167, 2008.

Johnson, Aaron and Shmatikov, Vitaly. Privacy-preserving
data exploration in genome-wide association studies. In
Proceedings of the 19th ACM SIGKDD International
Conference on Knowledge Discovery and Data Mining,
pp. 1079–1087, 2013.

Lee, Jaewoo, Wang, Yue, and Kifer, Daniel. Maximum
likelihood postprocessing for differential privacy under
consistency constraints. In Proceedings of the 21th ACM
SIGKDD International Conference on Knowledge Dis-
covery and Data Mining, pp. 635–644, 2015.

Li, Chao and Miklau, Gerome. An adaptive mechanism
for accurate query answering under differential privacy.
In Proceedings of the VLDB Endowment, volume 5, pp.
514–525, 2012.

Li, Chao, Hay, Michael, Rastogi, Vibhor, Miklau, Gerome,
and McGregor, Andrew. Optimizing linear counting
In Proceedings of
queries under differential privacy.
the twenty-ninth ACM SIGMOD-SIGACT-SIGART sym-
posium on Principles of database systems, pp. 123–134,
2010.

Lyu, Min, Su, Dong, and Li, Ninghui. Understanding the
sparse vector technique for differential privacy. In Pro-
ceedings of the VLDB Endowment, volume 10, pp. 637–
648, 2017.

McSherry, Frank and Talwar, Kunal. Mechanism design via
differential privacy. In Proceedings of the 48th Annual
IEEE Symposium on Foundations of Computer Science,
pp. 94–103, 2007.

Simmons, Sean and Berger, Bonnie. Realizing privacy pre-
serving genome-wide association studies. Bioinformat-
ics, 32(9):1293–1300, 2016.

Uhler, Caroline, Slavkovi´c, Aleksandra, and Fienberg,
Stephen E. Privacy-preserving data sharing for genome-
wide association studies. The Journal of privacy and
conﬁdentiality, 5(1):137, 2013.

Differentially Private Chi-squared Test by Unit Circle Mechanism

Wang, Yue, Lee, Jaewoo, and Kifer, Daniel. Differen-
tially private hypothesis testing, revisited. arXiv preprint
arXiv:1511.03376, 2015.

Webb, Geoffrey I and Petitjean, Franc¸ois. A multiple test
correction for streams and cascades of statistical hypoth-
In Proceedings of the 22nd ACM SIGKDD
esis tests.
International Conference on Knowledge Discovery and
Data Mining, pp. 1255–1264, 2016.

Yu, Fei, Fienberg, Stephen E, Slavkovi´c, Aleksandra B, and
Uhler, Caroline. Scalable privacy-preserving data shar-
ing methodology for genome-wide association studies.
Journal of biomedical informatics, 50:133–141, 2014.

