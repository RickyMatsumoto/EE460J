SupplementaryMaterialsfor:OnCalibrationofModernNeuralNetworksS1.FurtherInformationonCalibrationMetricsWecanconnecttheECEmetricwithourexactmiscalibra-tiondeﬁnition,whichisrestatedhere:EˆPh(cid:12)(cid:12)(cid:12)P(cid:16)ˆY=Y|ˆP=p(cid:17)−p(cid:12)(cid:12)(cid:12)iLetFˆP(p)bethecumulativedistributionfunctionofˆPsothatFˆP(b)−FˆP(a)=P(ˆP∈[a,b]).UsingtheRiemann-StieltjesintegralwehaveEˆPh(cid:12)(cid:12)(cid:12)P(cid:16)ˆY=Y|ˆP=p(cid:17)−p(cid:12)(cid:12)(cid:12)i=Z10(cid:12)(cid:12)(cid:12)P(cid:16)ˆY=Y|ˆP=p(cid:17)−p(cid:12)(cid:12)(cid:12)dFˆP(p)≈MXm=1(cid:12)(cid:12)(cid:12)P(ˆY=Y|ˆP=pm)−pm(cid:12)(cid:12)(cid:12)P(ˆP∈Im)whereImrepresentstheintervalofbinBm.(cid:12)(cid:12)(cid:12)P(ˆY=Y|ˆP=pm)−pm(cid:12)(cid:12)(cid:12)iscloselyapproximatedby|acc(Bm)−ˆp(Bm)|fornlarge.HenceECEusingMbinsconvergestotheM-termRiemann-StieltjessumofEˆPh(cid:12)(cid:12)(cid:12)P(cid:16)ˆY=Y|ˆP=p(cid:17)−p(cid:12)(cid:12)(cid:12)i.S2.FurtherInformationonTemperatureScalingHerewederivethetemperaturescalingmodelusingtheen-tropymaximizationprinciplewithanappropriatebalancedequation.Claim1.Givennsamples’logitvectorsz1,...,znandclasslabelsy1,...,yn,temperaturescalingistheuniquesolutionqtothefollowingentropymaximizationproblem:maxq−nXi=1KXk=1q(zi)(k)logq(zi)(k)subjecttoq(zi)(k)≥0∀i,kKXk=1q(zi)(k)=1∀inXi=1z(yi)i=nXi=1KXk=1z(k)iq(zi)(k).Theﬁrsttwoconstraintensurethatqisaprobabilitydis-tribution,whilethelastconstraintlimitsthescopeofdistri-butions.Intuitively,theconstraintspeciﬁesthattheaveragetrueclasslogitisequaltotheaverageweightedlogit.Proof.Wesolvethisconstrainedoptimizationproblemus-ingtheLagrangian.Weﬁrstignoretheconstraintq(zi)(k)andlatershowthatthesolutionsatisﬁesthiscondition.Letλ,β1,...,βn∈RbetheLagrangianmultipliersanddeﬁneL=−nXi=1KXk=1q(zi)(k)logq(zi)(k)+λnXi=1"KXk=1z(k)iq(zi)(k)−z(yi)i#+nXi=1βiKXk=1(q(zi)(k)−1).Takingthederivativewithrespecttoq(zi)(k)gives∂∂q(zi)(k)L=−nK−logq(zi)(k)+λz(k)i+βi.SettingthegradientoftheLagrangianLto0andrearrang-inggivesq(zi)(k)=eλz(k)i+βi−nK.SincePKk=1q(zi)(k)=1foralli,wemusthaveq(zi)(k)=eλz(k)iPKj=1eλz(j)i,whichrecoversthetemperaturescalingmodelbysettingT=1λ.FigureS1visualizesClaim1.Weseethat,astrainingcon-tinues,themodelbeginstooverﬁtwithrespecttoNLL(redline).Thisresultsinalow-entropysoftmaxdistributionoverclasses(blueline),whichexplainsthemodel’sover-conﬁdence.TemperaturescalingnotonlylowerstheNLLbutalsoraisestheentropyofthedistribution(greenline).S3.AdditionalTablesTablesS1,S2,andS3displaytheMCE,testerror,andNLLforalltheexperimentalsettingsoutlinedinSection5.SupplementaryMaterials:OnCalibrationofModernNeuralNetworks01002003004005000.511.522.533.5EpochEntropy / NLL / TEntropy vs. NLL on CIFAR−100  Entropy & NLL after CalibrationEntropy before CalibrationNLL before CalibrationOptimal T SelectedFigureS1.EntropyandNLLforCIFAR-100beforeandaftercalibration.TheoptimalTselectedbytemperaturescalingrisesthroughoutoptimization,asthepre-calibrationentropydecreasessteadily.Thepost-calibrationentropyandNLLonthevalidationsetcoincide(whichcanbederivedfromthegradientoptimalityconditionofT).DatasetModelUncalibratedHist.BinningIsotonicBBQTemp.ScalingVectorScalingMatrixScalingBirdsResNet5030.06%25.35%16.59%11.72%9.08%9.81%38.67%CarsResNet5041.55%5.16%15.23%9.31%20.23%8.59%29.65%CIFAR-10ResNet11033.78%26.87%7.8%72.64%8.56%27.39%22.89%CIFAR-10ResNet110(SD)34.52%17.0%16.45%19.26%15.45%15.55%10.74%CIFAR-10WideResNet3227.97%12.19%6.19%9.22%9.11%4.43%9.65%CIFAR-10DenseNet4022.44%7.77%19.54%14.57%4.58%3.17%4.36%CIFAR-10LeNet58.02%16.49%18.34%82.35%5.14%19.39%16.89%CIFAR-100ResNet11035.5%7.03%10.36%10.9%4.74%2.5%45.62%CIFAR-100ResNet110(SD)26.42%9.12%10.95%9.12%8.85%8.85%35.6%CIFAR-100WideResNet3233.11%6.22%14.87%11.88%5.33%6.31%44.73%CIFAR-100DenseNet4021.52%9.36%10.59%8.67%19.4%8.82%38.64%CIFAR-100LeNet510.25%18.61%3.64%9.96%5.22%8.65%18.77%ImageNetDenseNet16114.07%13.14%11.57%10.96%12.29%9.61%-ImageNetResNet15212.2%14.57%8.74%8.85%12.29%9.61%-SVHNResNet152(SD)19.36%11.16%18.67%9.09%18.05%30.78%18.76%20NewsDAN317.03%10.47%9.13%6.28%8.21%8.24%17.43%ReutersDAN314.01%16.78%44.95%36.18%25.46%18.88%19.39%SSTBinaryTreeLSTM21.66%3.22%13.91%36.43%6.03%6.03%6.03%SSTFineGrainedTreeLSTM27.85%28.35%19.0%8.67%44.75%11.47%11.78%TableS1.MCE(%)(withM=15bins)onstandardvisionandNLPdatasetsbeforecalibrationandwithvariouscalibrationmethods.Thenumberfollowingamodel’snamedenotesthenetworkdepth.MCEseemsverysensitivetothebinningschemeandislesssuitedforsmalltestsets.S4.AdditionalReliabilityDiagramsWeincludereliabilitydiagramsforadditionaldatasets:CIFAR-10(FigureS2)andSST(FigureS3andFigureS4).Notethat,asmentionedinSection2,thereliabilitydia-gramsdonotrepresenttheproportionofpredictionsthatbelongtoagivenbin.SupplementaryMaterials:OnCalibrationofModernNeuralNetworksDatasetModelUncalibratedHist.BinningIsotonicBBQTemp.ScalingVectorScalingMatrixScalingBirdsResNet5022.54%55.02%23.37%37.76%22.54%22.99%29.51%CarsResNet5014.28%16.24%14.9%19.25%14.28%14.15%17.98%CIFAR-10ResNet1106.21%6.45%6.36%6.25%6.21%6.37%6.42%CIFAR-10ResNet110(SD)5.64%5.59%5.62%5.55%5.64%5.62%5.69%CIFAR-10WideResNet326.96%7.3%7.01%7.35%6.96%7.1%7.27%CIFAR-10DenseNet405.91%6.12%5.96%6.0%5.91%5.96%6.0%CIFAR-10LeNet515.57%15.63%15.69%15.64%15.57%15.53%15.81%CIFAR-100ResNet11027.83%34.78%28.41%28.56%27.83%27.82%38.77%CIFAR-100ResNet110(SD)24.91%33.78%25.42%25.17%24.91%24.99%35.09%CIFAR-100WideResNet3228.0%34.29%28.61%29.08%28.0%28.45%37.4%CIFAR-100DenseNet4026.45%34.78%26.73%26.4%26.45%26.25%36.14%CIFAR-100LeNet544.92%54.06%45.77%46.82%44.92%45.53%52.44%ImageNetDenseNet16122.57%48.32%23.2%47.58%22.57%22.54%-ImageNetResNet15222.31%48.1%22.94%47.6%22.31%22.56%-SVHNResNet152(SD)1.98%2.06%2.04%2.04%1.98%2.0%2.08%20NewsDAN320.06%25.12%20.29%20.81%20.06%19.89%22.0%ReutersDAN32.97%7.81%3.52%3.93%2.97%2.83%3.52%SSTBinaryTreeLSTM11.81%12.08%11.75%11.26%11.81%11.81%11.81%SSTFineGrainedTreeLSTM49.5%49.91%48.55%49.86%49.5%49.77%48.51%TableS2.Testerror(%)onstandardvisionandNLPdatasetsbeforecalibrationandwithvariouscalibrationmethods.Thenumberfollowingamodel’snamedenotesthenetworkdepth.Errorwithtemperaturescalingisexactlythesameasuncalibrated.DatasetModelUncalibratedHist.BinningIsotonicBBQTemp.ScalingVectorScalingMatrixScalingBirdsResNet500.97861.62261.41281.25390.87920.90212.334CarsResNet500.54880.79770.87930.69860.53110.52991.0206CIFAR-10ResNet1100.32850.25320.22370.2630.21020.20880.2048CIFAR-10ResNet110(SD)0.29590.20270.18670.21590.17180.17090.1766CIFAR-10WideResNet320.32930.27780.24280.27740.22830.22750.2229CIFAR-10DenseNet400.22280.2120.19690.20870.17500.17570.176CIFAR-10LeNet50.46880.5290.47570.49840.4590.45680.4607CIFAR-100ResNet1101.49781.43791.2071.54661.04421.04852.5637CIFAR-100ResNet110(SD)1.11571.19851.03171.19820.86130.86551.8182CIFAR-100WideResNet321.34341.44991.20861.4591.05651.06482.5507CIFAR-100DenseNet401.01341.21561.06151.15720.90260.90111.9639CIFAR-100LeNet51.66392.25741.81731.98931.65601.66482.1405ImageNetDenseNet1610.93381.47161.19121.42720.88850.8879-ImageNetResNet1520.89611.45071.18591.39870.86570.8742-SVHNResNet152(SD)0.08420.11370.0950.10620.08210.08440.092420NewsDAN30.79491.04990.89680.95190.73870.72960.9089ReutersDAN30.1020.24030.14750.11670.09940.09900.1491SSTBinaryTreeLSTM0.33670.28420.29080.27780.27390.27390.2739SSTFineGrainedTreeLSTM1.14751.17171.16611.1491.11681.10851.1112TableS3.NLL(%)onstandardvisionandNLPdatasetsbeforecalibrationandwithvariouscalibrationmethods.Thenumberfollowingamodel’snamedenotesthenetworkdepth.Tosummarize,NLLroughlyfollowsthetrendsofECE.SupplementaryMaterials:OnCalibrationofModernNeuralNetworks0.00.20.40.60.81.00.00.20.40.60.81.0AccuracyECE=4.12Uncal.-CIFAR-10ResNet-110(SD)OutputsGap0.00.20.40.60.81.0ECE=0.60Temp.Scale-CIFAR-10ResNet-110(SD)OutputsGap0.00.20.40.60.81.0ECE=0.67Hist.Bin.-CIFAR-10ResNet-110(SD)OutputsGap0.00.20.40.60.81.0ECE=1.11Iso.Reg.-CIFAR-10ResNet-110(SD)OutputsGapConﬁdenceFigureS2.ReliabilitydiagramsforCIFAR-10before(farleft)andaftercalibration(middleleft,middleright,farright).0.00.20.40.60.81.00.00.20.40.60.81.0AccuracyECE=6.71Uncal.-SST-FGTreeLSTMOutputsGap0.00.20.40.60.81.0ECE=2.56Temp.Scale-SST-FGTreeLSTMOutputsGap0.00.20.40.60.81.0ECE=2.09Hist.Bin.-SST-FGTreeLSTMOutputsGap0.00.20.40.60.81.0ECE=1.65Iso.Reg.-SST-FGTreeLSTMOutputsGapConﬁdenceFigureS3.ReliabilitydiagramsforSSTBinaryandSSTFineGrainedbefore(farleft)andaftercalibration(middleleft,middleright,farright).0.00.20.40.60.81.00.00.20.40.60.81.0AccuracyECE=6.63Uncal.-SST-BINTreeLSTMOutputsGap0.00.20.40.60.81.0ECE=1.84Temp.Scale-SST-BINTreeLSTMOutputsGap0.00.20.40.60.81.0ECE=1.93Hist.Bin.-SST-BINTreeLSTMOutputsGap0.00.20.40.60.81.0ECE=1.65Iso.Reg.-SST-BINTreeLSTMOutputsGapConﬁdenceFigureS4.ReliabilitydiagramsforSSTBinaryandSSTFineGrainedbefore(farleft)andaftercalibration(middleleft,middleright,farright).