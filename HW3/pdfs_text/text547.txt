OptimalDensiﬁcationforFastandAccurateMinwiseHashingA.ProofsTheorem5GiveanytwoﬁnitesetsS1,S2∈Ω,withA=|S1∪S2|>a=|S1∩S2|>0and|Ω|=D→∞.Thelimitingvarianceoftheestimatorsfromdensiﬁcationandimproveddensiﬁcationwhenk=D→∞isgivenby:limk→∞Var(h)=aA(cid:20)A−aA(A+1)(cid:21)>0(15)limk→∞Var(h+)=aA(cid:20)3(A−1)+(2A−1)(a−1)2(A+1)(A−1)−aA(cid:21)>0(16)Proof:Whenk=D,thenNemp=D−A.Substitutingthisvalueinthevarianceformulasfrom(Shrivastava&Li,2014c)andtakingthelimitasD=k→∞,wegettheaboveexpressionaftermanipulation.When0<R=aA<1,theybotharestrictlypositive.(cid:3)Theorem6Pr(cid:0)h∗(S1)=h∗(S2)(cid:1)=|S1∩S2||S1∩S2|=R(17)Var(h∗)=Rk+ARk2+BR¯Rk2−R2(18)limk→∞Var(h∗)=0(19)whereNempisthenumberofsimultaneousemptybinsbe-tweenS1andS2andthequantitiesAandBaregivenbyA=E(cid:20)2Nemp+Nemp(Nemp−1)k−Nemp(cid:21)B=E(cid:20)(k−Nemp)(k−Nemp−1)+2Nemp(k−Nemp−1)+Nemp(Nemp−1)(k−Nemp−1)k−Nemp(cid:21)Proof:Thecollisionprobabilityiseasyusingasimpleobserva-tionthatvaluescomingfromdifferentbinnumberscannevermatchacrossS1andS2,i.e.h∗i(Si)6=h∗j(S2)ifi6=j,astheyhavedisjointdifferentrange.Sowhen-ever,forasimultaneousemptybini,i.e.Ei=1,wegeth∗i(S1)=h∗i(S2)afterreassignment,thevaluemustbecomingfromsamenon-emptybin,saynumberskwhichisnotnotempty.Thus,Pr(h∗i(S1)=h∗i(S2))=Pr(h∗k(S1)=h∗k(S2)|Ek=0)=RThevarianceislittleinvolved.Fromthecollisionprobabil-ity,wehavethefollowingisunbiasedestimator.ˆR=1kk−1Xj=01{h∗j(S1)=h∗j(S2)}.(20)Forvariance,deﬁnethenumberofsimultaneouslyemptybinsbyNemp=k−1Xj=01{Ej=1},(21)where1istheindicatorfunction.Wepartitiontheevent(cid:0)h∗j(S1)=h∗j(S2)(cid:1)intotwocasesdependingonEj.LetMNj(Non-emptyMatchatj)andMEj(EmptyMatchatj)betheeventsdeﬁnedas:MNj=1{Ej=0andh∗j(S1)=h∗j(S2)}(22)MEj=1{Ej=1andh∗j(S1)=h∗j(S2)}(23)Notethat,MNj=1=⇒MEj=0andMEj=1=⇒MNj=0.FromtheLSHpropertyofestimatorwehaveE(MNj|Ej=0)=E(MEj|Ej=1)=E(MEj+MNj)=R∀j(24)Itisnotdifﬁculttoshowthat,E(cid:0)MNjMNi(cid:12)(cid:12)i6=j,Ej=0andEi=0(cid:1)=R˜R,where˜R=a−1f1+f2−a−1.Usingthesenewevents,wehaveˆR=1kk−1Xj=0(cid:2)MEj+MNj(cid:3)(25)WeareinterestedincomputingVar(ˆR)=E1kk−1Xj=0(cid:2)MEj+MNj(cid:3)2−R2(26)Fornotationalconveniencewewillusemtodenotetheeventk−Nemp=m,i.e.,theexpressionE(.|m)meansE(.|k−Nemp=m).Tosimplifytheanalysis,wewillﬁrstcomputetheconditionalexpectationf(m)=E1kk−1Xj=0(cid:2)MEj+MNj(cid:3)2(cid:12)(cid:12)(cid:12)(cid:12)m(27)Byexpansionandlinearityofexpectation,weobtaink2f(m)=EXi6=jMNiMNj(cid:12)(cid:12)(cid:12)(cid:12)m+EXi6=jMNiMEj(cid:12)(cid:12)(cid:12)(cid:12)m+EXi6=jMEiMEj(cid:12)(cid:12)(cid:12)(cid:12)m+E"kXi=1(cid:2)(MNj)2+(MEj)2(cid:3)(cid:12)(cid:12)(cid:12)(cid:12)m#OptimalDensiﬁcationforFastandAccurateMinwiseHashingMNj=(MNj)2andMEj=(MEj)2astheyareindicatorfunctionsandcanonlytakevalues0and1.Hence,Ek−1Xj=0(cid:2)(MNj)2+(MEj)2(cid:3)(cid:12)(cid:12)(cid:12)(cid:12)m=kR(28)Thevaluesoftheﬁrstthreetermsaregivenbythefollow-ing3expressionusingsimplebinomialenpensionandus-ingthefactthatwearedealingwithindicatorrandomvari-ablewhichcanonlytakevalues0or1.EXi6=jMNiMNj(cid:12)(cid:12)(cid:12)(cid:12)m=m(m−1)R˜R(29)EXi6=jMNiMEj(cid:12)(cid:12)(cid:12)(cid:12)m=2m(k−m)"Rm+(m−1)R˜Rm#(30)Letpbetheprobabilitythattwosimultaneouslyemptybinsiandjﬁnallypicksthesamenon-emptybinforreassign-ment.ThenwehaveEXi6=jMEiMEj(cid:12)(cid:12)(cid:12)(cid:12)m=(k−m)(k−m−1)hpR+(1−p)R˜Ri(31)becausewithprobability(1−p),itusesestimatorsfromdifferentsimultaneousnon-emptybinandinthatcasetheMEiMEj=1withprobabilityR˜R.WeknowthatAlgo-rithm1whichuses2-universalhashingthevalueofp=1m.Thisisbecauseanypairwiseassignmentisperfectlyran-domwith2-universalhashing.Substitutingforalltermswithvalueofpandrearrangingtermsgivestherequiredexpression.Whenk=D,thenNemp=D−A.SubstitutingthisvalueinthevarianceformulasandtakingthelimitasD=k→∞,weget0forallR.Theorem7Var(h∗)≤Var(h+)≤Var(h)(32)Proof:Wehavep∗=1m≤p+=1.5m+1≤p=2m+1.Thevalueofp+andpcomesfromanalysisin(Shrivastava&Li,2014c)Theorem8Amongalldensiﬁcationschemes,wherethereassignmentprocessforbiniisindependentofthereas-signmentprocessofanyotherbinj,Algorithm1achievesthebestpossiblevariance.Underanyindependentre-assignment,theprobabilitythattwoemptybinschoosesthesamenon-emptybinoutofmnon-emptybinsislowerboundedby1mwhichisachievedbyoptimaldensiﬁcation.